!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("@antv/x6"),require("react-dom"),require("@antv/x6-react-shape"),require("@antv/layout"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","react","@antv/x6","react-dom","@antv/x6-react-shape","@antv/layout","lodash"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).XFlowCore={},e.React,e.X6,e.ReactDOM,e.X6ReactShape,e.layout,e.lodash)}(this,(function(e,t,n,i,o,r,s){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var u=a(t),d=c(t),l=a(i),h=c(r),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},p={},g={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.NON_CUSTOM_TAG_KEYS=[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]}(g);var v={},y={},m={};Object.defineProperty(m,"__esModule",{value:!0}),m.TargetTypeEnum=m.BindingTypeEnum=m.BindingScopeEnum=void 0;m.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};m.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};m.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};var b={};Object.defineProperty(b,"__esModule",{value:!0}),b.id=void 0;var _=0;b.id=function(){return _++},Object.defineProperty(y,"__esModule",{value:!0}),y.Binding=void 0;var E=m,C=b,w=function(){function e(e,t){this.id=C.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=E.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===E.BindingScopeEnum.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();y.Binding=w;var O={};Object.defineProperty(O,"__esModule",{value:!0}),O.STACK_OVERFLOW=O.CIRCULAR_DEPENDENCY_IN_FACTORY=O.POST_CONSTRUCT_ERROR=O.MULTIPLE_POST_CONSTRUCT_METHODS=O.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=O.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=O.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=O.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=O.ARGUMENTS_LENGTH_MISMATCH=O.INVALID_DECORATOR_OPERATION=O.INVALID_TO_SELF_VALUE=O.INVALID_FUNCTION_BINDING=O.INVALID_MIDDLEWARE_RETURN=O.NO_MORE_SNAPSHOTS_AVAILABLE=O.INVALID_BINDING_TYPE=O.NOT_IMPLEMENTED=O.CIRCULAR_DEPENDENCY=O.UNDEFINED_INJECT_ANNOTATION=O.MISSING_INJECT_ANNOTATION=O.MISSING_INJECTABLE_ANNOTATION=O.NOT_REGISTERED=O.CANNOT_UNBIND=O.AMBIGUOUS_MATCH=O.KEY_NOT_FOUND=O.NULL_ARGUMENT=O.DUPLICATED_METADATA=O.DUPLICATED_INJECTABLE_DECORATOR=void 0,O.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",O.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",O.NULL_ARGUMENT="NULL argument",O.KEY_NOT_FOUND="Key Not Found",O.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",O.CANNOT_UNBIND="Could not unbind serviceIdentifier:",O.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",O.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",O.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";O.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},O.CIRCULAR_DEPENDENCY="Circular dependency found:",O.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",O.INVALID_BINDING_TYPE="Invalid binding type:",O.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",O.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",O.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",O.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",O.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";O.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},O.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",O.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",O.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",O.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",O.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";O.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]};O.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},O.STACK_OVERFLOW="Maximum call stack size exceeded";var x={};Object.defineProperty(x,"__esModule",{value:!0}),x.MetadataReader=void 0;var A=g,S=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(A.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(A.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(A.TAGGED_PROP,e)||[]},e}();x.MetadataReader=S;var T={},P={};Object.defineProperty(P,"__esModule",{value:!0}),P.BindingCount=void 0;P.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};var N={};Object.defineProperty(N,"__esModule",{value:!0}),N.isStackOverflowExeption=void 0;var I=O;N.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===I.STACK_OVERFLOW};var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.circularDependencyToException=k.listMetadataForTarget=k.listRegisteredBindingsForServiceIdentifier=k.getServiceIdentifierAsString=k.getFunctionName=void 0;var M=O;function D(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function R(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||R(e.parentRequest,t))}function j(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}k.getServiceIdentifierAsString=D,k.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var i="",o=n(e,t);return 0!==o.length&&(i="\nRegistered bindings:",o.forEach((function(e){var t="Object";null!==e.implementationType&&(t=j(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i},k.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(R(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var i=D(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(M.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},k.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),o=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==o&&o.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},k.getFunctionName=j;var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.Context=void 0;var F=b,U=function(){function e(e){this.id=F.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();G.Context=U;var L={};Object.defineProperty(L,"__esModule",{value:!0}),L.Metadata=void 0;var B=g,H=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===B.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();L.Metadata=H;var V={};Object.defineProperty(V,"__esModule",{value:!0}),V.Plan=void 0;var X=function(e,t){this.parentContext=e,this.rootRequest=t};V.Plan=X;var z={},K={},W={};Object.defineProperty(W,"__esModule",{value:!0}),W.tagProperty=W.tagParameter=W.decorate=void 0;var Y=O,q=g;function $(e,t,n,i,o){var r={},s="number"==typeof o,a=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(Y.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(r=Reflect.getMetadata(e,t));var c=r[a];if(Array.isArray(c))for(var u=0,d=c;u<d.length;u++){var l=d[u];if(l.key===i.key)throw new Error(Y.DUPLICATED_METADATA+" "+l.key.toString())}else c=[];c.push(i),r[a]=c,Reflect.defineMetadata(e,r,t)}function J(e,t){Reflect.decorate(e,t)}function Z(e,t){return function(n,i){t(n,i,e)}}W.tagParameter=function(e,t,n,i){$(q.TAGGED,e,t,i,n)},W.tagProperty=function(e,t,n){$(q.TAGGED_PROP,e.constructor,t,n)},W.decorate=function(e,t,n){"number"==typeof n?J([Z(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):J([e],t)},Object.defineProperty(K,"__esModule",{value:!0}),K.inject=K.LazyServiceIdentifer=void 0;var Q=O,ee=g,te=L,ne=W,ie=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();K.LazyServiceIdentifer=ie,K.inject=function(e){return function(t,n,i){if(void 0===e)throw new Error(Q.UNDEFINED_INJECT_ANNOTATION(t.name));var o=new te.Metadata(ee.INJECT_TAG,e);"number"==typeof i?ne.tagParameter(t,n,i,o):ne.tagProperty(t,n,o)}};var oe={},re={};Object.defineProperty(re,"__esModule",{value:!0}),re.QueryableString=void 0;var se=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();re.QueryableString=se,Object.defineProperty(oe,"__esModule",{value:!0}),oe.Target=void 0;var ae=g,ce=b,ue=L,de=re,le=function(){function e(e,t,n,i){this.id=ce.id(),this.type=e,this.serviceIdentifier=n,this.name=new de.QueryableString(t||""),this.metadata=new Array;var o=null;"string"==typeof i?o=new ue.Metadata(ae.NAMED_TAG,i):i instanceof ue.Metadata&&(o=i),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(ae.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(ae.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(ae.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return ae.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(ae.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===ae.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return ae.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(ae.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var r=o[i];if(r.key===e&&r.value===n)return!0}return!1}},e}();oe.Target=le,function(e){var t=f&&f.__spreadArray||function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e};Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=e.getBaseClassDependencyCount=e.getDependencies=void 0;var n=K,i=O,o=m,r=g,s=k;Object.defineProperty(e,"getFunctionName",{enumerable:!0,get:function(){return s.getFunctionName}});var a=oe;function c(e,n,o,r){var s=e.getConstructorMetadata(o),a=s.compilerGeneratedMetadata;if(void 0===a){var c=i.MISSING_INJECTABLE_ANNOTATION+" "+n+".";throw new Error(c)}var l=s.userGeneratedMetadata,h=Object.keys(l),f=0===o.length&&h.length>0,p=h.length>o.length,g=function(e,t,n,i,o){for(var r=[],s=0;s<o;s++){var a=u(s,e,t,n,i);null!==a&&r.push(a)}return r}(r,n,a,l,f||p?h.length:o.length),v=d(e,o);return t(t([],g),v)}function u(e,t,r,s,c){var u=c[e.toString()]||[],d=l(u),h=!0!==d.unmanaged,f=s[e],p=d.inject||d.multiInject;if((f=p||f)instanceof n.LazyServiceIdentifer&&(f=f.unwrap()),h){if(!t&&(f===Object||f===Function||void 0===f)){var g=i.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+r+".";throw new Error(g)}var v=new a.Target(o.TargetTypeEnum.ConstructorArgument,d.targetName,f);return v.metadata=u,v}return null}function d(e,n){for(var i=e.getPropertiesMetadata(n),r=[],s=0,c=Object.keys(i);s<c.length;s++){var u=c[s],h=i[u],f=l(i[u]),p=f.targetName||u,g=f.inject||f.multiInject,v=new a.Target(o.TargetTypeEnum.ClassProperty,p,g);v.metadata=h,r.push(v)}var y=Object.getPrototypeOf(n.prototype).constructor;if(y!==Object){var m=d(e,y);r=t(t([],r),m)}return r}function l(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[r.INJECT_TAG],multiInject:t[r.MULTI_INJECT_TAG],targetName:t[r.NAME_TAG],unmanaged:t[r.UNMANAGED_TAG]}}e.getDependencies=function(e,t){return c(e,s.getFunctionName(t),t,!1)},e.getBaseClassDependencyCount=function e(t,n){var i=Object.getPrototypeOf(n.prototype).constructor;if(i!==Object){var o=c(t,s.getFunctionName(i),i,!0),a=o.map((function(e){return e.metadata.filter((function(e){return e.key===r.UNMANAGED_TAG}))})),u=[].concat.apply([],a).length,d=o.length-u;return d>0?d:e(t,i)}return 0}}(z);var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.Request=void 0;var fe=b,pe=function(){function e(e,t,n,i,o){this.id=fe.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var o=new e(t,this.parentContext,this,n,i);return this.childRequests.push(o),o},e}();he.Request=pe,Object.defineProperty(T,"__esModule",{value:!0}),T.getBindingDictionary=T.createMockRequest=T.plan=void 0;var ge=P,ve=O,ye=m,me=g,be=N,_e=k,Ee=G,Ce=L,we=V,Oe=z,xe=he,Ae=oe;function Se(e){return e._bindingDictionary}function Te(e,t,n,i,o){var r=Ne(n.container,o.serviceIdentifier),s=[];return r.length===ge.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof o.serviceIdentifier&&e.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(o.serviceIdentifier).toSelf(),r=Ne(n.container,o.serviceIdentifier)),s=t?r:r.filter((function(e){var t=new xe.Request(e.serviceIdentifier,n,i,e,o);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case ge.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var o=_e.getServiceIdentifierAsString(e),r=ve.NOT_REGISTERED;throw r+=_e.listMetadataForTarget(o,n),r+=_e.listRegisteredBindingsForServiceIdentifier(i,o,Ne),new Error(r);case ge.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case ge.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;o=_e.getServiceIdentifierAsString(e),r=ve.AMBIGUOUS_MATCH+" "+o;throw r+=_e.listRegisteredBindingsForServiceIdentifier(i,o,Ne),new Error(r)}}(o.serviceIdentifier,s,o,n.container),s}function Pe(e,t,n,i,o,r){var s,a;if(null===o){s=Te(e,t,i,null,r),a=new xe.Request(n,i,null,s,r);var c=new we.Plan(i,a);i.addPlan(c)}else s=Te(e,t,i,o,r),a=o.addChildRequest(r.serviceIdentifier,s,r);s.forEach((function(t){var n=null;if(r.isArray())n=a.addChildRequest(t.serviceIdentifier,t,r);else{if(t.cache)return;n=a}if(t.type===ye.BindingTypeEnum.Instance&&null!==t.implementationType){var o=Oe.getDependencies(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var s=Oe.getBaseClassDependencyCount(e,t.implementationType);if(o.length<s){var c=ve.ARGUMENTS_LENGTH_MISMATCH(Oe.getFunctionName(t.implementationType));throw new Error(c)}}o.forEach((function(t){Pe(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function Ne(e,t){var n=[],i=Se(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=Ne(e.parent,t)),n}T.getBindingDictionary=Se,T.plan=function(e,t,n,i,o,r,s,a){void 0===a&&(a=!1);var c=new Ee.Context(t),u=function(e,t,n,i,o,r){var s=e?me.MULTI_INJECT_TAG:me.INJECT_TAG,a=new Ce.Metadata(s,n),c=new Ae.Target(t,i,n,a);if(void 0!==o){var u=new Ce.Metadata(o,r);c.metadata.push(u)}return c}(n,i,o,"",r,s);try{return Pe(e,a,o,c,null,u),c}catch(e){throw be.isStackOverflowExeption(e)&&c.plan&&_e.circularDependencyToException(c.plan.rootRequest),e}},T.createMockRequest=function(e,t,n,i){var o=new Ae.Target(ye.TargetTypeEnum.Variable,"",t,new Ce.Metadata(n,i)),r=new Ee.Context(e);return new xe.Request(t,r,null,[],o)};var Ie={},ke={},Me=f&&f.__spreadArray||function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e};Object.defineProperty(ke,"__esModule",{value:!0}),ke.resolveInstance=void 0;var De=O,Re=m,je=g;ke.resolveInstance=function(e,t,n){var i,o,r=null;if(t.length>0){var s=t.filter((function(e){return null!==e.target&&e.target.type===Re.TargetTypeEnum.ConstructorArgument})).map(n);o=s,r=function(e,t,n){var i=t.filter((function(e){return null!==e.target&&e.target.type===Re.TargetTypeEnum.ClassProperty})),o=i.map(n);return i.forEach((function(t,n){var i;i=t.target.name.value();var r=o[n];e[i]=r})),e}(r=new((i=e).bind.apply(i,Me([void 0],o))),t,n)}else r=new e;return function(e,t){if(Reflect.hasMetadata(je.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(je.POST_CONSTRUCT,e);try{t[n.value]()}catch(t){throw new Error(De.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,r),r},Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.resolve=void 0;var Ge=O,Fe=m,Ue=N,Le=k,Be=ke,He=function(e,t,n){try{return n()}catch(n){throw Ue.isStackOverflowExeption(n)?new Error(Ge.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):n}},Ve=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,o=t.target&&t.target.isArray(),r=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(o&&r)return i.map((function(t){return Ve(e)(t)}));var s=null;if(!t.target.isOptional()||0!==n.length){var a=n[0],c=a.scope===Fe.BindingScopeEnum.Singleton,u=a.scope===Fe.BindingScopeEnum.Request;if(c&&a.activated)return a.cache;if(u&&null!==e&&e.has(a.id))return e.get(a.id);if(a.type===Fe.BindingTypeEnum.ConstantValue)s=a.cache,a.activated=!0;else if(a.type===Fe.BindingTypeEnum.Function)s=a.cache,a.activated=!0;else if(a.type===Fe.BindingTypeEnum.Constructor)s=a.implementationType;else if(a.type===Fe.BindingTypeEnum.DynamicValue&&null!==a.dynamicValue)s=He("toDynamicValue",a.serviceIdentifier,(function(){return a.dynamicValue(t.parentContext)}));else if(a.type===Fe.BindingTypeEnum.Factory&&null!==a.factory)s=He("toFactory",a.serviceIdentifier,(function(){return a.factory(t.parentContext)}));else if(a.type===Fe.BindingTypeEnum.Provider&&null!==a.provider)s=He("toProvider",a.serviceIdentifier,(function(){return a.provider(t.parentContext)}));else{if(a.type!==Fe.BindingTypeEnum.Instance||null===a.implementationType){var d=Le.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(Ge.INVALID_BINDING_TYPE+" "+d)}s=Be.resolveInstance(a.implementationType,i,Ve(e))}return"function"==typeof a.onActivation&&(s=a.onActivation(t.parentContext,s)),c&&(a.cache=s,a.activated=!0),u&&null!==e&&!e.has(a.id)&&e.set(a.id,s),s}}};Ie.resolve=function(e){return Ve(e.plan.rootRequest.requestScope)(e.plan.rootRequest)};var Xe={},ze={},Ke={},We={},Ye={},qe={},$e={};Object.defineProperty($e,"__esModule",{value:!0}),$e.typeConstraint=$e.namedConstraint=$e.taggedConstraint=$e.traverseAncerstors=void 0;var Je=g,Ze=L,Qe=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Qe(n,t))};$e.traverseAncerstors=Qe;var et=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new Ze.Metadata(e,t),n}};$e.taggedConstraint=et;var tt=et(Je.NAMED_TAG);$e.namedConstraint=tt;$e.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},Object.defineProperty(qe,"__esModule",{value:!0}),qe.BindingWhenSyntax=void 0;var nt=Ye,it=$e,ot=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new nt.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=it.namedConstraint(e),new nt.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new nt.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=it.taggedConstraint(e)(t),new nt.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return it.typeConstraint(e)(t.parentRequest)},new nt.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return it.namedConstraint(e)(t.parentRequest)},new nt.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return it.taggedConstraint(e)(t)(n.parentRequest)},new nt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return it.traverseAncerstors(t,it.typeConstraint(e))},new nt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!it.traverseAncerstors(t,it.typeConstraint(e))},new nt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return it.traverseAncerstors(t,it.namedConstraint(e))},new nt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!it.traverseAncerstors(t,it.namedConstraint(e))},new nt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return it.traverseAncerstors(n,it.taggedConstraint(e)(t))},new nt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!it.traverseAncerstors(n,it.taggedConstraint(e)(t))},new nt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return it.traverseAncerstors(t,e)},new nt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!it.traverseAncerstors(t,e)},new nt.BindingOnSyntax(this._binding)},e}();qe.BindingWhenSyntax=ot,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.BindingOnSyntax=void 0;var rt=qe,st=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new rt.BindingWhenSyntax(this._binding)},e}();Ye.BindingOnSyntax=st,Object.defineProperty(We,"__esModule",{value:!0}),We.BindingWhenOnSyntax=void 0;var at=Ye,ct=qe,ut=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ct.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new at.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();We.BindingWhenOnSyntax=ut,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.BindingInSyntax=void 0;var dt=m,lt=We,ht=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=dt.BindingScopeEnum.Request,new lt.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=dt.BindingScopeEnum.Singleton,new lt.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=dt.BindingScopeEnum.Transient,new lt.BindingWhenOnSyntax(this._binding)},e}();Ke.BindingInSyntax=ht,Object.defineProperty(ze,"__esModule",{value:!0}),ze.BindingInWhenOnSyntax=void 0;var ft=Ke,pt=Ye,gt=qe,vt=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new gt.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new pt.BindingOnSyntax(this._binding),this._bindingInSyntax=new ft.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();ze.BindingInWhenOnSyntax=vt,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.BindingToSyntax=void 0;var yt=O,mt=m,bt=ze,_t=We,Et=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=mt.BindingTypeEnum.Instance,this._binding.implementationType=e,new bt.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+yt.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=mt.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=mt.BindingScopeEnum.Singleton,new _t.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=mt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new bt.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=mt.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=mt.BindingScopeEnum.Singleton,new _t.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=mt.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=mt.BindingScopeEnum.Singleton,new _t.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(yt.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=mt.BindingTypeEnum.Function,this._binding.scope=mt.BindingScopeEnum.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=mt.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=mt.BindingScopeEnum.Singleton,new _t.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=mt.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=mt.BindingScopeEnum.Singleton,new _t.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();Xe.BindingToSyntax=Et;var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ContainerSnapshot=void 0;var wt=function(){function e(){}return e.of=function(t,n){var i=new e;return i.bindings=t,i.middleware=n,i},e}();Ct.ContainerSnapshot=wt;var Ot={};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Lookup=void 0;var xt=O,At=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(xt.NULL_ARGUMENT);if(null==t)throw new Error(xt.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(xt.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(xt.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(xt.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(xt.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,i){var o=n.filter((function(t){return!e(t)}));o.length>0?t._map.set(i,o):t._map.delete(i)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(xt.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();Ot.Lookup=At;var St=f&&f.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},Tt=f&&f.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},Pt=f&&f.__spreadArray||function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e};Object.defineProperty(v,"__esModule",{value:!0}),v.Container=void 0;var Nt=y,It=O,kt=m,Mt=g,Dt=x,Rt=T,jt=Ie,Gt=Xe,Ft=b,Ut=k,Lt=Ct,Bt=Ot,Ht=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error(""+It.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=kt.BindingScopeEnum.Transient;else if(t.defaultScope!==kt.BindingScopeEnum.Singleton&&t.defaultScope!==kt.BindingScopeEnum.Transient&&t.defaultScope!==kt.BindingScopeEnum.Request)throw new Error(""+It.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+It.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+It.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Ft.id(),this._bindingDictionary=new Bt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Dt.MetadataReader}return e.merge=function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var r=new e,s=Pt([t,n],i).map((function(e){return Rt.getBindingDictionary(e)})),a=Rt.getBindingDictionary(r);function c(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s.forEach((function(e){c(e,a)})),r},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var r=o[i],s=n(r.id);r.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return St(this,void 0,void 0,(function(){var t,n,i,o,r;return Tt(this,(function(s){switch(s.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,s.label=1;case 1:return n<i.length?(o=i[n],r=t(o.id),[4,o.registry(r.bindFunction,r.unbindFunction,r.isboundFunction,r.rebindFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=i(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||kt.BindingScopeEnum.Transient,n=new Nt.Binding(e,t);return this._bindingDictionary.add(e,n),new Gt.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(It.CANNOT_UNBIND+" "+Ut.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new Bt.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Mt.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),r=Rt.createMockRequest(this,e,t,n);i=o.some((function(e){return e.constraint(r)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(Lt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(It.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,kt.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,kt.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,Mt.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,kt.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,kt.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Mt.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var o=e.rebind.bind(e)(i);return t(o,n),o}};return function(i){return{bindFunction:(o=i,function(n){var i=e.bind.bind(e)(n);return t(i,o),i}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(i),unbindFunction:function(t){e.unbind.bind(e)(t)}};var o}},e.prototype._get=function(e,t,n,i,o,r){var s=null,a={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:o,serviceIdentifier:i,targetType:n,value:r};if(this._middleware){if(null==(s=this._middleware(a)))throw new Error(It.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(a);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=Rt.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),jt.resolve(n)}},e}();v.Container=Ht;var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.AsyncContainerModule=Vt.ContainerModule=void 0;var Xt=b,zt=function(e){this.id=Xt.id(),this.registry=e};Vt.ContainerModule=zt;var Kt=function(e){this.id=Xt.id(),this.registry=e};Vt.AsyncContainerModule=Kt;var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.injectable=void 0;var Yt=O,qt=g;Wt.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(qt.PARAM_TYPES,e))throw new Error(Yt.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(qt.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(qt.PARAM_TYPES,t,e),e}};var $t={};Object.defineProperty($t,"__esModule",{value:!0}),$t.tagged=void 0;var Jt=L,Zt=W;$t.tagged=function(e,t){return function(n,i,o){var r=new Jt.Metadata(e,t);"number"==typeof o?Zt.tagParameter(n,i,o,r):Zt.tagProperty(n,i,r)}};var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.named=void 0;var en=g,tn=L,nn=W;Qt.named=function(e){return function(t,n,i){var o=new tn.Metadata(en.NAMED_TAG,e);"number"==typeof i?nn.tagParameter(t,n,i,o):nn.tagProperty(t,n,o)}};var on={};Object.defineProperty(on,"__esModule",{value:!0}),on.optional=void 0;var rn=g,sn=L,an=W;on.optional=function(){return function(e,t,n){var i=new sn.Metadata(rn.OPTIONAL_TAG,!0);"number"==typeof n?an.tagParameter(e,t,n,i):an.tagProperty(e,t,i)}};var cn={};Object.defineProperty(cn,"__esModule",{value:!0}),cn.unmanaged=void 0;var un=g,dn=L,ln=W;cn.unmanaged=function(){return function(e,t,n){var i=new dn.Metadata(un.UNMANAGED_TAG,!0);ln.tagParameter(e,t,n,i)}};var hn={};Object.defineProperty(hn,"__esModule",{value:!0}),hn.multiInject=void 0;var fn=g,pn=L,gn=W;hn.multiInject=function(e){return function(t,n,i){var o=new pn.Metadata(fn.MULTI_INJECT_TAG,e);"number"==typeof i?gn.tagParameter(t,n,i,o):gn.tagProperty(t,n,o)}};var vn={};Object.defineProperty(vn,"__esModule",{value:!0}),vn.targetName=void 0;var yn=g,mn=L,bn=W;vn.targetName=function(e){return function(t,n,i){var o=new mn.Metadata(yn.NAME_TAG,e);bn.tagParameter(t,n,i,o)}};var _n={};Object.defineProperty(_n,"__esModule",{value:!0}),_n.postConstruct=void 0;var En=O,Cn=g,wn=L;_n.postConstruct=function(){return function(e,t,n){var i=new wn.Metadata(Cn.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(Cn.POST_CONSTRUCT,e.constructor))throw new Error(En.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(Cn.POST_CONSTRUCT,i,e.constructor)}};var On={};Object.defineProperty(On,"__esModule",{value:!0}),On.multiBindToService=void 0;var xn,An,Sn;function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){Dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nn(e){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nn(e)}function In(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mn(e,t,n){return t&&kn(e.prototype,t),n&&kn(e,n),e}function Dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rn(e){return function(e){if(Array.isArray(e))return jn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Gn(e,t){return t.lifecycle===An.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function Fn(e,t){e.whenTargetNamed(Bn(t))}function Un(e,t){return t.container.bind(Hn(e))}function Ln(e,t){var n=t.container.parent,i=n&&n.isBound(Hn(e));return t.container.isBound(Hn(e))&&!i?t.container.rebind(Hn(e)):t.container.bind(Hn(e))}function Bn(e){return Sn.isDefinedToken(e)?e.symbol:e}function Hn(e){return Sn.isDefinedToken(e)?e.symbol:e}On.multiBindToService=function(e){return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach((function(n){return e.bind(n).toService(t)}))}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=e.getServiceIdentifierAsString=e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=e.decorate=e.id=e.MetadataReader=e.postConstruct=e.targetName=e.multiInject=e.unmanaged=e.optional=e.LazyServiceIdentifer=e.inject=e.named=e.tagged=e.injectable=e.ContainerModule=e.AsyncContainerModule=e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=e.Container=e.METADATA_KEY=void 0;var t=g;e.METADATA_KEY=t;var n=v;Object.defineProperty(e,"Container",{enumerable:!0,get:function(){return n.Container}});var i=m;Object.defineProperty(e,"BindingScopeEnum",{enumerable:!0,get:function(){return i.BindingScopeEnum}}),Object.defineProperty(e,"BindingTypeEnum",{enumerable:!0,get:function(){return i.BindingTypeEnum}}),Object.defineProperty(e,"TargetTypeEnum",{enumerable:!0,get:function(){return i.TargetTypeEnum}});var o=Vt;Object.defineProperty(e,"AsyncContainerModule",{enumerable:!0,get:function(){return o.AsyncContainerModule}}),Object.defineProperty(e,"ContainerModule",{enumerable:!0,get:function(){return o.ContainerModule}});var r=Wt;Object.defineProperty(e,"injectable",{enumerable:!0,get:function(){return r.injectable}});var s=$t;Object.defineProperty(e,"tagged",{enumerable:!0,get:function(){return s.tagged}});var a=Qt;Object.defineProperty(e,"named",{enumerable:!0,get:function(){return a.named}});var c=K;Object.defineProperty(e,"inject",{enumerable:!0,get:function(){return c.inject}}),Object.defineProperty(e,"LazyServiceIdentifer",{enumerable:!0,get:function(){return c.LazyServiceIdentifer}});var u=on;Object.defineProperty(e,"optional",{enumerable:!0,get:function(){return u.optional}});var d=cn;Object.defineProperty(e,"unmanaged",{enumerable:!0,get:function(){return d.unmanaged}});var l=hn;Object.defineProperty(e,"multiInject",{enumerable:!0,get:function(){return l.multiInject}});var h=vn;Object.defineProperty(e,"targetName",{enumerable:!0,get:function(){return h.targetName}});var f=_n;Object.defineProperty(e,"postConstruct",{enumerable:!0,get:function(){return f.postConstruct}});var p=x;Object.defineProperty(e,"MetadataReader",{enumerable:!0,get:function(){return p.MetadataReader}});var y=b;Object.defineProperty(e,"id",{enumerable:!0,get:function(){return y.id}});var _=W;Object.defineProperty(e,"decorate",{enumerable:!0,get:function(){return _.decorate}});var E=$e;Object.defineProperty(e,"traverseAncerstors",{enumerable:!0,get:function(){return E.traverseAncerstors}}),Object.defineProperty(e,"taggedConstraint",{enumerable:!0,get:function(){return E.taggedConstraint}}),Object.defineProperty(e,"namedConstraint",{enumerable:!0,get:function(){return E.namedConstraint}}),Object.defineProperty(e,"typeConstraint",{enumerable:!0,get:function(){return E.typeConstraint}});var C=k;Object.defineProperty(e,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return C.getServiceIdentifierAsString}});var w=On;Object.defineProperty(e,"multiBindToService",{enumerable:!0,get:function(){return w.multiBindToService}})}(p),function(e){!function(t){var n="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",r="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!r&&!s,c={create:r?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(d||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,i){if(R(n)){if(!X(e))throw new TypeError;if(!K(t))throw new TypeError;return O(e,t)}if(!X(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(i)&&!R(i)&&!j(i))throw new TypeError;return j(i)&&(i=void 0),x(e,t,n=V(n),i)}function g(e,t){function n(n,i){if(!F(n))throw new TypeError;if(!R(i)&&!W(i))throw new TypeError;I(e,t,n,i)}return n}function v(e,t,n,i){if(!F(n))throw new TypeError;return R(i)||(i=V(i)),I(e,t,n,i)}function y(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),S(e,t,n)}function m(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),T(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),P(e,t,n)}function _(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),N(e,t,n)}function E(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),k(e,t)}function C(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),M(e,t)}function w(e,t,n){if(!F(t))throw new TypeError;R(n)||(n=V(n));var i=A(t,n,!1);if(R(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var o=f.get(t);return o.delete(n),o.size>0||f.delete(t),!0}function O(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!R(i)&&!j(i)){if(!K(i))throw new TypeError;t=i}}return t}function x(e,t,n,i){for(var o=e.length-1;o>=0;--o){var r=(0,e[o])(t,n,i);if(!R(r)&&!j(r)){if(!F(r))throw new TypeError;i=r}}return i}function A(e,t,n){var i=f.get(e);if(R(i)){if(!n)return;i=new l,f.set(e,i)}var o=i.get(t);if(R(o)){if(!n)return;o=new l,i.set(t,o)}return o}function S(e,t,n){if(T(e,t,n))return!0;var i=Q(t);return!j(i)&&S(e,i,n)}function T(e,t,n){var i=A(t,n,!1);return!R(i)&&B(i.has(e))}function P(e,t,n){if(T(e,t,n))return N(e,t,n);var i=Q(t);return j(i)?void 0:P(e,i,n)}function N(e,t,n){var i=A(t,n,!1);if(!R(i))return i.get(e)}function I(e,t,n,i){A(n,i,!0).set(e,t)}function k(e,t){var n=M(e,t),i=Q(e);if(null===i)return n;var o=k(i,t);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new h,s=[],a=0,c=n;a<c.length;a++){var u=c[a];r.has(u)||(r.add(u),s.push(u))}for(var d=0,l=o;d<l.length;d++){u=l[d];r.has(u)||(r.add(u),s.push(u))}return s}function M(e,t){var n=[],i=A(e,t,!1);if(R(i))return n;for(var o=q(i.keys()),r=0;;){var s=J(o);if(!s)return n.length=r,n;var a=$(s);try{n[r]=a}catch(e){try{Z(o)}finally{throw e}}r++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function R(e){return void 0===e}function j(e){return null===e}function G(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function U(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",o=Y(e,i);if(void 0!==o){var r=o.call(e,n);if(F(r))throw new TypeError;return r}return L(e,"default"===n?"number":n)}function L(e,t){if("string"===t){var n=e.toString;if(z(n))if(!F(o=n.call(e)))return o;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o}else{var i;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o;var o,r=e.toString;if(z(r))if(!F(o=r.call(e)))return o}throw new TypeError}function B(e){return!!e}function H(e){return""+e}function V(e){var t=U(e,3);return G(t)?t:H(t)}function X(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function K(e){return"function"==typeof e}function W(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function q(e){var t=Y(e,o);if(!z(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function $(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var o=i.constructor;return"function"!=typeof o||o===e?t:o}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,o=n+1;o<i;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,r)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function r(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new l}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function ne(){var e=16,n=c.create(),i=o();return function(){function e(){this._key=o()}return e.prototype.has=function(e){var t=r(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=r(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return r(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=r(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=o()},e}();function o(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function r(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var o=t[i];4!==i&&6!==i&&8!==i||(n+="-"),o<16&&(n+="0"),n+=o.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",v),e("hasMetadata",y),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",_),e("getMetadataKeys",E),e("getOwnMetadataKeys",C),e("deleteMetadata",w)}(i)}()}(xn||(xn={})),function(e){e.defineToken=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new e.DefinedToken(t,n)};var t;e.DefinedToken=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};In(this,e),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var i=n.multiple,o=void 0!==i&&i;this.name=t,this.symbol=Symbol(this.name),this.multiple=o},e.isModule=function(e){return!!e&&"object"===Nn(e)&&"id"in e&&"registry"in e},function(e){e.singleton="singleton",e.transient="transient"}(t=e.Lifecycle||(e.Lifecycle={})),e.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),e.DefaultOption={lifecycle:t.transient}}(An||(An={})),function(e){e.maybeArrayToArray=function(e){return e instanceof Array?e:void 0!==e?[e]:[]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"===Nn(e)&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!==Nn(e)||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"===Nn(e)&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}}(Sn||(Sn={}));var Vn=new p.Container;function Xn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=p.injectable();return function(n){Reflect.defineMetadata(An.ClassOptionSymbol,Pn(Pn({},e),{},{target:n}),n),t(n)}}function zn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xn(Pn(Pn({},e),{},{lifecycle:An.Lifecycle.singleton}))}function Kn(e){return p.inject(Hn(e))}function Wn(e){return p.named(Bn(e))}var Yn=Symbol("SyringeOptionSymbol");var qn=function(){function e(t,n,i){In(this,e),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.context=void 0,this.mutiple=void 0,this.context=t,this.token=n,this.option=i,this.rawToken=Sn.isNamedToken(n)?n.token:n,this.named=Sn.isNamedToken(n)?n.named:void 0,this.mutiple=!!this.named||Sn.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return Mn(e,[{key:"resolve",value:function(){var e,t=this,n=this.context;(e=n)&&"object"===Nn(e)&&"container"in e&&"inversify"in e&&(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(e){Sn.isMultipleEnabled(e)?Un(e,n).toService(t.generalToken):Ln(e,n).toService(t.generalToken)}))))}},{key:"resolveMono",value:function(e){var t=this;if("useValue"in this.option)return Ln(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var n=this.option.useDynamic[this.option.useDynamic.length-1];return Gn(Ln(this.generalToken,e).toDynamicValue((function(){return n({container:t.context})})),this.option)}if(this.option.useFactory.length>0){var i=this.option.useFactory[this.option.useFactory.length-1];return Ln(this.generalToken,e).toFactory((function(){return i({container:t.context})}))}if(this.option.useClass.length>0){var o=this.option.useClass[this.option.useClass.length-1];return Gn(Ln(this.generalToken,e).to(o),this.option)}}},{key:"resolveMutilple",value:function(e){var t=this,n=this.option.useClass.map((function(n){return Gn(Un(t.generalToken,e).to(n),t.option)})),i=this.option.useDynamic.map((function(n){return Gn(Un(t.generalToken,e).toDynamicValue((function(){return n({container:t.context})})),t.option)})),o=this.option.useFactory.map((function(n){return Un(t.generalToken,e).toFactory((function(){return n({container:t.context})}))})),r="useValue"in this.option?Un(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(n.forEach((function(e){return t.named&&Fn(e,t.named)})),i.forEach((function(e){return t.named&&Fn(e,t.named)})),o.forEach((function(e){return t.named&&Fn(e,t.named)})),r&&Fn(r,this.named))}}],[{key:"resolveTarget",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var o=Reflect.getMetadata(Yn,n);o&&e.resolveOption(t,o)}catch(e){}if(Sn.isClass(n))if(i.useClass){var r=Sn.maybeArrayToArray(i.useClass);r.unshift(n),i.useClass=r}else i.useClass=[n];var s;try{s=Reflect.getMetadata(An.ClassOptionSymbol,n)}catch(e){}if((s=Pn(Pn({},s||{}),i)).token){var a=Sn.maybeArrayToArray(s.token);a.unshift(n),s.token=a}else s.token=[n];e.resolveOption(t,s)}catch(e){}}},{key:"resolveOption",value:function(t,n){var i=function(e){var t=Sn.maybeArrayToArray(e.token),n=Sn.maybeArrayToArray(e.useClass),i=Sn.maybeArrayToArray(e.useDynamic),o=Sn.maybeArrayToArray(e.useFactory),r=Sn.maybeArrayToArray(e.contrib),s=e.lifecycle||An.Lifecycle.transient,a={token:t,useClass:n,lifecycle:r.length>0?An.Lifecycle.singleton:s,contrib:r,useDynamic:i,useFactory:o};return"useValue"in e&&(a.useValue=e.useValue),a}(Pn(Pn({},e.globalConfig),n));(0!==i.useClass.length||0!==i.useDynamic.length||0!==i.useFactory.length||"useValue"in i)&&i.token.forEach((function(n){new e(t,n,Pn({},i)).resolve()}))}}]),e}();qn.globalConfig=An.DefaultOption;var $n=function(){function e(t){In(this,e),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new p.Container}return Mn(e,[{key:"load",value:function(e,t){!t&&this.loadedModules.includes(e.id)||(e.registry(this.register.bind(this),this.resolveContext()),this.loadedModules.push(e.id))}},{key:"remove",value:function(e){return this.container.unbind(Hn(e))}},{key:"get",value:function(e){return this.container.get(Hn(e))}},{key:"getNamed",value:function(e,t){return this.container.getNamed(Hn(e),Bn(t))}},{key:"getAll",value:function(e){return this.container.getAll(Hn(e))}},{key:"getAllNamed",value:function(e,t){return this.container.getAllNamed(Hn(e),Bn(t))}},{key:"isBound",value:function(e){return this.container.isBound(Hn(e))}},{key:"isBoundNamed",value:function(e,t){return this.container.isBoundNamed(Hn(e),Bn(t))}},{key:"createChild",value:function(){var t=new e(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Sn.isInjectOption(e)?qn.resolveOption(this,e):qn.resolveTarget(this,e,t)}},{key:"resolveContext",value:function(){return{container:this}}}],[{key:"config",value:function(e){qn.globalConfig=e}}]),e}(),Jn=new $n(Vn),Zn=Jn.register.bind(Jn),Qn=An.defineToken("ContributionProvider"),ei=function(){function e(t,n,i){In(this,e),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=n,this.serviceIdentifier=t,i&&(this.option=Pn(Pn({},this.option),i))}return Mn(e,[{key:"setServices",value:function(e){for(var t=[],n=this.container;n;){if(n.isBound(this.serviceIdentifier)){var i=n.getAll(this.serviceIdentifier);t.push.apply(t,Rn(i))}n=e?n.parent:void 0}return t}},{key:"getContributions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Pn(Pn({},this.option),e),n=t.cache,i=t.recursive;return n&&void 0!==this.services||(this.services=this.setServices(!!i)),this.services}}]),e}();function ti(e,t){return{token:{token:Qn,named:e},useDynamic:function(n){return new ei(e,n.container,t)},lifecycle:An.Lifecycle.singleton}}function ni(e,t,n){e({token:{token:Qn,named:t},useDynamic:function(e){return new ei(t,e.container,n)},lifecycle:An.Lifecycle.singleton})}var ii=function(){function e(t){In(this,e),this.id=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,e.moduleId+=1,this.id=e.moduleId,this.baseRegistry=t}return Mn(e,[{key:"registry",get:function(){var e=this;return function(t,n){e.baseRegistry&&e.baseRegistry(t,n),e.optionCollection&&e.optionCollection.forEach((function(e){return t(e)}))}}},{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){return e.options.push(t)})),this}},{key:"contribution",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){return e.options.push(ti(t))})),this}}]),e}();function oi(e){return new ii(e)}ii.moduleId=0;var ri,si=function(e){return function(t,n,i){Wn(e)(t,n,i),Kn(Qn)(t,n,i)}};!function(e){e.Provider=Qn,e.register=ni}(ri||(ri={}));var ai,ci,ui,di=Object.freeze({__proto__:null,Container:$n,get Contribution(){return ri},DefaultContributionProvider:ei,GlobalContainer:Jn,Module:oi,OptionSymbol:Yn,Provider:Qn,get Syringe(){return An},SyringeModule:ii,get Utils(){return Sn},contrib:si,inject:Kn,injectable:Xn,named:Wn,register:Zn,registerSideOption:function(e,t){Reflect.defineMetadata(Yn,e,t)},singleton:zn,transient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xn(Pn(Pn({},e),{},{lifecycle:An.Lifecycle.transient}))},decorate:p.decorate,optional:p.optional,postConstruct:p.postConstruct,unmanaged:p.unmanaged});e.NsGraph=void 0,ai=e.NsGraph||(e.NsGraph={}),(ci=ai.AnchorGroup||(ai.AnchorGroup={})).TOP="top",ci.BOTTOM="bottom",ci.RIGHT="right",ci.LEFT="left",(ui=ai.AnchorType||(ai.AnchorType={})).INPUT="input",ui.OUTPUT="output";
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */
var li=function(e,t){return li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},li(e,t)};function hi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}li(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function fi(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function pi(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function gi(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}var vi={exports:{}};
/*!
	  Copyright (c) 2018 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/!function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var r=typeof o;if("string"===r||"number"===r)e.push(o);else if(Array.isArray(o)){if(o.length){var s=n.apply(null,o);s&&e.push(s)}}else if("object"===r)if(o.toString===Object.prototype.toString)for(var a in o)t.call(o,a)&&o[a]&&e.push(a);else e.push(o.toString())}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(vi);var yi,mi,bi,_i=vi.exports;
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function Ei(e){return Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(e)}function Ci(e,t,n,i,o,r,s){try{var a=e[r](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,o)}function wi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xi(e,t,n){return t&&Oi(e.prototype,t),n&&Oi(e,n),e}function Ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Si(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ai(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ai(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}!function(e){!function(t){var n="object"==typeof f?f:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",r="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!r&&!s,c={create:r?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(d||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,i){if(R(n)){if(!X(e))throw new TypeError;if(!K(t))throw new TypeError;return O(e,t)}if(!X(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(i)&&!R(i)&&!j(i))throw new TypeError;return j(i)&&(i=void 0),x(e,t,n=V(n),i)}function g(e,t){function n(n,i){if(!F(n))throw new TypeError;if(!R(i)&&!W(i))throw new TypeError;I(e,t,n,i)}return n}function v(e,t,n,i){if(!F(n))throw new TypeError;return R(i)||(i=V(i)),I(e,t,n,i)}function y(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),S(e,t,n)}function m(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),T(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),P(e,t,n)}function _(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),N(e,t,n)}function E(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),k(e,t)}function C(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),M(e,t)}function w(e,t,n){if(!F(t))throw new TypeError;R(n)||(n=V(n));var i=A(t,n,!1);if(R(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var o=f.get(t);return o.delete(n),o.size>0||f.delete(t),!0}function O(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!R(i)&&!j(i)){if(!K(i))throw new TypeError;t=i}}return t}function x(e,t,n,i){for(var o=e.length-1;o>=0;--o){var r=(0,e[o])(t,n,i);if(!R(r)&&!j(r)){if(!F(r))throw new TypeError;i=r}}return i}function A(e,t,n){var i=f.get(e);if(R(i)){if(!n)return;i=new l,f.set(e,i)}var o=i.get(t);if(R(o)){if(!n)return;o=new l,i.set(t,o)}return o}function S(e,t,n){if(T(e,t,n))return!0;var i=Q(t);return!j(i)&&S(e,i,n)}function T(e,t,n){var i=A(t,n,!1);return!R(i)&&B(i.has(e))}function P(e,t,n){if(T(e,t,n))return N(e,t,n);var i=Q(t);return j(i)?void 0:P(e,i,n)}function N(e,t,n){var i=A(t,n,!1);if(!R(i))return i.get(e)}function I(e,t,n,i){A(n,i,!0).set(e,t)}function k(e,t){var n=M(e,t),i=Q(e);if(null===i)return n;var o=k(i,t);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new h,s=[],a=0,c=n;a<c.length;a++){var u=c[a];r.has(u)||(r.add(u),s.push(u))}for(var d=0,l=o;d<l.length;d++){u=l[d];r.has(u)||(r.add(u),s.push(u))}return s}function M(e,t){var n=[],i=A(e,t,!1);if(R(i))return n;for(var o=q(i.keys()),r=0;;){var s=J(o);if(!s)return n.length=r,n;var a=$(s);try{n[r]=a}catch(e){try{Z(o)}finally{throw e}}r++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function R(e){return void 0===e}function j(e){return null===e}function G(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function U(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",o=Y(e,i);if(void 0!==o){var r=o.call(e,n);if(F(r))throw new TypeError;return r}return L(e,"default"===n?"number":n)}function L(e,t){if("string"===t){var n=e.toString;if(z(n))if(!F(o=n.call(e)))return o;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o}else{var i;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o;var o,r=e.toString;if(z(r))if(!F(o=r.call(e)))return o}throw new TypeError}function B(e){return!!e}function H(e){return""+e}function V(e){var t=U(e,3);return G(t)?t:H(t)}function X(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function K(e){return"function"==typeof e}function W(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function q(e){var t=Y(e,o);if(!z(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function $(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var o=i.constructor;return"function"!=typeof o||o===e?t:o}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,o=n+1;o<i;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,r)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function r(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new l}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function ne(){var e=16,n=c.create(),i=o();return function(){function e(){this._key=o()}return e.prototype.has=function(e){var t=r(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=r(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return r(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=r(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=o()},e}();function o(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function r(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var o=t[i];4!==i&&6!==i&&8!==i||(n+="-"),o<16&&(n+="0"),n+=o.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",v),e("hasMetadata",y),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",_),e("getMetadataKeys",E),e("getOwnMetadataKeys",C),e("deleteMetadata",w)}(i)}()}(yi||(yi={})),function(e){function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"===Ei(e)&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NONE=t((function(){}))}(mi||(mi={})),function(e){e.None=function(){return mi.NONE},e.map=function(e,t){return function(n,i){return e((function(e){return n.call(i,t(e))}),void 0)}}}(bi||(bi={}));var Ti=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];wi(this,t),this.mono=void 0,this._callbacks=void 0,this.mono=e}return xi(t,[{key:"callbacks",get:function(){return this._callbacks||(this._callbacks=[]),this._callbacks}},{key:"length",get:function(){return this.callbacks.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.callbacks.push([e,t])}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!this.isEmpty()){for(var n=!1,i=0;i<this.length;i+=1)if(this.callbacks[i][0]===e){if(this.callbacks[i][1]===t)return void this.callbacks.splice(i,1);n=!0}if(n)throw new Error("You should remove it with the same context you add it")}}},{key:e,value:function(){return this.isEmpty()?[][Symbol.iterator]():this.callbacks.slice(0).map((function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e[0].apply(e[1],n)}}))[Symbol.iterator]()}},{key:"invoke",value:function(){var e,t=[],n=Si(this);try{for(n.s();!(e=n.n()).done;){var i=e.value;try{t.push(i.apply(void 0,arguments))}catch(e){console.error(e)}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"isEmpty",value:function(){return 0===this.callbacks.length}},{key:"dispose",value:function(){this._callbacks=void 0}}]),t}(Symbol.iterator),Pi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};wi(this,e),this.options=void 0,this._event=void 0,this._callbacks=void 0,this.disposed=!1,this.options=t}var t;return xi(e,[{key:"callbacks",get:function(){return this._callbacks||(this._callbacks=new Ti),this._callbacks}},{key:"event",get:function(){var t=this;return this._event||(this._event=function(n,i){t.options.onFirstListenerAdd&&t.callbacks.isEmpty()&&t.options.onFirstListenerAdd(t),t.callbacks.add(n,i);var o={dispose:function(){o.dispose=e.noop,t.disposed||(t.callbacks.remove(n,i),o.dispose=e.noop,t.options.onLastListenerRemove&&t.callbacks.isEmpty()&&t.options.onLastListenerRemove(t))}};return o}),this._event}},{key:"fire",value:function(e){this._callbacks&&this.callbacks.invoke(e)}},{key:"sequence",value:(t=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function s(e){Ci(r,i,o,s,a,"next",e)}function a(e){Ci(r,i,o,s,a,"throw",e)}s(void 0)}))}}(regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Si(this.callbacks),e.prev=1,n.s();case 3:if((i=n.n()).done){e.next=12;break}return o=i.value,e.next=7,t(o);case 7:if(e.sent){e.next=10;break}return e.abrupt("break",12);case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[1,14,17,20]])}))),function(e){return t.apply(this,arguments)})},{key:"dispose",value:function(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this.disposed=!0}}]),e}();Pi.noop=function(){};var Ni,Ii=Object.freeze(Object.assign((function(e,t){var n=setTimeout(e.bind(t),0);return{dispose:function(){clearTimeout(n)}}}),{maxListeners:0}));!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:bi.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Ii})}(Ni||(Ni={})),e.Disposable=void 0,function(e){function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"==typeof e&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NULL=t((()=>{}))}(e.Disposable||(e.Disposable={}));class ki{constructor(...e){this.disposables=[],this.onDisposeEmitter=new Pi,this.disposingElements=!1,e.forEach((e=>this.push(e)))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return 0===this.disposables.length}dispose(){return gi(this,void 0,void 0,(function*(){if(!this.disposed&&!this.disposingElements){for(this.disposingElements=!0;!this.disposed;)try{const e=this.disposables.pop();yield e.dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}}))}push(t){const{disposables:n}=this;n.push(t);const i=t.dispose.bind(t),o=e.Disposable.create((()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1),this.checkDisposed()}));return t.dispose=()=>{o.dispose(),i()},o}pushAll(e){return e.map((e=>this.push(e)))}}class Mi{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise(((e,t)=>{this.resolve=(...t)=>{this.isResolved=!0,e(...t)},this.reject=(...e)=>{this.isRejected=!0,t(...e)}}))}}const Di="xflow",Ri=.01,ji="XFLOW_DEFAULT_NODE",Gi="XFLOW_DEFAULT_GROUP_NODE",Fi="XFLOW_DEFAULT_EDGE",Ui="XFLOW_COPY_ITEMS",Li={width:180,height:36};var Bi=Object.freeze({__proto__:null,X6_NODE_PORTAL_NODE_VIEW:"X6_NODE_PORTAL_NODE_VIEW",XFLOW_PREFIX_CLS:Di,MIN_ZOOM:Ri,MAX_ZOOM:1.5,XFLOW_DEFAULT_NODE:ji,XFLOW_DEFAULT_GROUP_NODE:Gi,XFLOW_DEFAULT_EDGE:Fi,LOCAL_STORAGE_KEY:Ui,DEFAULT_NODE_HEIGHT:36,DEFAULT_NODE_WIDTH:180,XFLOW_GROUP_DEFAULT_COLLAPSED_SIZE:Li});function Hi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}var Vi=t.createContext({});function Xi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zi(Object(n),!0).forEach((function(t){Xi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Yi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qi(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function $i(e){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(e)}function Ji(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function Zi(e){return e<=1?100*Number(e)+"%":e}function Qi(e){return 1===e.length?"0"+e:String(e)}function eo(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function to(e){return no(e)/255}function no(e){return parseInt(e,16)}var io={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function oo(e){var t={r:0,g:0,b:0},n=1,i=null,o=null,r=null,s=!1,a=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(io[e])e=io[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=co.rgb.exec(e);if(n)return{r:n[1],g:n[2],b:n[3]};if(n=co.rgba.exec(e))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=co.hsl.exec(e))return{h:n[1],s:n[2],l:n[3]};if(n=co.hsla.exec(e))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=co.hsv.exec(e))return{h:n[1],s:n[2],v:n[3]};if(n=co.hsva.exec(e))return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=co.hex8.exec(e))return{r:no(n[1]),g:no(n[2]),b:no(n[3]),a:to(n[4]),format:t?"name":"hex8"};if(n=co.hex6.exec(e))return{r:no(n[1]),g:no(n[2]),b:no(n[3]),format:t?"name":"hex"};if(n=co.hex4.exec(e))return{r:no(n[1]+n[1]),g:no(n[2]+n[2]),b:no(n[3]+n[3]),a:to(n[4]+n[4]),format:t?"name":"hex8"};if(n=co.hex3.exec(e))return{r:no(n[1]+n[1]),g:no(n[2]+n[2]),b:no(n[3]+n[3]),format:t?"name":"hex"};return!1}(e)),"object"==typeof e&&(uo(e.r)&&uo(e.g)&&uo(e.b)?(t=function(e,t,n){return{r:255*Ji(e,255),g:255*Ji(t,255),b:255*Ji(n,255)}}(e.r,e.g,e.b),s=!0,a="%"===String(e.r).substr(-1)?"prgb":"rgb"):uo(e.h)&&uo(e.s)&&uo(e.v)?(i=Zi(e.s),o=Zi(e.v),t=function(e,t,n){e=6*Ji(e,360),t=Ji(t,100),n=Ji(n,100);var i=Math.floor(e),o=e-i,r=n*(1-t),s=n*(1-o*t),a=n*(1-(1-o)*t),c=i%6;return{r:255*[n,s,r,r,a,n][c],g:255*[a,n,n,s,r,r][c],b:255*[r,r,a,n,n,s][c]}}(e.h,i,o),s=!0,a="hsv"):uo(e.h)&&uo(e.s)&&uo(e.l)&&(i=Zi(e.s),r=Zi(e.l),t=function(e,t,n){var i,o,r;if(e=Ji(e,360),t=Ji(t,100),n=Ji(n,100),0===t)o=n,r=n,i=n;else{var s=n<.5?n*(1+t):n+t-n*t,a=2*n-s;i=eo(a,s,e+1/3),o=eo(a,s,e),r=eo(a,s,e-1/3)}return{r:255*i,g:255*o,b:255*r}}(e.h,i,r),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(n=e.a)),n=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(n),{ok:s,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}var ro="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",so="[\\s|\\(]+("+ro+")[,|\\s]+("+ro+")[,|\\s]+("+ro+")\\s*\\)?",ao="[\\s|\\(]+("+ro+")[,|\\s]+("+ro+")[,|\\s]+("+ro+")[,|\\s]+("+ro+")\\s*\\)?",co={CSS_UNIT:new RegExp(ro),rgb:new RegExp("rgb"+so),rgba:new RegExp("rgba"+ao),hsl:new RegExp("hsl"+so),hsla:new RegExp("hsla"+ao),hsv:new RegExp("hsv"+so),hsva:new RegExp("hsva"+ao),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function uo(e){return Boolean(co.CSS_UNIT.exec(String(e)))}var lo=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function ho(e){var t=function(e,t,n){e=Ji(e,255),t=Ji(t,255),n=Ji(n,255);var i=Math.max(e,t,n),o=Math.min(e,t,n),r=0,s=i,a=i-o,c=0===i?0:a/i;if(i===o)r=0;else{switch(i){case e:r=(t-n)/a+(t<n?6:0);break;case t:r=(n-e)/a+2;break;case n:r=(e-t)/a+4}r/=6}return{h:r,s:c,v:s}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function fo(e){var t=e.r,n=e.g,i=e.b;return"#".concat(function(e,t,n,i){var o=[Qi(Math.round(e).toString(16)),Qi(Math.round(t).toString(16)),Qi(Math.round(n).toString(16))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}(t,n,i,!1))}function po(e,t,n){var i=n/100;return{r:(t.r-e.r)*i+e.r,g:(t.g-e.g)*i+e.g,b:(t.b-e.b)*i+e.b}}function go(e,t,n){var i;return(i=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-2*t:Math.round(e.h)+2*t:n?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?i+=360:i>=360&&(i-=360),i}function vo(e,t,n){return 0===e.h&&0===e.s?e.s:((i=n?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(i=1),n&&5===t&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2)));var i}function yo(e,t,n){var i;return(i=n?e.v+.05*t:e.v-.15*t)>1&&(i=1),Number(i.toFixed(2))}function mo(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],i=oo(e),o=5;o>0;o-=1){var r=ho(i),s=fo(oo({h:go(r,o,!0),s:vo(r,o,!0),v:yo(r,o,!0)}));n.push(s)}n.push(fo(i));for(var a=1;a<=4;a+=1){var c=ho(i),u=fo(oo({h:go(c,a),s:vo(c,a),v:yo(c,a)}));n.push(u)}return"dark"===t.theme?lo.map((function(e){var i=e.index,o=e.opacity;return fo(po(oo(t.backgroundColor||"#141414"),oo(n[i]),100*o))})):n}var bo={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},_o={},Eo={};Object.keys(bo).forEach((function(e){_o[e]=mo(bo[e]),_o[e].primary=_o[e][5],Eo[e]=mo(bo[e],{theme:"dark",backgroundColor:"#141414"}),Eo[e].primary=Eo[e][5]})),_o.red,_o.volcano,_o.gold,_o.orange,_o.yellow,_o.lime,_o.green,_o.cyan,_o.blue,_o.geekblue,_o.purple,_o.magenta,_o.grey;var Co={};function wo(e,t){}function Oo(e,t){!function(e,t,n){t||Co[n]||(e(!1,n),Co[n]=!0)}(wo,e,t)}function xo(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}var Ao="rc-util-key";function So(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function To(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!xo())return null;var i,o=document.createElement("style");(null===(t=n.csp)||void 0===t?void 0:t.nonce)&&(o.nonce=null===(i=n.csp)||void 0===i?void 0:i.nonce);o.innerHTML=e;var r=So(n),s=r.firstChild;return n.prepend&&r.prepend?r.prepend(o):n.prepend&&s?r.insertBefore(o,s):r.appendChild(o),o}var Po=new Map;function No(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=So(n);if(!Po.has(i)){var o=To("",n),r=o.parentNode;Po.set(i,r),r.removeChild(o)}var s=Array.from(Po.get(i).children).find((function(e){return"STYLE"===e.tagName&&e[Ao]===t}));if(s){var a,c,u;if((null===(a=n.csp)||void 0===a?void 0:a.nonce)&&s.nonce!==(null===(c=n.csp)||void 0===c?void 0:c.nonce))s.nonce=null===(u=n.csp)||void 0===u?void 0:u.nonce;return s.innerHTML!==e&&(s.innerHTML=e),s}var d=To(e,n);return d[Ao]=t,d}function Io(e){return"object"===$i(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===$i(e.icon)||"function"==typeof e.icon)}function ko(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){var i=e[n];if("class"===n)t.className=i,delete t.class;else t[n]=i;return t}),{})}function Mo(e,t,n){return n?u.default.createElement(e.tag,Ki(Ki({key:t},ko(e.attrs)),n),(e.children||[]).map((function(n,i){return Mo(n,"".concat(t,"-").concat(e.tag,"-").concat(i))}))):u.default.createElement(e.tag,Ki({key:t},ko(e.attrs)),(e.children||[]).map((function(n,i){return Mo(n,"".concat(t,"-").concat(e.tag,"-").concat(i))})))}function Do(e){return mo(e)[0]}function Ro(e){return e?Array.isArray(e)?e:[e]:[]}var jo="\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",Go=["icon","className","onClick","style","primaryColor","secondaryColor"],Fo={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var Uo=function(e){var n,i,o=e.icon,r=e.className,s=e.onClick,a=e.style,c=e.primaryColor,u=e.secondaryColor,d=qi(e,Go),l=Fo;if(c&&(l={primaryColor:c,secondaryColor:u||Do(c)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jo,n=t.useContext(Vi).csp;t.useEffect((function(){No(e,"@ant-design-icons",{prepend:!0,csp:n})}),[])}(),n=Io(o),i="icon should be icon definiton, but got ".concat(o),Oo(n,"[@ant-design/icons] ".concat(i)),!Io(o))return null;var h=o;return h&&"function"==typeof h.icon&&(h=Ki(Ki({},h),{},{icon:h.icon(l.primaryColor,l.secondaryColor)})),Mo(h.icon,"svg-".concat(h.name),Ki({className:r,onClick:s,style:a,"data-icon":h.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},d))};Uo.displayName="IconReact",Uo.getTwoToneColors=function(){return Ki({},Fo)},Uo.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;Fo.primaryColor=t,Fo.secondaryColor=n||Do(t),Fo.calculated=!!n};var Lo=Uo;function Bo(e){var t=Yi(Ro(e),2),n=t[0],i=t[1];return Lo.setTwoToneColors({primaryColor:n,secondaryColor:i})}var Ho=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];Bo("#1890ff");var Vo=d.forwardRef((function(e,t){var n,i=e.className,o=e.icon,r=e.spin,s=e.rotate,a=e.tabIndex,c=e.onClick,u=e.twoToneColor,l=qi(e,Ho),h=d.useContext(Vi).prefixCls,f=void 0===h?"anticon":h,p=_i(f,(Xi(n={},"".concat(f,"-").concat(o.name),!!o.name),Xi(n,"".concat(f,"-spin"),!!r||"loading"===o.name),n),i),g=a;void 0===g&&c&&(g=-1);var v=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,y=Yi(Ro(u),2),m=y[0],b=y[1];return d.createElement("span",Ki(Ki({role:"img","aria-label":o.name},l),{},{ref:t,tabIndex:g,onClick:c,className:p}),d.createElement(Lo,{icon:o,primaryColor:m,secondaryColor:b,style:v}))}));Vo.displayName="AntdIcon",Vo.getTwoToneColor=function(){var e=Lo.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},Vo.setTwoToneColor=Bo;var Xo=Vo,zo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},Ko=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:zo}))};Ko.displayName="CheckCircleOutlined";var Wo=d.forwardRef(Ko),Yo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}},{tag:"path",attrs:{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"close-circle",theme:"outlined"},qo=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:Yo}))};qo.displayName="CloseCircleOutlined";var $o=d.forwardRef(qo),Jo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"},Zo=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:Jo}))};Zo.displayName="DatabaseOutlined";var Qo=d.forwardRef(Zo),er={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},tr=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:er}))};tr.displayName="ExclamationCircleOutlined";var nr=d.forwardRef(tr),ir={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},or=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:ir}))};or.displayName="InfoCircleOutlined";var rr=d.forwardRef(or),sr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"},ar=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:sr}))};ar.displayName="MinusSquareOutlined";var cr=d.forwardRef(ar),ur={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"},dr=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:ur}))};dr.displayName="PlusSquareOutlined";var lr=d.forwardRef(dr),hr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},fr=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:hr}))};fr.displayName="QuestionCircleOutlined";var pr=d.forwardRef(fr),gr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},vr=function(e,t){return d.createElement(Xo,Ki(Ki({},e),{},{ref:t,icon:gr}))};vr.displayName="RedoOutlined";var yr=d.forwardRef(vr);const mr=u.default.createContext(null);mr.displayName="XFlowAppContext";const br=()=>{const e=u.default.useContext(mr);return e&&e.getApp?e.getApp():null};class _r{constructor(e=!1){this.cache=null,this.setApp=e=>{this.cache=e,this.onAppChangeCallback&&this.onAppChangeCallback(e)},this.isUserDefined=()=>this.isUserDefinedFlag,this.getApp=()=>this.cache,this.onAppChange=e=>{this.onAppChangeCallback=e},this.dispose=()=>{this.cache=null},this.isUserDefinedFlag=e}}const Er=e=>{const t=u.default.useContext(mr),[,n]=u.default.useState(null),i=u.default.useMemo((()=>t&&t.isUserDefined()?t:new _r(!1)),[]);return i.isUserDefined()||i.onAppChange((()=>n(0))),u.default.useEffect((()=>{e.app&&i.setApp(e.app)}),[e.app]),i.isUserDefined()?u.default.createElement(u.default.Fragment,null,e.children):u.default.createElement(mr.Provider,{value:Object.assign({},i)},e.children)};Er.displayName="XFlowAppInternalProvider";const Cr=({children:e})=>{const[,t]=u.default.useState(null),n=u.default.useMemo((()=>new _r(!0)),[]);return n.onAppChange((()=>t(0))),u.default.createElement(mr.Provider,{value:Object.assign({},n)},e)};Cr.displayName="XFlowAppProvider",e.XFlowNodeCommands=void 0,function(e){const t="";e.ADD_NODE={id:"xflow:add-node",label:"",category:t},e.MOVE_NODE={id:"xflow:move-node",label:"Move Node",category:t},e.DEL_NODE={id:"xflow:del-node",label:"",category:t},e.UPDATE_NODE={id:"xflow:update-node",label:"",category:t},e.HIGHLIGHT_NODE={id:"xflow:highlight-node",label:"",category:t},e.SELECT_NODE={id:"xflow:select-node",label:"",category:t},e.CENTER_NODE={id:"xflow:center-node",label:"",category:t},e.FRONT_NODE={id:"xflow:front-node",label:"",category:t},e.BACK_NODE={id:"xflow:back-node",label:"",category:t}}(e.XFlowNodeCommands||(e.XFlowNodeCommands={})),e.XFlowEdgeCommands=void 0,function(e){const t="";e.ADD_EDGE={id:"xflow:add-edge",label:"",category:t},e.DEL_EDGE={id:"xflow:del-edge",label:"",category:t},e.UPDATE_EDGE={id:"xflow:update-edge",label:"",category:t},e.HIGHLIGHT_EDGE={id:"xflow:highlight-edge",label:"",category:t},e.FRONT_EDGE={id:"xflow:front-edge",label:"",category:t},e.BACK_EDGE={id:"xflow:back-edge",label:"",category:t}}(e.XFlowEdgeCommands||(e.XFlowEdgeCommands={})),e.XFlowGraphCommands=void 0,function(e){const t="";e.LOAD_META={id:"xflow:load-meta",label:"",category:t},e.LOAD_DATA={id:"xflow:load-data",label:"",category:t},e.SAVE_GRAPH_DATA={id:"xflow:save-graph-data",label:"",category:t},e.GRAPH_LAYOUT={id:"xflow:layout",label:"",category:t},e.GRAPH_RENDER={id:"xflow:graph-render",label:"",category:t},e.UNDO_CMD={id:"xflow:undo-cmd",label:"",category:t},e.REDO_CMD={id:"xflow:redo-cmd",label:"",category:t},e.GRAPH_INSTANCE_COMMAND={id:"xflow:graph-instacne-cmd",label:"GraphCommand",category:t},e.GRAPH_ZOOM={id:"xflow:graph-zoom",label:"",category:t},e.GRAPH_RESIZE={id:"xflow:graph-resize",label:"",category:t},e.GRAPH_COPY={id:"xflow:graph-copy-selection",label:"",category:t},e.GRAPH_PASTE={id:"xflow:graph-paste-selection",label:"",category:t},e.GRAPH_TOGGLE_MULTI_SELECT={id:"xflow:graph-toggle-multi-select",label:"",category:t},e.GRAPH_ADD_TOOL={id:"xflow:add-tool",label:"",category:t},e.GRAPH_DEL_TOOL={id:"xflow:del-tool",label:"",category:t},e.GRAPH_HISTORY_UNDO={id:"xflow:history-undo",label:"history undo",category:t},e.GRAPH_HISTORY_REDO={id:"xflow:history-redo",label:"history redo",category:t},e.GRAPH_HISTORY_RESET={id:"xflow:history-reset",label:"history reset",category:t},e.GRAPH_HISTORY_TOGGLE={id:"xflow:history-toggle",label:"history toggle",category:t}}(e.XFlowGraphCommands||(e.XFlowGraphCommands={})),e.XFlowModelCommands=void 0,(e.XFlowModelCommands||(e.XFlowModelCommands={})).UPDATE_MODEL={id:"xflow:update-model",label:"",category:""},e.XFlowGroupCommands=void 0,function(e){const t="";e.INIT_GROUP={id:"xflow:init-group",label:"",category:t},e.ADD_GROUP={id:"xflow:add-group",label:"",category:t},e.DEL_GROUP={id:"xflow:del-group",label:"",category:t},e.COLLAPSE_GROUP={id:"xflow:collapse-group",label:"",category:t}}(e.XFlowGroupCommands||(e.XFlowGroupCommands={}));const wr=t=>{const{cell:n}=t,i=br(),o=t.data.isCollapsed||!1;return u.default.createElement("div",{className:"xflow-default-group-node"},u.default.createElement("div",{className:"xflow-group-header"},u.default.createElement("div",{className:"header-left"},t.data.label),u.default.createElement("div",{className:"header-right"},o&&u.default.createElement(lr,{onClick:t=>{t.preventDefault(),i.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!1})}}),!o&&u.default.createElement(cr,{onClick:t=>{t.preventDefault(),i.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!0,gap:3})}}))))};wr.displayName="XFlowDefaultGroupNode";const Or={fontSize:"16px",color:"#3057e3"};var xr;!function(e){e.SUCCESS="success",e.PROCESSING="processing",e.ERROR="error",e.DEFAULT="default",e.WARNING="warning"}(xr||(xr={}));const Ar=e=>{if(e.hide)return null;switch(e.status){case xr.PROCESSING:return u.default.createElement(yr,{spin:!0,style:{color:"#c1cdf7",fontSize:"16px"}});case xr.ERROR:return u.default.createElement($o,{style:{color:"#ff4d4f",fontSize:"16px"}});case xr.SUCCESS:return u.default.createElement(Wo,{style:{color:"#39ca74cc",fontSize:"16px"}});case xr.WARNING:return u.default.createElement(nr,{style:{color:"#faad14",fontSize:"16px"}});case xr.DEFAULT:return u.default.createElement(rr,{style:{color:"#d9d9d9",fontSize:"16px"}});default:return null}},Sr=e=>{const t=u.default.isValidElement(e.data.icon)?e.data.icon:u.default.createElement(Qo,{style:Or});return u.default.createElement("div",{className:"xflow-default-node "+(e.isNodeTreePanel?"panel-node":"")},u.default.createElement("span",{className:"icon"},t),u.default.createElement("span",{className:"label"},e.data.label),u.default.createElement("span",{className:"status"},u.default.createElement(Ar,{status:e.data&&e.data.status,hide:e.isNodeTreePanel})))};var Tr;Sr.displayName="XFlowDefaultNode",function(e){e.CONFIG_TYPE="GraphConfig",e.defaultNodeTypeParser=e=>e.renderKey,e.defaultEdgeTypeParser=e=>e.renderKey,e.defaultNodeMapValue=[[ji,Sr],[Gi,wr]]}(Tr||(Tr={}));class Pr{constructor(){this.CONFIG_TYPE=Tr.CONFIG_TYPE,this.x6Options=new Mi,this.rootContainer=new Mi,this.graphContainer=new Mi,this.nodeRender=new Map(Tr.defaultNodeMapValue),this.edgeRender=new Map,this.nodeTypeParser=Tr.defaultNodeTypeParser,this.edgeTypeParser=Tr.defaultEdgeTypeParser,this.events=[],this.mergeX6Config=e=>gi(this,void 0,void 0,(function*(){const t=yield this.getX6Config();return Object.assign(t,e)})),this.getX6Config=()=>gi(this,void 0,void 0,(function*(){return yield this.x6Options.promise})),this.setX6Config=e=>{var t;const n=this.getDefaultGraphOptions();null===(t=this.x6Options)||void 0===t||t.resolve(Object.assign(Object.assign({},n),e))},this.setRootContainer=e=>{e&&(null==this||this.rootContainer.resolve(e))},this.setGraphContainer=e=>{var t;e&&(null===(t=this.graphContainer)||void 0===t||t.resolve(e))},this.setEvents=e=>{this.events=e},this.setDefaultNodeRender=e=>{this.nodeRender.set(ji,e)},this.setDefaultEdgeRender=e=>{this.edgeRender.set(Fi,e)},this.setNodeRender=(e,t)=>{this.nodeRender.set(e,t)},this.setEdgeRender=(e,t)=>{this.edgeRender.set(e,t)},this.setNodeTypeParser=e=>{this.nodeTypeParser=e},this.setEdgeTypeParser=e=>{this.edgeTypeParser=e},this.getConfig=()=>gi(this,void 0,void 0,(function*(){const[e,t,n]=yield Promise.all([this.rootContainer.promise,this.graphContainer.promise,this.x6Options.promise]);return{xflowInstanceId:this.xflowInstanceId,graphId:this.graphId,nodeViewId:this.graphId,rootContainer:e,graphContainer:t,x6Options:n,events:this.events,nodeRender:this.nodeRender,edgeRender:this.edgeRender,nodeTypeParser:this.nodeTypeParser,edgeTypeParser:this.edgeTypeParser}})),this.getDefaultGraphOptions=()=>({rotating:!1,resizing:!1,connecting:{snap:!0,dangling:!1,highlight:!1,connectionPoint:"rect",router:{name:"er"},connector:{name:"rounded",args:{radius:15}}},background:{},grid:{visible:!0},selecting:{strict:!0,enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},snapline:{enabled:!1},history:{enabled:!1},clipboard:{enabled:!0,useLocalStorage:!0},scroller:{enabled:!1},mousewheel:{enabled:!0,minScale:Ri,maxScale:1.5,factor:1.1,modifiers:["ctrl","meta"]},panning:{enabled:!0},scaling:{min:Ri,max:1.5},keyboard:{enabled:!0},interacting:{nodeMovable:!0,edgeLabelMovable:!1},async:!1}),this.dispose=()=>{this.rootContainer=new Mi,this.graphContainer=new Mi,this.x6Options=new Mi},this.graphId=Hi()}}const Nr=Symbol("IGraphOptionProvider");function Ir(e){return"function"==typeof e}var kr=!1,Mr={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;kr=e},get useDeprecatedSynchronousErrorHandling(){return kr}};function Dr(e){setTimeout((function(){throw e}),0)}var Rr={closed:!0,next:function(e){},error:function(e){if(Mr.useDeprecatedSynchronousErrorHandling)throw e;Dr(e)},complete:function(){}},jr=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function Gr(e){return null!==e&&"object"==typeof e}var Fr=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),Ur=Fr,Lr=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,i=n._parentOrParents,o=n._ctorUnsubscribe,r=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(var a=0;a<i.length;++a){i[a].remove(this)}if(Ir(r)){o&&(this._unsubscribe=void 0);try{r.call(this)}catch(e){t=e instanceof Ur?Br(e.errors):[e]}}if(jr(s)){a=-1;for(var c=s.length;++a<c;){var u=s[a];if(Gr(u))try{u.unsubscribe()}catch(e){t=t||[],e instanceof Ur?t=t.concat(Br(e.errors)):t.push(e)}}}if(t)throw new Ur(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var i=n;(n=new e)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof e){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function Br(e){return e.reduce((function(e,t){return e.concat(t instanceof Ur?t.errors:t)}),[])}var Hr=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Vr=function(e){function t(n,i,o){var r=e.call(this)||this;switch(r.syncErrorValue=null,r.syncErrorThrown=!1,r.syncErrorThrowable=!1,r.isStopped=!1,arguments.length){case 0:r.destination=Rr;break;case 1:if(!n){r.destination=Rr;break}if("object"==typeof n){n instanceof t?(r.syncErrorThrowable=n.syncErrorThrowable,r.destination=n,n.add(r)):(r.syncErrorThrowable=!0,r.destination=new Xr(r,n));break}default:r.syncErrorThrowable=!0,r.destination=new Xr(r,n,i,o)}return r}return hi(t,e),t.prototype[Hr]=function(){return this},t.create=function(e,n,i){var o=new t(e,n,i);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(Lr),Xr=function(e){function t(t,n,i,o){var r,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return Ir(n)?r=n:n&&(r=n.next,i=n.error,o=n.complete,n!==Rr&&(Ir((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=r,s._error=i,s._complete=o,s}return hi(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;Mr.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=Mr.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):Dr(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;Dr(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};Mr.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),Mr.useDeprecatedSynchronousErrorHandling)throw e;Dr(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!Mr.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return Mr.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(Dr(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Vr);var zr=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Kr(e){return e}function Wr(e){return 0===e.length?Kr:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Yr=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i=this.operator,o=function(e,t,n){if(e){if(e instanceof Vr)return e;if(e[Hr])return e[Hr]()}return e||t||n?new Vr(e,t,n):new Vr(Rr)}(e,t,n);if(i?o.add(i.call(o,this.source)):o.add(this.source||Mr.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),Mr.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){Mr.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,n=t.closed,i=t.destination,o=t.isStopped;if(n||o)return!1;e=i&&i instanceof Vr?i:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=qr(t))((function(t,i){var o;o=n.subscribe((function(t){try{e(t)}catch(e){i(e),o&&o.unsubscribe()}}),i,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[zr]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:Wr(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=qr(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function qr(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var $r=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),Jr=function(e){function t(t,n){var i=e.call(this)||this;return i.subject=t,i.subscriber=n,i.closed=!1,i}return hi(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(Lr),Zr=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return hi(t,e),t}(Vr),Qr=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return hi(t,e),t.prototype[Hr]=function(){return new Zr(this)},t.prototype.lift=function(e){var t=new es(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new $r;if(!this.isStopped)for(var t=this.observers,n=t.length,i=t.slice(),o=0;o<n;o++)i[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new $r;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),o=0;o<n;o++)i[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new $r;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),i=0;i<t;i++)n[i].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new $r;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new $r;return this.hasError?(e.error(this.thrownError),Lr.EMPTY):this.isStopped?(e.complete(),Lr.EMPTY):(this.observers.push(e),new Jr(this,e))},t.prototype.asObservable=function(){var e=new Yr;return e.source=this,e},t.create=function(e,t){return new es(e,t)},t}(Yr),es=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return hi(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Lr.EMPTY},t}(Qr),ts=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return hi(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $r;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Qr),ns=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return hi(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,i=void 0;try{this.work(e)}catch(e){n=!0,i=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),i},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return hi(t,e),t.prototype.schedule=function(e,t){return this},t}(Lr)),is=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),os=function(e){function t(n,i){void 0===i&&(i=is.now);var o=e.call(this,n,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():i()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return hi(t,e),t.prototype.schedule=function(n,i,o){return void 0===i&&(i=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,i,o):e.prototype.schedule.call(this,n,i,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(is),rs=new os(ns),ss=rs;var as=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new cs(e,this.predicate,this.thisArg))},e}(),cs=function(e){function t(t,n,i){var o=e.call(this,t)||this;return o.predicate=n,o.thisArg=i,o.count=0,o}return hi(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Vr);var us=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new ds(e,this.compare,this.keySelector))},e}(),ds=function(e){function t(t,n,i){var o=e.call(this,t)||this;return o.keySelector=i,o.hasKey=!1,"function"==typeof n&&(o.compare=n),o}return hi(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var i=!1;if(this.hasKey)try{i=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))},t}(Vr),ls={leading:!0,trailing:!1};var hs=function(){function e(e,t,n,i){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=i}return e.prototype.call=function(e,t){return t.subscribe(new fs(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),fs=function(e){function t(t,n,i,o,r){var s=e.call(this,t)||this;return s.duration=n,s.scheduler=i,s.leading=o,s.trailing=r,s._hasTrailingValue=!1,s._trailingValue=null,s}return hi(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(ps,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(Vr);function ps(e){e.subscriber.clearThrottle()}function gs(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function vs(e){return!!e&&!!e[ta]}function ys(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===ia}(e)||Array.isArray(e)||!!e[ea]||!!e.constructor[ea]||Cs(e)||ws(e))}function ms(e,t,n){void 0===n&&(n=!1),0===bs(e)?(n?Object.keys:oa)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function bs(e){var t=e[ta];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Cs(e)?2:ws(e)?3:0}function _s(e,t){return 2===bs(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Es(e,t,n){var i=bs(e);2===i?e.set(t,n):3===i?(e.delete(t),e.add(n)):e[t]=n}function Cs(e){return $s&&e instanceof Map}function ws(e){return Js&&e instanceof Set}function Os(e){return e.o||e.t}function xs(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=ra(e);delete t[ta];for(var n=oa(t),i=0;i<n.length;i++){var o=n[i],r=t[o];!1===r.writable&&(r.writable=!0,r.configurable=!0),(r.get||r.set)&&(t[o]={configurable:!0,writable:!0,enumerable:r.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function As(e,t){return void 0===t&&(t=!1),Ts(e)||vs(e)||!ys(e)||(bs(e)>1&&(e.set=e.add=e.clear=e.delete=Ss),Object.freeze(e),t&&ms(e,(function(e,t){return As(t,!0)}),!0)),e}function Ss(){gs(2)}function Ts(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Ps(e){var t=sa[e];return t||gs(18,e),t}function Ns(){return Ys}function Is(e,t){t&&(Ps("Patches"),e.u=[],e.s=[],e.v=t)}function ks(e){Ms(e),e.p.forEach(Rs),e.p=null}function Ms(e){e===Ys&&(Ys=e.l)}function Ds(e){return Ys={p:[],l:Ys,h:e,m:!0,_:0}}function Rs(e){var t=e[ta];0===t.i||1===t.i?t.j():t.O=!0}function js(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.g||Ps("ES5").S(t,e,i),i?(n[ta].P&&(ks(t),gs(4)),ys(e)&&(e=Gs(t,e),t.l||Us(t,e)),t.u&&Ps("Patches").M(n[ta],e,t.u,t.s)):e=Gs(t,n,[]),ks(t),t.u&&t.v(t.u,t.s),e!==Qs?e:void 0}function Gs(e,t,n){if(Ts(t))return t;var i=t[ta];if(!i)return ms(t,(function(o,r){return Fs(e,i,t,o,r,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return Us(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var o=4===i.i||5===i.i?i.o=xs(i.k):i.o;ms(3===i.i?new Set(o):o,(function(t,r){return Fs(e,i,o,t,r,n)})),Us(e,o,!1),n&&e.u&&Ps("Patches").R(i,n,e.u,e.s)}return i.o}function Fs(e,t,n,i,o,r){if(vs(o)){var s=Gs(e,o,r&&t&&3!==t.i&&!_s(t.D,i)?r.concat(i):void 0);if(Es(n,i,s),!vs(s))return;e.m=!1}if(ys(o)&&!Ts(o)){if(!e.h.F&&e._<1)return;Gs(e,o),t&&t.A.l||Us(e,o)}}function Us(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&As(t,n)}function Ls(e,t){var n=e[ta];return(n?Os(n):e)[t]}function Bs(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function Hs(e){e.P||(e.P=!0,e.l&&Hs(e.l))}function Vs(e){e.o||(e.o=xs(e.t))}function Xs(e,t,n){var i=Cs(t)?Ps("MapSet").N(t,n):ws(t)?Ps("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:Ns(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=i,r=aa;n&&(o=[i],r=ca);var s=Proxy.revocable(o,r),a=s.revoke,c=s.proxy;return i.k=c,i.j=a,c}(t,n):Ps("ES5").J(t,n);return(n?n.A:Ns()).p.push(i),i}function zs(e){return vs(e)||gs(22,e),function e(t){if(!ys(t))return t;var n,i=t[ta],o=bs(t);if(i){if(!i.P&&(i.i<4||!Ps("ES5").K(i)))return i.t;i.I=!0,n=Ks(t,o),i.I=!1}else n=Ks(t,o);return ms(n,(function(t,o){i&&function(e,t){return 2===bs(e)?e.get(t):e[t]}(i.t,t)===o||Es(n,t,e(o))})),3===o?new Set(n):n}(e)}function Ks(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return xs(e)}var Ws,Ys,qs="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),$s="undefined"!=typeof Map,Js="undefined"!=typeof Set,Zs="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Qs=qs?Symbol.for("immer-nothing"):((Ws={})["immer-nothing"]=!0,Ws),ea=qs?Symbol.for("immer-draftable"):"__$immer_draftable",ta=qs?Symbol.for("immer-state"):"__$immer_state",na="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",ia=""+Object.prototype.constructor,oa="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,ra=Object.getOwnPropertyDescriptors||function(e){var t={};return oa(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},sa={},aa={get:function(e,t){if(t===ta)return e;var n=Os(e);if(!_s(n,t))return function(e,t,n){var i,o=Bs(t,n);return o?"value"in o?o.value:null===(i=o.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!ys(i)?i:i===Ls(e.t,t)?(Vs(e),e.o[t]=Xs(e.A.h,i,e)):i},has:function(e,t){return t in Os(e)},ownKeys:function(e){return Reflect.ownKeys(Os(e))},set:function(e,t,n){var i=Bs(Os(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var o=Ls(Os(e),t),r=null==o?void 0:o[ta];if(r&&r.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,o)&&(void 0!==n||_s(e.t,t)))return!0;Vs(e),Hs(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Ls(e.t,t)||t in e.t?(e.D[t]=!1,Vs(e),Hs(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Os(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){gs(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){gs(12)}},ca={};ms(aa,(function(e,t){ca[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),ca.deleteProperty=function(e,t){return aa.deleteProperty.call(this,e[0],t)},ca.set=function(e,t,n){return aa.set.call(this,e[0],t,n,e[0])};var ua=function(){function e(e){var t=this;this.g=Zs,this.F=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var r=t;return function(e){var t=this;void 0===e&&(e=o);for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return r.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&gs(6),void 0!==i&&"function"!=typeof i&&gs(7),ys(e)){var a=Ds(t),c=Xs(t,e,void 0),u=!0;try{s=n(c),u=!1}finally{u?ks(a):Ms(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return Is(a,i),js(e,a)}),(function(e){throw ks(a),e})):(Is(a,i),js(s,a))}if(!e||"object"!=typeof e){if((s=n(e))===Qs)return;return void 0===s&&(s=e),t.F&&As(s,!0),s}gs(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))}:[t.produce(e,n,(function(e,t){i=e,o=t})),i,o];var i,o},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){ys(e)||gs(8),vs(e)&&(e=zs(e));var t=Ds(this),n=Xs(this,e,void 0);return n[ta].C=!0,Ms(t),n},t.finishDraft=function(e,t){var n=(e&&e[ta]).A;return Is(n,t),js(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Zs&&gs(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var o=Ps("Patches").$;return vs(e)?o(e,t):this.produce(e,(function(e){return o(e,t)}))},e}(),da=new ua,la=da.produce;da.produceWithPatches.bind(da);var ha=da.setAutoFreeze.bind(da);da.setUseProxies.bind(da),da.applyPatches.bind(da);var fa=da.createDraft.bind(da),pa=da.finishDraft.bind(da);!function(){function e(e,t){function n(){this.constructor=e}o(e,t),e.prototype=(n.prototype=t.prototype,new n)}function t(e){e.o||(e.D=new Map,e.o=new Map(e.t))}function n(e){e.o||(e.o=new Set,e.t.forEach((function(t){if(ys(t)){var n=Xs(e.A.h,t,e);e.p.set(t,n),e.o.add(n)}else e.o.add(t)})))}function i(e){e.O&&gs(3,JSON.stringify(Os(e)))}var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},r=function(){function n(e,t){return this[ta]={i:2,l:t,A:t?t.A:Ns(),P:!1,I:!1,o:void 0,D:void 0,t:e,k:this,C:!1,O:!1},this}e(n,Map);var o=n.prototype;return Object.defineProperty(o,"size",{get:function(){return Os(this[ta]).size}}),o.has=function(e){return Os(this[ta]).has(e)},o.set=function(e,n){var o=this[ta];return i(o),Os(o).has(e)&&Os(o).get(e)===n||(t(o),Hs(o),o.D.set(e,!0),o.o.set(e,n),o.D.set(e,!0)),this},o.delete=function(e){if(!this.has(e))return!1;var n=this[ta];return i(n),t(n),Hs(n),n.D.set(e,!1),n.o.delete(e),!0},o.clear=function(){var e=this[ta];i(e),Os(e).size&&(t(e),Hs(e),e.D=new Map,ms(e.t,(function(t){e.D.set(t,!1)})),e.o.clear())},o.forEach=function(e,t){var n=this;Os(this[ta]).forEach((function(i,o){e.call(t,n.get(o),o,n)}))},o.get=function(e){var n=this[ta];i(n);var o=Os(n).get(e);if(n.I||!ys(o))return o;if(o!==n.t.get(e))return o;var r=Xs(n.A.h,o,n);return t(n),n.o.set(e,r),r},o.keys=function(){return Os(this[ta]).keys()},o.values=function(){var e,t=this,n=this.keys();return(e={})[na]=function(){return t.values()},e.next=function(){var e=n.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},o.entries=function(){var e,t=this,n=this.keys();return(e={})[na]=function(){return t.entries()},e.next=function(){var e=n.next();if(e.done)return e;var i=t.get(e.value);return{done:!1,value:[e.value,i]}},e},o[na]=function(){return this.entries()},n}(),s=function(){function t(e,t){return this[ta]={i:3,l:t,A:t?t.A:Ns(),P:!1,I:!1,o:void 0,t:e,k:this,p:new Map,O:!1,C:!1},this}e(t,Set);var o=t.prototype;return Object.defineProperty(o,"size",{get:function(){return Os(this[ta]).size}}),o.has=function(e){var t=this[ta];return i(t),t.o?!!t.o.has(e)||!(!t.p.has(e)||!t.o.has(t.p.get(e))):t.t.has(e)},o.add=function(e){var t=this[ta];return i(t),this.has(e)||(n(t),Hs(t),t.o.add(e)),this},o.delete=function(e){if(!this.has(e))return!1;var t=this[ta];return i(t),n(t),Hs(t),t.o.delete(e)||!!t.p.has(e)&&t.o.delete(t.p.get(e))},o.clear=function(){var e=this[ta];i(e),Os(e).size&&(n(e),Hs(e),e.o.clear())},o.values=function(){var e=this[ta];return i(e),n(e),e.o.values()},o.entries=function(){var e=this[ta];return i(e),n(e),e.o.entries()},o.keys=function(){return this.values()},o[na]=function(){return this.values()},o.forEach=function(e,t){for(var n=this.values(),i=n.next();!i.done;)e.call(t,i.value,i.value,this),i=n.next()},t}();!function(e,t){sa[e]||(sa[e]=t)}("MapSet",{N:function(e,t){return new r(e,t)},T:function(e,t){return new s(e,t)}})}(),ha(!1),e.NsModel=void 0,function(e){function t(t){return t!==e.EMPTY_VALUE}e.EMPTY_VALUE=Symbol("EMPTY_MODEL_VALUE"),e.isValidValue=t,e.defaultPipeFunction=function(e){return e.pipe((function(e){return e.lift(new us(o,r))}),(n=e=>t(e),function(e){return e.lift(new as(n,i))}),function(e,t,n){return void 0===t&&(t=ss),void 0===n&&(n=ls),function(i){return i.lift(new hs(e,t,n.leading,n.trailing))}}(17,rs,{leading:!1,trailing:!0}));var n,i,o,r}}(e.NsModel||(e.NsModel={}));class ga{constructor(t=e.NsModel.EMPTY_VALUE,n=30){this.toDispose=new ki,this.watch=(t,n=e.NsModel.defaultPipeFunction)=>{this.subject$.observers.length+1>this.maxSubscription&&console.warn(`${this.subject$} reach maxSubscription limitation, please check`);const i=(n?n(this.subject$):this.subject$).subscribe(t);return e.Disposable.create((()=>{i.unsubscribe()}))},this.getValue=()=>this.subject$.getValue(),this.setValue=t=>{if(this.subject$)if("function"!=typeof t)this.subject$.next(t);else{const n=this.subject$.getValue(),i=la(n,(e=>{t(e)}));e.NsModel.isValidValue(i)&&this.setValue(i)}},this.hasValidValue=()=>{const t=this.getValue();return e.NsModel.isValidValue(t)},this.getValidValue=()=>gi(this,void 0,void 0,(function*(){const t=new Mi;if(this.hasValidValue())return this.getValue();const n=this.watch((i=>{e.NsModel.isValidValue(i)&&(t.resolve(i),n.dispose())}));return t.promise})),this.dispose=()=>{this.toDispose.dispose()},this.subject$=new ts(t||e.NsModel.EMPTY_VALUE),this.maxSubscription=n,this.toDispose.push(e.Disposable.create((()=>{this.subject$.complete(),this.subject$.unsubscribe(),this.subject$=null})))}}const va=An.defineToken("IFrontendApplicationContribution"),ya=Symbol("IGraphCommandService"),ma=An.defineToken("ICommandHandler"),ba=Symbol("ICommandContextProvider"),_a=Symbol("IGraphCommandFactory"),Ea=An.defineToken("IGraphCommandContribution");var Ca,wa,Oa;!function(e){e.is=function(e){return!!e&&e===Object(e)&&"id"in e},e.compareCommands=function(e,t){if(e.label&&t.label){const n=(e.category?`${e.category}: ${e.label}`:e.label).toLowerCase(),i=(t.category?`${t.category}: ${t.label}`:t.label).toLowerCase();return n.localeCompare(i)}return 0},e.equals=function(e,t){return e.id===t.id&&e.label===t.label&&e.iconName===t.iconName&&e.category===t.category}}(Ca||(Ca={})),e.GraphCommandRegistry=class{constructor(e){this.contributionProvider=e,this.redoStack=[],this.undoStack=[],this.commands=new Map,this.factories=new Map,this.disposables=new Map,this.cmdChangeEvent=new ga(null),this.Globals=new ga(new Map),this.setGlobal=(e,t)=>{this.Globals.setValue((n=>{n.set(e,t)}))},this.getGlobal=e=>this.Globals.getValue().get(e),this.undoCommand=()=>gi(this,void 0,void 0,(function*(){const e=this.undoStack.pop();e?(yield e.undo(),this.redoStack.push(e),this.cmdChangeEvent.setValue(null)):console.error("empty undo stack")})),this.redoCommand=()=>gi(this,void 0,void 0,(function*(){const e=this.redoStack.pop();e?(yield e.redo(),this.undoStack.push(e),this.cmdChangeEvent.setValue(null)):console.error("empty undo stack")})),this.registerDisposableCommand=e=>{const t=new ki;return e({registerCommand:(e,n)=>{const i=this.registerCommand(e,n);return t.push(i),i}}),t}}get watchChange(){return this.cmdChangeEvent.watch}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerGraphCommands(this)}executeCommandPipeline(e){return gi(this,void 0,void 0,(function*(){let t=null;for(const n of e){const e=null==t?void 0:t.contextProvider(),{args:i,hooks:o}=yield null==n?void 0:n.getCommandOption(e);t=yield this.executeCommand(null==n?void 0:n.commandId,i,o)}return this.cmdChangeEvent.setValue(null),t}))}executeCommand(e,t,n=[]){return gi(this,void 0,void 0,(function*(){const i=this.getFactory(e);if(i){const o=yield i.createCommand(e,t,n);return yield o.execute(),o.isUndoable()&&this.undoStack.push(o),this.cmdChangeEvent.setValue(null),o}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}executeUndoCommand(e,t,n=[]){return gi(this,void 0,void 0,(function*(){const i=this.getFactory(e);if(i){const o=yield i.createCommand(e,t,n);return yield o.execute(),o}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}createCommand(e,t,n=[]){return gi(this,void 0,void 0,(function*(){const i=this.getFactory(e);if(i){return yield i.createCommand(e,t,n)}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}get isUndoable(){return this.undoStack.length>0}get isRedoable(){return this.redoStack.length>0}hasCommand(e){return this.commands.has(e)}getCommand(e){return this.commands.get(e)}registerCommand(t,n){if(this.factories.has(t.id))return console.warn(`A command ${t.id} is already registered.`),e.Disposable.NULL;const i=new ki(this.doRegisterCommand(t),this.registerFactory(t.id,n),e.Disposable.create((()=>this.disposables.delete(t.id))));return this.disposables.set(t.id,i),i}doRegisterCommand(t){return this.commands.set(t.id,t),e.Disposable.create((()=>this.disposables.delete(t.id)))}unregisterCommand(e){const t=Ca.is(e)?e.id:e,n=this.disposables.get(t);n&&n.dispose()}hasFactory(e){return!!this.factories.get(e)}getFactory(e){return this.factories.get(e)}registerFactory(t,n,i=!1){return this.hasFactory(t)&&!1===i&&console.error("cannot register command:",t),this.factories.set(t,n),e.Disposable.create((()=>{this.factories.delete(t)}))}getAllFactories(){return Array.from(this.factories.entries())}},e.GraphCommandRegistry=fi([zn({contrib:[va,ya]}),(wa=0,Oa=si(Ea),function(e,t){Oa(e,t,wa)}),pi("design:paramtypes",[Object])],e.GraphCommandRegistry);const xa=oi((t=>{ri.register(t,Ea),t(e.GraphCommandRegistry)})),Aa=An.defineToken("IModelService"),Sa=An.defineToken("IModelContribution"),Ta=Symbol("IModelOptionProvider");var Pa;!function(e){e.ASYNC_SRRIES="ASYNC_SRRIES",e.ASYNC_PARALLEL="ASYNC_PARALLEL"}(Pa||(Pa={}));var Na={exports:{}};function Ia(e,t){var n=e.length,i=new Array(n),o={},r=n,s=function(e){for(var t=new Map,n=0,i=e.length;n<i;n++){var o=e[n];t.has(o[0])||t.set(o[0],new Set),t.has(o[1])||t.set(o[1],new Set),t.get(o[0]).add(o[1])}return t}(t),a=function(e){for(var t=new Map,n=0,i=e.length;n<i;n++)t.set(e[n],n);return t}(e);for(t.forEach((function(e){if(!a.has(e[0])||!a.has(e[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));r--;)o[r]||c(e[r],r,new Set);return i;function c(e,t,r){if(r.has(e)){var u;try{u=", node was:"+JSON.stringify(e)}catch(e){u=""}throw new Error("Cyclic dependency"+u)}if(!a.has(e))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(e));if(!o[t]){o[t]=!0;var d=s.get(e)||new Set;if(t=(d=Array.from(d)).length){r.add(e);do{var l=d[--t];c(l,a.get(l),r)}while(t);r.delete(e)}i[--n]=e}}}Na.exports=function(e){return Ia(function(e){for(var t=new Set,n=0,i=e.length;n<i;n++){var o=e[n];t.add(o[0]),t.add(o[1])}return Array.from(t)}(e),e)},Na.exports.array=Ia;var ka,Ma,Da=Na.exports;!function(e){let t;!function(e){e.INVALID_HOOK_BEFORE="INVALID_HOOK_BEFORE",e.INVALID_HOOK_AFTER="INVALID_HOOK_AFTER",e.INVALID_HOOK_ARGS_LENGTH="INVALID_HOOK_ARGS_LENGTH"}(t=e.ErrorEnum||(e.ErrorEnum={}));class n extends Error{constructor(e,t,...i){Array.isArray(t)&&(t=t.filter((function(e){return!!e})).join(" ")),super(`${e}: ${t}`),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.code=e,this.contexts={},i.forEach((e=>{"object"==typeof e&&Object.entries(e).forEach((e=>{const[t,n]=e;"key"!==t&&n&&(this.contexts[t]=JSON.parse(JSON.stringify(n)))}))}))}toString(){return`${this.code}: ${this.message}`}}e.HookError=n;const i=(e,t,...i)=>new n(e,t,...i);e.HookBeforeError=()=>i(t.INVALID_HOOK_BEFORE,["hook require a before dependency but not exist in hookmap"]),e.HookAfterError=()=>i(t.INVALID_HOOK_AFTER,["hook require a after dependency but not exist in hookmap"]),e.InvalidHookArguments=e=>i(t.INVALID_HOOK_ARGS_LENGTH,["hook handlers must have 0 to 2 arguments",`but got ${e.handler.length}`])}(ka||(ka={})),function(e){e.normalize=(e=[],t)=>{const n=Array.isArray(e)?e:[e],i=[];return t.forEach((e=>{i.push(e)})),[...i,...n].filter((e=>e&&!!e.handler))},e.sort=(e=[],t)=>{const n=[];e.forEach((e=>{if(e.before){if(!t.has(e.before))throw ka.HookBeforeError();const i=[e,t.get(e.before)];n.push(i)}if(e.after){if(!t.has(e.after))throw ka.HookBeforeError();const i=[t.get(e.after),e];n.push(i)}}));return Da.array(e,n)}}(Ma||(Ma={}));class Ra{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.isResolved=!0,e(t)},this.reject=e=>{this.isRejected=!0,t(e)}}))}}var ja=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Ga{constructor(e){this.scheduleType=Pa.ASYNC_SRRIES,this.hasHook=e=>this.hookMap.has(e),this.getHooks=(e=[],t=!0)=>{const n=Ma.normalize(e,this.hookMap);return t?Ma.sort(n,this.hookMap):n},this.registerHook=e=>(this.hookMap.has(e.name)&&console.error(`${e.name} is duplicated in hookmap`),this.hookMap.set(e.name,e),{dispose:()=>{this.hookMap.delete(e.name)}}),this.call=(e,t=(e=>ja(this,void 0,void 0,(function*(){return e}))),n=[])=>ja(this,void 0,void 0,(function*(){const i=this.getHooks(n,!0);return(0,this.schedulers[this.scheduleType])(e,t,i)})),this.schedulers={[Pa.ASYNC_SRRIES]:(e,t,n=[])=>ja(this,void 0,void 0,(function*(){let i=t;for(const t of n){if([0,1].includes(t.handler.length)){yield t.handler.call(this,e);continue}if([2].includes(t.handler.length)&&null!==i){const n=yield t.handler.call(this,e,i);if(null===n){i=null;break}if("function"==typeof n){i=n;continue}}throw ka.InvalidHookArguments(t)}if(i)return yield i.call(this,e)})),[Pa.ASYNC_PARALLEL]:(e,t,n=[])=>ja(this,void 0,void 0,(function*(){const i=n.map((n=>{if([0,1].includes(n.handler.length))return n.handler.call(this,e);if([2].includes(n.handler.length))return n.handler.call(this,e,t);throw ka.InvalidHookArguments(n)})),o=new Ra;if(Promise.all(i).then((e=>o.resolve(e))),t)return yield t.call(this,o)}))},this.hookMap=new Map,e&&e.type&&(this.scheduleType=e.type)}}const Fa=An.defineToken("IHookService"),Ua=An.defineToken("IHookContribution"),La=()=>({dispose:()=>{}});var Ba;!function(e){e.CONFIG_TYPE="XFlowHook"}(Ba||(Ba={}));class Ha{constructor(){this.CONFIG_TYPE=Ba.CONFIG_TYPE,this.time=Date.now(),this.setRegisterHook=e=>{this.hookRegisterFunc=e},this.setRegisterHookhub=e=>{this.hookhubRegisterFn=e},this.getConfig=()=>gi(this,void 0,void 0,(function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,hookRegisterFn:this.hookRegisterFunc||La,hookhubRegisterFn:this.hookhubRegisterFn||La}})),this.dispose=()=>{}}}let Va=class{constructor(){this.toDispose=new ki,this.hookProvider=()=>this.hooks,this.registerHook=e=>e(this.hooks),this.registerHookHub=(e,t)=>(this.hooks[e]=t,{dispose:()=>{delete this.hooks[e]}}),this.onStart=()=>gi(this,void 0,void 0,(function*(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerHookHub(this);for(const t of e)t.registerHook(this.hooks)})),this.hooks={graphOptions:new Ga,reactNodeRender:new Ga,reactEdgeLabelRender:new Ga,afterGraphInit:new Ga,beforeGraphDestroy:new Ga,x6Events:new Ga}}onStop(){this.toDispose.dispose()}};var Xa;fi([si(Ua),pi("design:type",Object)],Va.prototype,"contributionProvider",void 0),Va=fi([zn({contrib:[va,Fa]}),pi("design:paramtypes",[])],Va),function(e){e.pluginId="GraphEventPlugin"}(Xa||(Xa={}));let za=class{constructor(){this.toDispose=new ki,this.registerHook=t=>gi(this,void 0,void 0,(function*(){const{hookRegisterFn:n}=yield this.hookConfig.getConfig(),i=n(t);return e.Disposable.create((()=>{i.dispose()}))})),this.registerHookHub=t=>gi(this,void 0,void 0,(function*(){const{hookhubRegisterFn:n}=yield this.hookConfig.getConfig(),i=n(t);return e.Disposable.create((()=>{i.dispose()}))}))}};fi([Kn(Ha),pi("design:type",Ha)],za.prototype,"hookConfig",void 0),za=fi([zn({contrib:Ua})],za);const Ka={dispose:()=>null};var Wa;!function(e){e.pluginId="base-graph-events"}(Wa||(Wa={}));let Ya=class{constructor(){this.toDispose=new ki,this.registerHookHub=()=>gi(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>gi(this,void 0,void 0,(function*(){const n=new ki,i=[t.x6Events.registerHook({name:Wa.pluginId,handler:e=>gi(this,void 0,void 0,(function*(){const{events:t}=yield this.graphOptions.getOptions();t.forEach((t=>{e.push(t)}))}))}),t.afterGraphInit.registerHook({name:Wa.pluginId,handler:e=>gi(this,void 0,void 0,(function*(){const{commandService:i,modelService:o,graph:r}=e,s=yield t.x6Events.call([],(e=>gi(this,void 0,void 0,(function*(){return e.map((e=>{const t=t=>{e.callback(t,i,o)};return r.on(e.eventName,t),{dispose:()=>{r.off(e.eventName,t)}}}))}))));n.pushAll(s)}))}),t.afterGraphInit.registerHook({name:"add auto resize event",handler:t=>gi(this,void 0,void 0,(function*(){const{commandService:i}=t,o=function(e){let t;return()=>{t||(t=requestAnimationFrame((()=>{t=null,e()})))}}((()=>{i.executeCommand(e.XFlowGraphCommands.GRAPH_RESIZE.id,{})}));window.addEventListener("resize",o),n.push(e.Disposable.create((()=>{window.removeEventListener("resize",o)})))}))}),t.beforeGraphDestroy.registerHook({name:Wa.pluginId,handler:()=>gi(this,void 0,void 0,(function*(){n.dispose()}))})];return n.pushAll(i),n}))}};fi([Kn(Nr),pi("design:type",Object)],Ya.prototype,"graphOptions",void 0),Ya=fi([zn({contrib:Ua})],Ya);const qa=e=>oi((t=>{ri.register(t,Ua),t(za),t(Ya),t(Va),t(Ha,{useValue:e})}));class $a{constructor(){this.extensions=[],this.containerClassNames=new Set,this.addCoreModule=t=>(this.extensions.unshift(t),e.Disposable.create((()=>{this.removeExtension(t)}))),this.addExtension=t=>(this.extensions.push(t),e.Disposable.create((()=>{this.removeExtension(t)}))),this.removeExtension=e=>{const t=this.extensions.indexOf(e);t>-1&&this.extensions.splice(t,1)},this.getInstaceId=()=>this.instanceId,this.addContainerClassNames=e=>this.containerClassNames.add(e),this.getContainerClassNames=()=>Array.from(this.containerClassNames),this.getAllExtensions=()=>this.extensions,this.getAllExtensionConfigs=()=>this.extensions.map((e=>e.config)),this.instanceId=Hi()}has(e){return this.extensions.some((t=>t.config.CONFIG_TYPE===e))}}const Ja=u.default.createContext({}),Za=()=>u.default.useContext(Ja),Qa=e=>{const t=Za(),n=u.default.useMemo((()=>e.config?e.config:new Ha),[]);return u.default.useEffect((()=>{const e=t.addCoreModule({config:n,createModule:qa});return()=>{e.dispose(),n.dispose()}}),[t,n]),null},ec=u.default.createContext({cell:null,x6Graph:null,commands:null,modelService:null});function tc(e,t,n){return function(i){const o=this,r=null==i?void 0:i.getData(),s=null==i?void 0:i.getSize(),a=null==i?void 0:i.getPosition();return u.default.createElement((()=>u.default.createElement(ec.Provider,{value:{cell:i,x6Graph:o,commands:t,modelService:n}},u.default.createElement(e,{cell:i,data:r,size:s,position:a}))),null)}}const nc=Symbol("IGraphProvider"),ic=Symbol("ICommandServiceProvider"),oc=Symbol("IModelServiceProvider");let rc=class{constructor(){this.toDisposce=new ki,this.graphMap=new Map,this.getGraph=t=>gi(this,void 0,void 0,(function*(){let i=this.graphMap.get(t);if(!i){i=new Mi,this.graphMap.set(t,i);const o=yield this.optionProvider.getOptions(),r=this.hookService.hookProvider(),s=yield r.graphOptions.call(o.x6Options),{graphContainer:a,edgeRender:c,nodeRender:u,edgeTypeParser:d}=o,l=yield r.reactEdgeLabelRender.call(c);yield r.reactNodeRender.call(u);const{clientHeight:h,clientWidth:f}=a,p=yield this.commandServiceProvider.getCommandService(),g=yield this.modelServiceProvider.getModelService(),v=new n.Graph(Object.assign(Object.assign({container:a,width:f,height:h},s),{onEdgeLabelRendered:e=>{const{edge:t,container:n}=e;this.renderEdgeReactLabel({edge:t,container:n,edgeRenderMap:l,edgeTypeParser:d,modelService:g,commandService:p})}}));yield r.afterGraphInit.call({graph:v,commandService:p,modelService:g}),i.resolve(v),v.on("node:moved",(({node:e})=>{const t=e.getData(),n=e.position();e.setData(Object.assign(Object.assign({},t),{x:null==n?void 0:n.x,y:null==n?void 0:n.y}))})),v.on("node:resized",(({node:e})=>{const t=e.getData(),n=e.size();e.setData(Object.assign(Object.assign({},t),{width:null==n?void 0:n.width,height:null==n?void 0:n.height}))})),this.toDisposce.push(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){yield r.beforeGraphDestroy.call({graph:v,commandService:p,modelService:g}),this.graphMap.delete(t),v.dispose()})))))}return i.promise})),this.renderEdgeReactLabel=e=>gi(this,void 0,void 0,(function*(){const{container:t,edgeTypeParser:n,edge:i,edgeRenderMap:o,commandService:r,modelService:s}=e,a=n(null==i?void 0:i.data)||Fi,c=o.get(a);if(c&&i&&(null==i?void 0:i.data)&&c){const e=this.edgeAppendForeignObject(i,t),n=function(e,t,n){return function(i){const o=this,r=null==i?void 0:i.getData();return u.default.createElement((()=>u.default.createElement(ec.Provider,{value:{cell:i,x6Graph:o,commands:t,modelService:n}},u.default.createElement(e,{data:r,cell:i}))),null)}}(c,r,s)(i);l.default.render(n,e)}}))}edgeAppendForeignObject(e,t){const i=n.Dom.createSvgElement("foreignObject"),o=n.Dom.createElementNS("body",n.Dom.ns.xhtml),r=n.Dom.createElementNS("div",n.Dom.ns.xhtml),s=null==e?void 0:e.data,a=(null==s?void 0:s.edgeContentWidth)||100,c=(null==s?void 0:s.edgeContentHeigt)||30;return i.setAttribute("width",`${a}`),i.setAttribute("height",`${c}`),i.setAttribute("x",""+-1*a/2),i.setAttribute("y",""+-1*c/2),o.setAttribute("xhtmls",n.Dom.ns.xhtml),o.style.width="100%",o.style.height="100%",o.style.padding="0",o.style.margin="0",o.style.background="unset",o.style.overflow="visible",o.className="xflow-edge-label-body",r.style.width="100%",r.style.height="100%",o.appendChild(r),i.appendChild(o),t.appendChild(i),r}dispose(){this.toDisposce.dispose()}};fi([Kn(Nr),pi("design:type",Object)],rc.prototype,"optionProvider",void 0),fi([Kn(Fa),pi("design:type",Object)],rc.prototype,"hookService",void 0),fi([Kn(ic),pi("design:type",Object)],rc.prototype,"commandServiceProvider",void 0),fi([Kn(oc),pi("design:type",Object)],rc.prototype,"modelServiceProvider",void 0),rc=fi([zn()],rc);var sc;!function(e){e.CONFIG_TYPE="MODEL_SERVICE_CONFIG"}(sc||(sc={}));const ac=()=>e.Disposable.create((()=>{}));class cc{constructor(){this.CONFIG_TYPE=sc.CONFIG_TYPE,this.registerModelFn=ac,this.isMounted=new Mi,this.registerModel=e=>{this.registerModelFn=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>gi(this,void 0,void 0,(function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,modelRegisterFunc:this.registerModelFn||ac}})),this.dispose=()=>{this.registerModelFn=ac,this.isMounted=new Mi}}}let uc=class{constructor(){this.toDispose=new ki,this.deferredModelMap=new Map,this.registerModel=t=>{const{id:n,getInitialValue:i,modelFactory:o}=t,r=new ki,s=this.ensureModel(n);if(s.isResolved)return void console.error(t,"model has been registerd");const a=i?i():e.NsModel.EMPTY_VALUE,c=o?o():new ga(a);return e.NsModel.isValidValue(a)&&s.resolve(c),t.watchChange&&t.watchChange(c,this).then((e=>{s.isResolved||s.resolve(c),this.toDispose.pushAll([e,r]),r.push(e)})),r},this.findDeferredModel=e=>this.deferredModelMap.get(e),this.awaitModel=e=>this.ensureModel(e).promise,this.registerRuntimeModel=()=>gi(this,void 0,void 0,(function*(){const{modelRegisterFunc:e}=yield this.modelOptionProvider.getOption(),t=yield this.graphProvider.getGraphInstance();e&&e(this,t)})),this.ensureModel=t=>{const n=this.deferredModelMap.get(t);if(n)return n;const i=new Mi;return this.deferredModelMap.set(t,i),this.toDispose.push(e.Disposable.create((()=>this.deferredModelMap.delete(t)))),i}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerModel(this);this.registerRuntimeModel()}onStop(){this.toDispose.dispose()}};fi([si(Sa),pi("design:type",Object)],uc.prototype,"contributionProvider",void 0),fi([Kn(Ta),pi("design:type",Object)],uc.prototype,"modelOptionProvider",void 0),fi([Kn(nc),pi("design:type",Object)],uc.prototype,"graphProvider",void 0),uc=fi([zn({contrib:[va,Aa]})],uc);const dc=e=>t=>gi(void 0,void 0,void 0,(function*(){return yield t.awaitModel(e)})),lc=e=>t=>gi(void 0,void 0,void 0,(function*(){return(yield t.awaitModel(e)).getValidValue()}));var hc,fc,pc,gc,vc,yc,mc,bc,_c,Ec,Cc,wc,Oc,xc,Ac,Sc,Tc,Pc,Nc,Ic;!function(e){e.id="GRAPH_ENABLE_MULTI_SELECT",e.getModel=dc(e.id),e.useValue=lc(e.id)}(hc||(hc={})),function(e){e.id="IS_NODE_SELECTED",e.getModel=dc(e.id),e.useValue=lc(e.id)}(fc||(fc={})),function(e){e.id="IS_GROUP_SELECTED",e.getModel=dc(e.id),e.useValue=lc(e.id)}(pc||(pc={})),function(e){e.id="IS_NORMAL_NODES_SELECTED",e.getModel=dc(e.id),e.useValue=lc(e.id)}(gc||(gc={})),function(e){e.id="LAST_SELECTED_CELL",e.getModel=dc(e.id),e.useValue=lc(e.id)}(vc||(vc={})),function(e){e.id="SELECTED_CELLS",e.getModel=dc(e.id),e.useValue=lc(e.id)}(yc||(yc={})),function(e){e.id="LAST_SELECTED_NODE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(mc||(mc={})),function(e){e.id="SELECTED_NODES",e.getModel=dc(e.id),e.useValue=lc(e.id)}(bc||(bc={})),function(e){e.id="SELECTED_EDGES",e.getModel=dc(e.id),e.useValue=lc(e.id)}(_c||(_c={})),function(e){e.id="SELECTED_GROUPS",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Ec||(Ec={})),function(e){e.id="CONTEXTMENU_NODE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Cc||(Cc={})),function(e){e.id="CONTEXTMENU_EDGE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(wc||(wc={})),function(e){e.id="CONTEXTMENU_TARGET",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Oc||(Oc={})),function(e){e.id="GRAPH_META",e.getModel=dc(e.id),e.useValue=lc(e.id)}(xc||(xc={})),function(e){e.id="GRAPH_SCALE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Ac||(Ac={})),function(e){e.id="COMMAND_REDOABLE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Sc||(Sc={})),function(e){e.id="COMMAND_UNDOABLE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Tc||(Tc={})),function(e){e.id="COMMAND_GLOBALS",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Pc||(Pc={})),function(e){e.id="HISTORY_UNDOABLE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Nc||(Nc={})),function(e){e.id="HISTORY_REDOABLE",e.getModel=dc(e.id),e.useValue=lc(e.id)}(Ic||(Ic={}));var kc=Object.freeze({__proto__:null,isModelExistUtil:e=>t=>{const n=t.findDeferredModel(e);return!(!n||!n.promise)},getModelUtil:dc,useModelValueUtil:lc,get GRAPH_ENABLE_MULTI_SELECT(){return hc},get IS_NODE_SELECTED(){return fc},get IS_GROUP_SELECTED(){return pc},get IS_NORMAL_NODES_SELECTED(){return gc},get SELECTED_CELL(){return vc},get SELECTED_CELLS(){return yc},get SELECTED_NODE(){return mc},get SELECTED_NODES(){return bc},get SELECTED_EDGES(){return _c},get SELECTED_GROUPS(){return Ec},get CONTEXTMENU_NODE(){return Cc},get CONTEXTMENU_EDGE(){return wc},get CONTEXTMENU_TARGET(){return Oc},get GRAPH_META(){return xc},get GRAPH_SCALE(){return Ac},get COMMAND_REDOABLE(){return Sc},get COMMAND_UNDOABLE(){return Tc},get COMMAND_GLOBALS(){return Pc},get HISTORY_UNDOABLE(){return Nc},get HISTORY_REDOABLE(){return Ic}});let Mc=class{registerModel(e){e.registerModel({id:Sc.id,getInitialValue:()=>this.commands.isRedoable,watchChange:e=>gi(this,void 0,void 0,(function*(){return this.commands.watchChange((()=>{e.setValue(this.commands.isRedoable)}))}))}),e.registerModel({id:Tc.id,getInitialValue:()=>this.commands.isUndoable,watchChange:e=>gi(this,void 0,void 0,(function*(){return this.commands.watchChange((()=>{e.setValue(this.commands.isUndoable)}))}))}),e.registerModel({id:Pc.id,modelFactory:()=>this.commands.Globals})}};fi([Kn(ya),pi("design:type",Object)],Mc.prototype,"commands",void 0),Mc=fi([zn({contrib:Sa})],Mc);const Dc=(t,n,i)=>(t.on(n,i),e.Disposable.create((()=>{t.off(n,i)})));let Rc=class{constructor(){this.getGraphInstance=()=>gi(this,void 0,void 0,(function*(){return{graph:yield this.graphProvider.getGraphInstance(),config:yield this.graphProvider.getGraphOptions()}}))}registerModel(t){t.registerModel({id:xc.id,getInitialValue:()=>({flowId:"-1"}),watchChange:t=>gi(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{t.setValue({flowId:"-1"})}))}))}),t.registerModel({id:hc.id,getInitialValue:()=>({isEnable:!1}),watchChange:t=>gi(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{t.setValue({isEnable:!1})}))}))}),t.registerModel({id:yc.id,getInitialValue:()=>[],watchChange:t=>gi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=e=>{const{selected:n}=e;t.setValue(n)};return n.on("selection:changed",i),e.Disposable.create((()=>n.off("selection:changed",i)))}))}),t.registerModel({id:vc.id,watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield yc.getModel(t)).watch(((t=[])=>{e.setValue([...t].pop()||null)}))}))}),t.registerModel({id:bc.id,getInitialValue:()=>[],watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield yc.getModel(t)).watch(((t=[])=>{const n=t.filter((e=>e.isNode()));e.setValue(n)}))}))}),t.registerModel({id:mc.id,watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield bc.getModel(t)).watch((t=>{e.setValue([...t].pop()||null)}))}))}),t.registerModel({id:fc.id,watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield bc.getModel(t)).watch((t=>{e.setValue(t.length>0)}))}))}),t.registerModel({id:pc.id,getInitialValue:()=>!1,watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield yc.getModel(t)).watch((t=>{const n=t.every((e=>e&&!0===e.getProp("isGroup")));e.setValue(n)}))}))}),t.registerModel({id:Ec.id,getInitialValue:()=>[],watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield bc.getModel(t)).watch((t=>{const n=t.filter((e=>e&&!0===e.getProp("isGroup")));e.setValue(n)}))}))}),t.registerModel({id:gc.id,getInitialValue:()=>!1,watchChange:(e,t)=>gi(this,void 0,void 0,(function*(){return(yield yc.getModel(t)).watch((t=>{const n=t.every((e=>{const t=!(e&&e.getProp("isGroup")),n=!(e&&e.getProp("group"));return t&&n})),i=t.length>0&&n;e.setValue(i)}))}))}),t.registerModel({id:Ac.id,getInitialValue:()=>({zoomFactor:-1}),watchChange:t=>gi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=e=>{const i=n.zoom();t.setValue(Object.assign(Object.assign({},e),{zoomFactor:i}))};return n.on("scale",i),e.Disposable.create((()=>n.off("scale",i)))}))}),t.registerModel({id:Oc.id,watchChange:e=>gi(this,void 0,void 0,(function*(){const{graph:t,config:n}=yield this.getGraphInstance(),i=i=>o=>{const{x:r,y:s}=o,a=t.localToClient({x:r,y:s}),c=n.rootContainer.getBoundingClientRect(),u={x:a.x-((null==c?void 0:c.x)||0),y:a.y-((null==c?void 0:c.y)||0)};e.setValue({type:i,anchor:u,data:o,cell:o.cell})},o=new ki;return o.pushAll([Dc(t,"node:contextmenu",i("node")),Dc(t,"edge:contextmenu",i("edge")),Dc(t,"blank:contextmenu",i("blank"))]),o}))}),t.registerModel({id:Ic.id,getInitialValue:()=>!1,watchChange:t=>gi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=()=>{const e=n.history.canRedo();t.setValue(e)};return n.history&&n.history.on("change",i),e.Disposable.create((()=>n.history.off("change",i)))}))}),t.registerModel({id:Nc.id,getInitialValue:()=>!1,watchChange:t=>gi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=()=>{const e=n.history.canUndo();t.setValue(e)};return n.history&&n.history.on("change",i),e.Disposable.create((()=>n.history.off("change",i)))}))})}};fi([Kn(nc),pi("design:type",Object)],Rc.prototype,"graphProvider",void 0),Rc=fi([zn({contrib:Sa})],Rc);const jc=oi((e=>{ri.register(e,Sa),e(uc),e(Rc),e(Mc)})),Gc=e=>oi((t=>{((e,t)=>{e({token:Ta,useDynamic:()=>({getOption:()=>gi(void 0,void 0,void 0,(function*(){return t.getConfig()}))}),lifecycle:An.Lifecycle.singleton})})(t,e)})),Fc=e=>{const{config:t}=e,n=Za(),i=u.default.useMemo((()=>t||new cc),[]);return u.default.useEffect((()=>{const e=n.addCoreModule({config:i,createModule:Gc});return i.setMountState(),()=>{e.dispose(),i.dispose()}}),[]),null};Fc.defaultProps={XFlowModuleType:"ModelServiceConfig"};const Uc=e=>{const t=[],n=[],i=e=>{e.isNode()&&t.push((e=>{const t=e.getChildren(),n=e.getSize(),i=e.getData()||{},o=e.getPosition(),r=e.getParentId(),{isCollapsed:s}=i,a=i.groupCollapsedSize||(s?n:null);return Object.assign(Object.assign({},i),{id:e.id,width:n.width,height:n.height,x:o.x,y:o.y,group:r,groupChildren:t?t.map((e=>e.id)):null,groupCollapsedSize:a})})(e)),e.isEdge()&&n.push((e=>{const t=e.getData()||{};return Object.assign({id:e.id},t)})(e))};return e.map((e=>i(e))),{nodes:t,edges:n}};e.IApplication=class{constructor(){this.getGraphData=()=>gi(this,void 0,void 0,(function*(){const e=(yield this.graphProvider.getGraphInstance()).getCells();return Uc(e)}))}start(){return gi(this,void 0,void 0,(function*(){yield this.startContributions(),this.registerEventListeners()}))}getGraphInstance(){return this.graphProvider.getGraphInstance()}getGraphConfig(){return this.graphProvider.getGraphOptions()}getAllNodes(){return gi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getNodes()}))}getNodeById(e){return gi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}))}getAllEdges(){return gi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getEdges()}))}getEdgeById(e){return gi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}))}updateNodeAttrs(e,t){return gi(this,void 0,void 0,(function*(){if(e instanceof n.Node)e.setAttrs(t);else{(yield this.getNodeById(e)).setAttrs(t)}}))}updateEdgeAttrs(e,t){return gi(this,void 0,void 0,(function*(){if(e instanceof n.Edge)e.setAttrs(t);else{(yield this.getEdgeById(e)).setAttrs(t)}}))}translateGraph(e,t){return gi(this,void 0,void 0,(function*(){const n=yield this.graphProvider.getGraphInstance(),i=n.translate();n.translate(i.tx+e,i.ty+t)}))}executeCommand(e,t,n=[]){return this.commandService.executeCommand(e,t,n)}executeCommandPipeline(e){return this.commandService.executeCommandPipeline(e)}registerEventListeners(){window.addEventListener("unload",(()=>{this.stopContributions()}))}startContributions(){return gi(this,void 0,void 0,(function*(){console.log(this.contributions.getContributions());for(const e of this.contributions.getContributions())if(e.onStart)try{yield this.measure(`${e.constructor.name}.onStart`,(()=>e.onStart(this)))}catch(e){console.error("Could not start contribution",e)}}))}stopContributions(){console.info(">>> Stopping frontend contributions...");for(const e of this.contributions.getContributions())if(e.onStop)try{e.onStop(this)}catch(e){console.error("Could not stop contribution",e)}console.info("<<< All frontend contributions have been stopped.")}measure(e,t){return gi(this,void 0,void 0,(function*(){const n=`${e}-start`,i=`${e}-end`;performance.mark(n);const o=yield t();performance.mark(i),performance.measure(e,n,i);for(const t of performance.getEntriesByName(e)){const e=`Frontend ${t.name}`;t.duration>100?console.warn(`${e} is slow, took: ${t.duration.toFixed(1)} ms`):console.debug(`${e} took: ${t.duration.toFixed(1)} ms`)}return performance.clearMeasures(e),o}))}},fi([si(va),pi("design:type",Object)],e.IApplication.prototype,"contributions",void 0),fi([Kn(nc),pi("design:type",Object)],e.IApplication.prototype,"graphProvider",void 0),fi([Kn(ya),pi("design:type",Object)],e.IApplication.prototype,"commandService",void 0),fi([Kn(Aa),pi("design:type",Object)],e.IApplication.prototype,"modelService",void 0),e.IApplication=fi([zn()],e.IApplication);const Lc=oi((t=>{ri.register(t,va),t(e.IApplication)})),Bc=u.default.createContext({configProvider:null}),Hc=e=>{const t=u.default.useContext(Bc);return u.default.useMemo((()=>t.configProvider?t.configProvider.getXflowPrefixCls(e):`xflow-${e}`),[e])};const Vc=(e={})=>t.useMemo((()=>{const t=Object.entries(e),n=t.length>0?{position:"absolute"}:{};return t.forEach((([e,t=0])=>{n[e]=`${t}px`})),n}),[e]),Xc=e=>oi((t=>{(e=>{e(rc),e(nc,{lifecycle:An.Lifecycle.singleton,useDynamic:e=>({getGraphInstance:()=>gi(void 0,void 0,void 0,(function*(){const t=e.container.get(rc),n=e.container.get(Nr),i=yield null==n?void 0:n.getOptions();return yield null==t?void 0:t.getGraph(i.graphId)})),getGraphOptions:()=>gi(void 0,void 0,void 0,(function*(){const t=e.container.get(Nr);return null==t?void 0:t.getOptions()}))})}),e(ic,{lifecycle:An.Lifecycle.singleton,useDynamic:e=>({getCommandService:()=>gi(void 0,void 0,void 0,(function*(){return e.container.get(ya)}))})}),e(oc,{lifecycle:An.Lifecycle.singleton,useDynamic:e=>({getModelService:()=>gi(void 0,void 0,void 0,(function*(){return e.container.get(Aa)}))})})})(t),((e,t)=>{e(Nr,{lifecycle:An.Lifecycle.singleton,useDynamic:()=>({getOptions:()=>gi(void 0,void 0,void 0,(function*(){return t.getConfig()}))})})})(t,e)})),zc=e=>{const t=br(),n=u.default.useRef(null),i=u.default.useRef(null),r=Za(),s=u.default.useMemo((()=>{const t=e.config?e.config:new Pr;return t.setX6Config(),t}),[]),[a,c]=o.usePortal(s.graphId);u.default.useEffect((()=>{t&&t.getGraphInstance().then((e=>{c(e)}))}),[t,c]),u.default.useEffect((()=>{s.setRootContainer(n.current),s.setGraphContainer(i.current),s.xflowInstanceId=r.getInstaceId(),r.addCoreModule({config:s,createModule:Xc});return()=>{gi(void 0,void 0,void 0,(function*(){s.dispose()}))}}),[]);const d=Vc(e.position),l=Hc("canvas-root"),h=Hc("x6-canvas");return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{ref:n,className:l,style:d,id:s.graphId,tabIndex:0},u.default.createElement("div",{ref:i,className:h}),e.children),u.default.createElement(a,null))};zc.defaultProps={isXFlowCanvas:!0};let Kc=class{constructor(){this.toDispose=new ki,this.runtimeHooks=[],this.getX6Graph=()=>gi(this,void 0,void 0,(function*(){if(this.graph)return this.graph;const e=yield this.graphProvider.getGraphInstance();return this.graph=e,e})),this.getGraphConfig=()=>gi(this,void 0,void 0,(function*(){return this.graphProvider.getGraphOptions()})),this.getGraphMeta=()=>gi(this,void 0,void 0,(function*(){const e=this.getModelService();return this.graphMeta||(yield xc.useValue(e))})),this.setArgs=(e,t=[])=>(this.args=e,this.runtimeHooks=t,{args:e,hooks:t}),this.getArgs=()=>({args:Object.assign(Object.assign({},this.args),{modelService:this.getModelService(),commandService:this.getCommands(),getGraphMeta:this.getGraphMeta,getX6Graph:this.getX6Graph,getGraphConfig:this.getGraphConfig}),hooks:this.runtimeHooks}),this.setResult=e=>(this.result=e,this.result),this.getResult=()=>this.result,this.getHooks=()=>this.hookService.hookProvider(),this.getCommands=()=>this.commandService,this.getModelService=()=>this.modelService,this.addUndo=e=>{if(!Array.isArray(e))return this.addUndo([e]);this.toDispose.pushAll(e)},this.undo=()=>gi(this,void 0,void 0,(function*(){yield this.toDispose.dispose()})),this.isUndoable=()=>!this.toDispose.disposed,this.getDisposables=()=>this.toDispose,this.setGlobal=(e,t)=>{this.commandService.setGlobal(e,t)},this.getGlobal=e=>this.commandService.getGlobal(e)}init(){this.getGraphMeta().then((e=>{this.graphMeta=e}))}};fi([Kn(nc),pi("design:type",Object)],Kc.prototype,"graphProvider",void 0),fi([Kn(Fa),pi("design:type",Object)],Kc.prototype,"hookService",void 0),fi([Kn(ya),pi("design:type",Object)],Kc.prototype,"commandService",void 0),fi([Kn(Aa),pi("design:type",Object)],Kc.prototype,"modelService",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Kc.prototype,"init",null),Kc=fi([Xn()],Kc);const Wc=()=>[];class Yc{constructor(){this.setCommandContributions=e=>{this.getContributions=e},this.getCommandContributions=()=>this.getContributions(),this.registerHook=e=>gi(this,void 0,void 0,(function*(){return this.registerHookFn?this.registerHookFn(e):Ka})),this.registerHookHub=e=>gi(this,void 0,void 0,(function*(){return this.registerHookHubFn?this.registerHookHubFn(e):Ka})),this.CONFIG_TYPE="CommandConfig",this.setRegisterHookFn=e=>{this.registerHookFn=e},this.setRegisterHookHubFn=e=>{this.registerHookHubFn=e},this.getConfig=()=>gi(this,void 0,void 0,(function*(){return{registerHookFn:this.registerHookFn,getContributions:this.getContributions,CONFIG_TYPE:this.CONFIG_TYPE}})),this.getContributions=Wc}}var qc;!function(t){t.command=e.XFlowNodeCommands.ADD_NODE,t.hookKey="addNode"}(qc||(qc={}));let $c=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.addNode.call(n,(n=>gi(this,void 0,void 0,(function*(){const{createNodeService:i,cellFactory:o,commandService:r,options:s}=n,a=yield t.getX6Graph();let c=n.nodeConfig;if(i){const e=yield i(n);if("boolean"==typeof e)return{err:"createNodeService rejected"};c=e}const u=yield this.processNodeConfig(c);let d;if(o){const e=yield o(u,this);d=a.addNode(e,s)}else d=a.addNode(u,s);return t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){const t=Object.assign({id:d.id},d.getData());r.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:t})}))))),{nodeConfig:u,nodeCell:d}}))),i);return t.setResult(r),this})),this.processNodeConfig=e=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider();if(e.data=Object.assign({},e),e.shape)return e;if(!e.view){const n=yield t.getGraphConfig();e.view=n.graphId}if(!e.component){const n=yield this.getNodeReactComponent(e),i=t.getCommands(),o=t.getModelService();e.shape="react-shape",e.component=tc(n,i,o)}return e})),this.getNodeReactComponent=e=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),n=t.getHooks(),i=yield t.getGraphConfig(),o=yield n.reactNodeRender.call(i.nodeRender),r=i.nodeTypeParser(e)||ji,s=o.get(r);return s||console.error("react node component is missing:",i.nodeRender,r,s),s})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Jc;fi([Kn(ba),pi("design:type",Object)],$c.prototype,"contextProvider",void 0),$c=fi([Xn({token:{token:ma,named:qc.command.id}})],$c),function(t){t.command=e.XFlowNodeCommands.DEL_NODE,t.hookKey="delNode",t.createHook=()=>new Ga}(Jc||(Jc={}));let Zc=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.delNode.call(n,(n=>gi(this,void 0,void 0,(function*(){const{commandService:i,deleteNodeService:o,options:r}=n,s=yield t.getX6Graph();if(o){if(!(yield o(n)))return{err:" service rejected"}}const a=(n.x6Node||n.nodeConfig).id,c=s.getCellById(a);if(c&&c.isNode()){const n=[...s.getIncomingEdges(c)||[],...s.getOutgoingEdges(c)||[]];yield Promise.all(n.map((t=>i.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{x6Edge:t}))));const o=c.getData();return c.remove(r),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){yield i.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:o})}))))),{err:null,nodeConfig:o}}return{err:"node is not exist"}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){if(this.isUndoable()){this.contextProvider().undo()}return this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Qc;fi([Kn(ba),pi("design:type",Object)],Zc.prototype,"contextProvider",void 0),Zc=fi([Xn({token:{token:ma,named:Jc.command.id}})],Zc),function(t){t.command=e.XFlowNodeCommands.SELECT_NODE,t.hookKey="selectNode"}(Qc||(Qc={}));let eu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.selectNode.call(t,(t=>gi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),i=n.getSelectedCells().map((e=>e.id)),{nodeIds:o,resetSelection:r,commandService:s}=t;return r?n.resetSelection(o):n.select(o),this.ctx.addUndo({dispose:()=>{s.executeUndoCommand(e.XFlowNodeCommands.SELECT_NODE.id,{nodeIds:i,resetSelection:!0})}}),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var tu;fi([Kn(ba),pi("design:type",Object)],eu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],eu.prototype,"init",null),eu=fi([Xn({token:{token:ma,named:Qc.command.id}})],eu),function(t){t.command=e.XFlowNodeCommands.MOVE_NODE,t.hookKey="moveNode",t.createHook=()=>new Ga}(tu||(tu={}));let nu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.moveNode.call(n,(n=>gi(this,void 0,void 0,(function*(){const{nodePositionService:i}=n;if(i){if(!(yield i(n)))return{err:"service rejected"}}const{dx:o=0,dy:r=0,x:s,y:a,duration:c=150}=n.position,u=(yield t.getX6Graph()).getCellById(n.id);if(u){let n=s,i=a;const{x:d,y:l}=u.position();let h=()=>{u.position(d,l,{silent:!1})};return o||r?(n=o+d,i=r+l,u.translate(o,r,{transition:{duration:c}}),h=()=>u.translate(-o,-r,{transition:{duration:c}})):u.position(n,i,{silent:!1}),t.addUndo(e.Disposable.create((()=>{h()}))),{err:null,nextX:n,nextY:i}}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var iu;fi([Kn(ba),pi("design:type",Object)],nu.prototype,"contextProvider",void 0),nu=fi([Xn({token:{token:ma,named:tu.command.id}})],nu),function(t){t.command=e.XFlowNodeCommands.UPDATE_NODE,t.hookKey="updateNode",t.XFlowNodeSetOptions={overwrite:!0},t.NODE_WIDTH=200,t.NODE_HEIGHT=40}(iu||(iu={}));let ou=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.updateNode.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{nodeConfig:n,options:i=iu.XFlowNodeSetOptions}=e,r=null==t?void 0:t.getCellById(null==n?void 0:n.id);return r.setData(n,i),r.setPosition((null==n?void 0:n.x)||0,(null==n?void 0:n.y)||0),r.setSize((null==n?void 0:n.width)||iu.NODE_WIDTH,(null==n?void 0:n.height)||iu.NODE_HEIGHT),r instanceof o.ReactShape||!r.getAttrByPath("text/text")||r.setAttrByPath("text/text",n.label),n.attrs&&r.setAttrs(n.attrs),{nodeConfig:n,nodeCell:r}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var ru;fi([Kn(ba),pi("design:type",Object)],ou.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],ou.prototype,"init",null),ou=fi([Xn({token:{token:ma,named:iu.command.id}})],ou),function(t){t.command=e.XFlowNodeCommands.CENTER_NODE,t.hookKey="centerNode"}(ru||(ru={}));let su=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.centerNode.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{nodeConfig:n}=e,i=null==t?void 0:t.getCellById(null==n?void 0:n.id);return null==t||t.centerCell(i),{x6Node:i}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var au;fi([Kn(ba),pi("design:type",Object)],su.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],su.prototype,"init",null),su=fi([Xn({token:{token:ma,named:ru.command.id}})],su),function(t){t.command=e.XFlowNodeCommands.FRONT_NODE,t.hookKey="frontNode"}(au||(au={}));let cu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.frontNode.call(n,(n=>gi(this,void 0,void 0,(function*(){const i=yield this.ctx.getX6Graph(),{nodeId:o}=n,r=null==i?void 0:i.getCellById(o);return r?(r.toFront(),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){n.commandService.executeCommand(e.XFlowNodeCommands.BACK_NODE.id,{nodeId:o})})))))):console.error(o,"this nodeId is not exist"),{}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var uu;fi([Kn(ba),pi("design:type",Object)],cu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],cu.prototype,"init",null),cu=fi([Xn({token:{token:ma,named:au.command.id}})],cu),function(t){t.command=e.XFlowNodeCommands.BACK_NODE,t.hookKey="backNode"}(uu||(uu={}));let du=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.backNode.call(t,(t=>gi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{nodeId:i}=t,o=null==n?void 0:n.getCellById(i);return o?(o.toBack(),this.ctx.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowNodeCommands.FRONT_NODE.id,{nodeId:i})})))))):console.error(i,"this nodeId is not exist"),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var lu;fi([Kn(ba),pi("design:type",Object)],du.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],du.prototype,"init",null),du=fi([Xn({token:{token:ma,named:uu.command.id}})],du),function(t){t.command=e.XFlowNodeCommands.HIGHLIGHT_NODE,t.hookKey="highlightNode"}(lu||(lu={}));let hu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.highlightNode.call(t,(t=>gi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{nodeId:i,stroke:o,strokeWidth:r}=t,s=null==n?void 0:n.getCellById(i);if(!s)return console.error(i,"this nodeId is not exist"),{err:"this nodeId is not exist"};if(null==s||s.setAttrs({body:{stroke:o||"#7c68fc",strokeWidth:r||2}}),null==t?void 0:t.isHighlightRelatedLines){const{edgeStroke:i,edgeStrokeWidth:o}=t;(null==n?void 0:n.getEdges()).forEach((n=>{const r=null==n?void 0:n.getData();null==t||t.commandService.executeCommand(e.XFlowEdgeCommands.HIGHLIGHT_EDGE.id,{edgeId:null==r?void 0:r.id,strokeColor:i,strokeWidth:o})}))}return{err:null}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};fi([Kn(ba),pi("design:type",Object)],hu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],hu.prototype,"init",null),hu=fi([Xn({token:{token:ma,named:lu.command.id}})],hu);const fu=[qc,Jc,Qc,tu,iu,ru,au,uu,lu];var pu;!function(t){t.command=e.XFlowGraphCommands.LOAD_META,t.hookKey="graphMeta"}(pu||(pu={}));let gu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphMeta.call(e,(e=>gi(this,void 0,void 0,(function*(){var t;const{graphMetaService:n}=e,i=n?yield n(e):{flowId:null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.flowId};return Object.assign({flowId:null==i?void 0:i.flowId},i)}))),t),o=this.ctx.getModelService();return(yield xc.getModel(o)).setValue(i),this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var vu;fi([Kn(ba),pi("design:type",Object)],gu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],gu.prototype,"init",null),gu=fi([Xn({token:{token:ma,named:pu.command.id}})],gu),function(t){t.command=e.XFlowGraphCommands.SAVE_GRAPH_DATA,t.hookKey="saveGrpahData"}(vu||(vu={}));let yu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const e=this.ctx,t=e.getArgs(),n=e.getHooks();return yield n.saveGrpahData.call(t.args,(t=>gi(this,void 0,void 0,(function*(){const{saveGraphDataService:n,includeAttrs:i}=t,o=yield e.getX6Graph(),r=o.getNodes(),s=o.getEdges(),a={nodes:r.map((e=>{const t=e.getData(),n=e.position(),o=e.size(),r=Object.assign(Object.assign(Object.assign({id:e.id},t),n),o);return i&&(r.attrs=e.getAttrs()),r})),edges:s.map((e=>{const t=e.getData(),n=Object.assign({id:e.id},t);return i&&(n.attrs=e.getAttrs()),n}))},c=yield this.ctx.getGraphMeta();if(n){const e=yield n(c,a);e&&this.ctx.setResult(e)}return{}}))),t.hooks),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var mu;fi([Kn(ba),pi("design:type",Object)],yu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],yu.prototype,"init",null),yu=fi([Xn({token:{token:ma,named:vu.command.id}})],yu),function(t){t.command=e.XFlowGraphCommands.LOAD_DATA,t.hookKey="loadData",t.createHook=()=>new Ga}(mu||(mu={}));let bu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.loadData.call(e,(e=>gi(this,void 0,void 0,(function*(){const{loadDataService:t}=e,n=yield this.ctx.getGraphMeta();return{graphData:yield t(n)}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var _u;fi([Kn(ba),pi("design:type",Object)],bu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],bu.prototype,"init",null),bu=fi([Xn({token:{token:ma,named:mu.command.id}})],bu),function(t){t.command=e.XFlowGraphCommands.GRAPH_LAYOUT,t.hookKey="graphLayout"}(_u||(_u={}));let Eu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphLayout.call(e,(e=>gi(this,void 0,void 0,(function*(){const{layoutType:t,layoutOptions:n,customLayout:i}=e,o=i||(e=>new(0,h.Layouts[t])(Object.assign({},n)).layout(e));return yield o(e.graphData),{graphData:e.graphData}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Cu,wu;fi([Kn(ba),pi("design:type",Object)],Eu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Eu.prototype,"init",null),Eu=fi([Xn({token:{token:ma,named:_u.command.id}})],Eu),function(e){e.isNodeEqual=function(e,t){return s.isEqual(e,t)},e.isEdgeEqual=function(e,t){return s.isEqual(e,t)}}(Cu||(Cu={})),function(t){t.command=e.XFlowGraphCommands.GRAPH_RENDER,t.hookKey="graphRender"}(wu||(wu={}));let Ou=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphRender.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),n=yield this.ctx.getGraphMeta(),{beforeRender:i,graphData:o,isNodeEqual:r,isEdgeEqual:s,afterRender:a}=e;return i&&i(n),yield this.doLoadGraph(t,o,r,s),a&&a(o,n),{}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this})),this.doLoadGraph=(t,n,i,o)=>gi(this,void 0,void 0,(function*(){(null==t?void 0:t.isFrozen())||null==t||t.freeze();const r=this.ctx.getCommands(),{addNodeConfigs:s,addEdgeConfigs:a,removeNodes:c,removeEdges:u,updateNodes:d,updateEdges:l}=this.graphDataDiff(t,n,i,o);for(const t of s)yield r.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:t},{name:"remove servcie",handler:e=>gi(this,void 0,void 0,(function*(){delete e.createNodeService}))});yield r.executeCommand(e.XFlowGroupCommands.INIT_GROUP.id,{graphData:{nodes:s,edges:[]}});for(const t of a)yield r.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:t},{name:"remove servcie",handler:e=>gi(this,void 0,void 0,(function*(){delete e.createEdgeService}))});for(const t of c){const n=null==t?void 0:t.getData();n.isGroup?yield r.executeCommand(e.XFlowGroupCommands.DEL_GROUP.id,{nodeConfig:n}):yield r.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:n})}for(const t of u){const n=null==t?void 0:t.getData();yield r.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{edgeConfig:n})}for(const t of d){const n=null==t?void 0:t.getData();yield r.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:n})}for(const t of l){const n=null==t?void 0:t.getData();yield r.executeCommand(e.XFlowEdgeCommands.UPDATE_EDGE.id,{edgeConfig:n})}(null==t?void 0:t.isFrozen())&&(null==t||t.unfreeze())}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}graphDataDiff(e,t,n,i){const{nodes:o,edges:r}=t,s=[];o.forEach((t=>{e.getCellById(null==t?void 0:t.id)||s.push(t)}));const a=[],c=[],u=[];e.getNodes().forEach((e=>{const t=o.find((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)));if(t){let i=!0;n?i=n(null==e?void 0:e.data,t):(null==e?void 0:e.data)&&t&&(i=Cu.isNodeEqual(null==e?void 0:e.data,t)),i||e.setData(t),!0===i?a.push(e):c.push(e)}else u.push(e)}));const d=[];r.forEach((t=>{e.getCellById(null==t?void 0:t.id)||d.push(t)}));const l=[],h=[],f=[];return e.getEdges().forEach((e=>{const t=r.find((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)));if(t){let n=!0;i?n=i(null==e?void 0:e.data,t):(null==e?void 0:e.data)&&t&&(n=Cu.isEdgeEqual(null==e?void 0:e.data,t)),n||e.setData(t),!0===n?l.push(e):h.push(e)}else f.push(e)})),{addNodeConfigs:s,addEdgeConfigs:d,retainNodes:a,retainEdges:l,removeNodes:u,removeEdges:f,updateNodes:c,updateEdges:h}}};var xu;fi([Kn(ba),pi("design:type",Object)],Ou.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Ou.prototype,"init",null),Ou=fi([Xn({token:{token:ma,named:wu.command.id}})],Ou),function(t){t.command=e.XFlowGraphCommands.GRAPH_RESIZE,t.hookKey="graphResize"}(xu||(xu={}));let Au=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield this.ctx.getGraphConfig(),o=i.rootContainer.clientHeight,r=i.rootContainer.clientWidth,s=yield n.graphResize.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{width:n=r,height:i=o}=e;return null==t||t.resize(n,i),{}}))),t);return this.ctx.setResult(s),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Su;fi([Kn(ba),pi("design:type",Object)],Au.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Au.prototype,"init",null),Au=fi([Xn({token:{token:ma,named:xu.command.id}})],Au),function(t){t.command=e.XFlowGraphCommands.GRAPH_ZOOM,t.MAX_SCALE=1.5,t.MIN_SCALE=.05,t.defaultZoomOptions={maxScale:t.MAX_SCALE,minScale:t.MIN_SCALE},t.hookKey="graphZoom"}(Su||(Su={}));let Tu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphZoom.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{factor:n,zoomFitPadding:i=12,zoomOptions:o=Su.defaultZoomOptions}=e;return"number"==typeof n?null==t||t.zoom(n,o||{}):"fit"===n?null==t||t.zoomToFit(Object.assign(Object.assign({},o),{padding:i})):"real"===n&&(null==t||t.scale(1),null==t||t.centerContent()),{factor:n,zoomFitPadding:i,zoomOptions:o}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Pu;fi([Kn(ba),pi("design:type",Object)],Tu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Tu.prototype,"init",null),Tu=fi([Xn({token:{token:ma,named:Su.command.id}})],Tu),function(t){t.command=e.XFlowGraphCommands.GRAPH_COPY,t.hookKey="graphCopySelection"}(Pu||(Pu={}));let Nu=class{constructor(){this.parseCells=e=>{e.forEach((t=>{const n=t.getData();if(t.isNode()&&n.isGroup){t.getChildren().forEach((t=>{e.push(t)}))}}));const t=e.filter((e=>e.isNode())).map((e=>e.id)),n=e.reduce(((e,n)=>{if(n.isEdge()){const i=n.getSourceCellId(),o=n.getTargetCellId();i&&o&&t.includes(i)&&t.includes(o)&&e.set(n.id,n)}else e.set(n.id,n);return e}),new Map),i=Array.from(n.values());return Uc(i)},this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.graphCopySelection.call(n,(()=>gi(this,void 0,void 0,(function*(){const n=(yield t.getX6Graph()).getSelectedCells(),i=this.parseCells(n),o=window.localStorage.getItem(Ui);return window.localStorage.setItem(Ui,JSON.stringify(i)),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){window.localStorage.setItem(Ui,o)}))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};fi([Kn(ba),pi("design:type",Object)],Nu.prototype,"contextProvider",void 0),Nu=fi([Xn({token:{token:ma,named:Pu.command.id}})],Nu);let Iu=class{constructor(){this.groupNodeMap=new Map,this.nodeMap=new Map,this.nodeMappingRecord=new Map,this.portMap=new Map,this.portMappingRecord=new Map,this.edgeMap=new Map,this.edgeMappingRecord=new Map,this.getNodesByType=e=>e.reduce(((e,t)=>(t.isGroup?e.groupNodes.push(t):e.normalNodes.push(t),e)),{normalNodes:[],groupNodes:[]}),this.getNodePorts=e=>Array.isArray(e.ports)?e.ports:e.ports&&Array.isArray(e.ports.items)?e.ports.items:[],this.addNodes=e=>{e.forEach((e=>{if(e.isGroup)this.groupNodeMap.set(e.id,e);else{const t=this.getNodePorts(e);this.nodeMap.set(e.id,e),t.forEach((e=>{this.portMap.set(e.id,e)}))}}))},this.addEdge=e=>{e.forEach((e=>{this.edgeMap.set(e.id,e)}))},this.buildNodeMapping=(e,t)=>{const n=e.id||e.originId,i=t.id;this.nodeMappingRecord.set(n,i);this.getNodePorts(e).forEach(((e,n)=>{const i=t.ports[n];i&&(this.portMap.set(i.id,i),this.portMappingRecord.set(e.id,i.id))}))},this.createEdgeBetweenNodes=e=>{const{source:t,sourcePortId:n,target:i,targetPortId:o}=e;return Object.assign(Object.assign({},e),{source:this.nodeMappingRecord.get(t),target:this.nodeMappingRecord.get(i),sourcePortId:this.portMappingRecord.get(n),targetPortId:this.portMappingRecord.get(o)})},this.buildGroupRelations=e=>{const{groupChildren:t}=e,n=t.map((e=>this.nodeMappingRecord.get(e)));return Object.assign(Object.assign({},e),{groupChildren:n})}}};var ku,Mu;function Du(e,t=0){return Math.floor(Math.random()*(e-t)+t)}Iu=fi([Xn()],Iu),function(t){t.command=e.XFlowGraphCommands.GRAPH_PASTE,t.hookKey="graphPasteSelection"}(Mu||(Mu={}));let Ru=ku=class{constructor(){this.updateNodeCopiedProps=(e,t)=>{let n=Du(100),i=Du(100);return e&&(n=t.x-e.x+Du(30),i=t.y-e.y+Du(30)),t.x+=n,t.y+=i,t.originId=t.id,delete t.id,t.label=`${t.label}_copied`,t.isCollapsed=!1,t},this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks();if(ku.doing)return this;ku.doing=!0;const r=yield o.graphPasteSelection.call(n,(n=>gi(this,void 0,void 0,(function*(){const{commandService:i,position:o}=n,r=function(e,t=null){try{return JSON.parse(e)||t}catch(e){return console.error(e),t}}(window.localStorage.getItem(Ui),{nodes:[],edges:[]}),{nodes:s=[],edges:a=[]}=r,{normalNodes:c,groupNodes:u}=this.mappingHelper.getNodesByType(s);return this.mappingHelper.addNodes(s),yield Promise.all(c.map((t=>gi(this,void 0,void 0,(function*(){const n=(yield i.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:this.updateNodeCopiedProps(o,t)})).contextProvider().getResult();this.mappingHelper.buildNodeMapping(t,n.nodeConfig)}))))),yield Promise.all(u.map((t=>gi(this,void 0,void 0,(function*(){const n=this.mappingHelper.buildGroupRelations(t);yield i.executeCommand(e.XFlowGroupCommands.ADD_GROUP.id,{nodeConfig:this.updateNodeCopiedProps(o,n)})}))))),yield Promise.all(a.map((t=>{const n=this.mappingHelper.createEdgeBetweenNodes(t);return i.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:n})}))),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){window.localStorage.setItem(Ui,null)}))))),{err:null}}))),i);return t.setResult(r),ku.doing=!1,this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var ju;Ru.doing=!1,fi([Kn(ba),pi("design:type",Object)],Ru.prototype,"contextProvider",void 0),fi([Kn(Iu),pi("design:type",Iu)],Ru.prototype,"mappingHelper",void 0),Ru=ku=fi([Xn({token:{token:ma,named:Mu.command.id}})],Ru),function(t){t.command=e.XFlowGraphCommands.GRAPH_TOGGLE_MULTI_SELECT,t.hookKey="toggleMultiSelect"}(ju||(ju={}));let Gu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.toggleMultiSelect.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),n=yield this.ctx.getGraphConfig(),{isEnable:i,modelService:o}=e,r=yield hc.getModel(o),s="boolean"==typeof i?i:!t.isRubberbandEnabled();return s?(t.enableRubberband(),t.scroller&&t.scroller.widget?t.scroller.disablePanning():t.disablePanning(),n.graphContainer.style.cursor="crosshair"):(t.disableRubberband(),t.scroller&&t.scroller.widget?t.scroller.enablePanning():t.enablePanning(),n.graphContainer.style.cursor="grab"),r.setValue({isEnable:s}),{isEnable:s}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Fu;fi([Kn(ba),pi("design:type",Object)],Gu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Gu.prototype,"init",null),Gu=fi([Xn({token:{token:ma,named:ju.command.id}})],Gu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_UNDO,t.hookKey="historyUndo"}(Fu||(Fu={}));let Uu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.historyUndo.call(n,(n=>gi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph();return!1===i.isHistoryEnabled()?{err:"history is disabled"}:(i.undo(),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_REDO.id,{})}))))),{err:null})}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Lu;fi([Kn(ba),pi("design:type",Object)],Uu.prototype,"contextProvider",void 0),Uu=fi([Xn({token:{token:ma,named:Fu.command.id}})],Uu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_REDO,t.hookKey="historyRedo"}(Lu||(Lu={}));let Bu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.historyRedo.call(n,(n=>gi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph();return!1===i.isHistoryEnabled()?{err:"history is disabled"}:(i.redo(),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_UNDO.id,{})}))))),{err:null})}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Hu;fi([Kn(ba),pi("design:type",Object)],Bu.prototype,"contextProvider",void 0),Bu=fi([Xn({token:{token:ma,named:Lu.command.id}})],Bu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_TOGGLE,t.hookKey="historyToggle"}(Hu||(Hu={}));let Vu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.historyToggle.call(n,(n=>gi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph();if(!1===i.isHistoryEnabled())return{err:"history is disabled"};const o=i.isHistoryEnabled(),{enabled:r}=n;return i.toggleHistory(r),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_TOGGLE.id,{enabled:o})}))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Xu;fi([Kn(ba),pi("design:type",Object)],Vu.prototype,"contextProvider",void 0),Vu=fi([Xn({token:{token:ma,named:Hu.command.id}})],Vu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_RESET,t.hookKey="historyReset"}(Xu||(Xu={}));let zu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks(),o=yield i.historyReset.call(t,(()=>gi(this,void 0,void 0,(function*(){return(yield e.getX6Graph()).cleanHistory(),{err:null}}))),n);return e.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Ku;fi([Kn(ba),pi("design:type",Object)],zu.prototype,"contextProvider",void 0),zu=fi([Xn({token:{token:ma,named:Xu.command.id}})],zu),function(t){t.command=e.XFlowGraphCommands.GRAPH_ADD_TOOL,t.hookKey="addTool"}(Ku||(Ku={}));let Wu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.addTool.call(n,(n=>gi(this,void 0,void 0,(function*(){const{cellId:i,toolConfig:o,commandService:r}=n,s=(yield t.getX6Graph()).getCellById(i);return s&&(s.addTools(o.items,o.options),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){Array.isArray(o.items)&&o.items.forEach((t=>{r.executeCommand(e.XFlowGraphCommands.GRAPH_DEL_TOOL.id,{cellId:i,toolname:t})}))})))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Yu;fi([Kn(ba),pi("design:type",Object)],Wu.prototype,"contextProvider",void 0),Wu=fi([Xn({token:{token:ma,named:Ku.command.id}})],Wu),function(t){t.command=e.XFlowGraphCommands.GRAPH_DEL_TOOL,t.hookKey="delTool"}(Yu||(Yu={}));let qu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks(),o=yield i.delTool.call(t,(t=>gi(this,void 0,void 0,(function*(){const{cellId:n,toolName:i,toolConfig:o}=t,r=(yield e.getX6Graph()).getCellById(n);return r&&("*"===i?r.removeTools(o):r.removeTool(i,o)),{err:null}}))),n);return e.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var $u;fi([Kn(ba),pi("design:type",Object)],qu.prototype,"contextProvider",void 0),qu=fi([Xn({token:{token:ma,named:Yu.command.id}})],qu),function(t){t.command=e.XFlowGraphCommands.REDO_CMD,t.hookKey="redoCommand"}($u||($u={}));let Ju=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.ctx,{args:n,hooks:i}=t.getArgs(),o=t.getHooks();return yield o.redoCommand.call(n,(()=>gi(this,void 0,void 0,(function*(){const n=t.getCommands();return n.isRedoable&&n.redoCommand(),this.ctx.addUndo(e.Disposable.create((()=>{n.redoCommand()}))),{}}))),i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Zu;fi([Kn(ba),pi("design:type",Object)],Ju.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Ju.prototype,"init",null),Ju=fi([Xn({token:{token:ma,named:$u.command.id}})],Ju),function(t){t.command=e.XFlowGraphCommands.UNDO_CMD,t.hookKey="undoCommand"}(Zu||(Zu={}));let Qu=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.ctx,{args:n,hooks:i}=t.getArgs(),o=t.getHooks();return yield o.undoCommand.call(n,(()=>gi(this,void 0,void 0,(function*(){const n=t.getCommands();return n.isUndoable&&n.undoCommand(),this.ctx.addUndo(e.Disposable.create((()=>{n.redoCommand()}))),{}}))),i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};fi([Kn(ba),pi("design:type",Object)],Qu.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Qu.prototype,"init",null),Qu=fi([Xn({token:{token:ma,named:Zu.command.id}})],Qu);const ed=[pu,vu,mu,Fu,Lu,Xu,Hu,_u,wu,xu,$u,Zu,Su,ju,Pu,Mu,Ku,Yu];var td;!function(t){function i(e){return e.source&&e.source.cell&&n.StringExt.isString(e.source.cell)}function o(e){return e.sourceCell&&n.StringExt.isString(e.sourceCell)}t.command=e.XFlowEdgeCommands.ADD_EDGE,t.hookKey="addEdge",t.createEdgeId=e=>{if(n.StringExt.isString(e.source))return`${e.source}:${e.sourcePortId}-${e.target}:${e.targetPortId}`;if(i(e)){const t=e;return`${t.source.cell}:${t.source.port}-${t.target.cell}:${t.target.port}`}if(o(e)){const t=e;return`${t.sourceCell}:${t.sourcePort}-${t.targetCell}:${t.targetPort}`}},t.isX6EdgeConfig=i,t.isX6EdgePlainConfig=o}(td||(td={}));let nd=class{constructor(){this.processEdgeConfig=(e,t)=>gi(this,void 0,void 0,(function*(){if(!t.id){const{createIdService:n=td.createEdgeId}=e;t.id=yield n(t)}return t.sourcePortId&&!t.sourcePort&&(t.sourcePort=t.sourcePortId,t.targetPort=t.targetPortId),t})),this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.addEdge.call(t,(t=>gi(this,void 0,void 0,(function*(){const{cellFactory:n,createEdgeService:i,commandService:o,options:r}=t,s=yield this.ctx.getX6Graph();let a=t.edgeConfig;if(i){const e=yield i(t);if("boolean"==typeof e)return{err:"createEdgeService rejected"};a=e}const c=yield this.processEdgeConfig(t,a);let u;if(n){const e=yield n(c,this);u=s.addEdge(e,r)}else u=s.addEdge(Object.assign(Object.assign({},c),{label:(null==c?void 0:c.label)||c,data:Object.assign({},c)}),r);const d=e.Disposable.create((()=>{o.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{x6Edge:u})}));return this.ctx.addUndo(d),{edgeConfig:c,edgeCell:u}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var id;fi([Kn(ba),pi("design:type",Object)],nd.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],nd.prototype,"init",null),nd=fi([Xn({token:{token:ma,named:td.command.id}})],nd),function(t){var n;t.command=e.XFlowEdgeCommands.DEL_EDGE,t.hookKey="delEdge",(n=t.ErrEnum||(t.ErrEnum={})).EDGE_NOT_EXIST="edge is not exist",n.EDGE_INVALID_CELL="this is not a valid cell",n.X6_DELETE_FAILED="x6 throw err when call delete edge",n.SERVICE_REJECT="service reject to delete"}(id||(id={}));let od=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.delEdge.call(t,(t=>gi(this,void 0,void 0,(function*(){const{edgeConfig:n,x6Edge:i,deleteEdgeService:o,commandService:r,options:s}=t;let a=i;if(!a&&(a=yield this.findEdgeById(n),!a))return console.error(id.ErrEnum.EDGE_NOT_EXIST,n),{err:id.ErrEnum.EDGE_NOT_EXIST};if(!(a&&a.isEdge()))return console.error(id.ErrEnum.EDGE_NOT_EXIST,a),{err:id.ErrEnum.EDGE_NOT_EXIST};if(o){if(!(yield o(t)))return{err:id.ErrEnum.SERVICE_REJECT}}try{const t=a.getTargetCell(),n=a.getSourceCell(),i=a.getSourcePortId(),o=a.getTargetPortId(),c=n.id,u=t.id;a.remove(s);const d=e.Disposable.create((()=>{r.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:{source:c,target:u,sourcePortId:i,targetPortId:o}})}));return this.ctx.addUndo(d),{err:null,edgeConfig:{source:c,target:u,sourcePortId:i,targetPortId:o},targetCell:t,sourceCell:n,sourcePortId:i,targetPortId:o}}catch(e){return console.error(id.ErrEnum.X6_DELETE_FAILED,e),{err:id.ErrEnum.X6_DELETE_FAILED}}}))),n);return this.ctx.setResult(o),this})),this.findEdgeById=e=>gi(this,void 0,void 0,(function*(){return(yield this.ctx.getX6Graph()).getCellById(e.id)})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var rd;fi([Kn(ba),pi("design:type",Object)],od.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],od.prototype,"init",null),od=fi([Xn({token:{token:ma,named:id.command.id}})],od),function(t){t.command=e.XFlowEdgeCommands.UPDATE_EDGE,t.hookKey="updateEdge",t.XFlowEdgeSetOptions={overwrite:!0},t.XFlowUpdateLabelService=(e,n,i=t.XFlowEdgeSetOptions)=>gi(this,void 0,void 0,(function*(){null==e||e.setLabelAt(0,(null==n?void 0:n.label)||n,i)}))}(rd||(rd={}));let sd=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.updateEdge.call(e,(e=>gi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{updateEdgeService:n,updateEdgeLabelService:i=rd.XFlowUpdateLabelService,options:o=rd.XFlowEdgeSetOptions}=e,r=n?yield n(e):null==e?void 0:e.edgeConfig,s=null==t?void 0:t.getCellById(null==r?void 0:r.id);return null==s||s.setData(r,o),(null==r?void 0:r.label)&&(yield i(s,r,o)),r.attrs&&s.setAttrs(r.attrs),{edgeConfig:r,edgeCell:s}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var ad;fi([Kn(ba),pi("design:type",Object)],sd.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],sd.prototype,"init",null),sd=fi([Xn({token:{token:ma,named:rd.command.id}})],sd),function(t){t.command=e.XFlowEdgeCommands.HIGHLIGHT_EDGE,t.hookKey="highlightEdge"}(ad||(ad={}));let cd=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.highlightEdge.call(t,(t=>gi(this,void 0,void 0,(function*(){var n,i;const o=yield this.ctx.getX6Graph(),{edgeId:r,strokeColor:s,strokeWidth:a}=t,c=o.getEdges(),u=c.find((e=>e.id===r)),d=c.filter((e=>e.id!==r));if(u){const o=u.getAttrs();(null===(n=null==o?void 0:o.line)||void 0===n?void 0:n.stroke)===s&&(null===(i=null==o?void 0:o.line)||void 0===i?void 0:i.strokeWidth)===a||(null==u||u.setAttrs({line:{stroke:s,strokeWidth:a||2}}),d.forEach((e=>{e.setAttrs({line:null==o?void 0:o.line})})),t.commandService.executeCommand(e.XFlowEdgeCommands.FRONT_EDGE.id,{edgeId:r}))}else console.error(r,"this edgeId is not exist");return{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var ud;fi([Kn(ba),pi("design:type",Object)],cd.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],cd.prototype,"init",null),cd=fi([Xn({token:{token:ma,named:ad.command.id}})],cd),function(t){t.command=e.XFlowEdgeCommands.FRONT_EDGE,t.hookKey="frontEdge"}(ud||(ud={}));let dd=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.frontEdge.call(t,(t=>gi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{edgeId:i}=t,o=null==n?void 0:n.getCellById(i);return o?(o.toFront(),this.ctx.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowEdgeCommands.BACK_EDGE.id,{edgeId:i})})))))):console.error(i,"this edgeId is not exist"),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var ld;fi([Kn(ba),pi("design:type",Object)],dd.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],dd.prototype,"init",null),dd=fi([Xn({token:{token:ma,named:ud.command.id}})],dd),function(t){t.command=e.XFlowEdgeCommands.BACK_EDGE,t.hookKey="frontEdge"}(ld||(ld={}));let hd=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.frontEdge.call(t,(t=>gi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{edgeId:i}=t,o=null==n?void 0:n.getCellById(i);return o?(o.toBack(),this.ctx.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowEdgeCommands.FRONT_EDGE.id,{edgeId:i})})))))):console.error(i,"this edgeId is not exist"),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};fi([Kn(ba),pi("design:type",Object)],hd.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],hd.prototype,"init",null),hd=fi([Xn({token:{token:ma,named:ld.command.id}})],hd);const fd=[td,id,rd,ad,ud,ld];var pd;!function(t){t.command=e.XFlowGroupCommands.ADD_GROUP,t.hookKey="addGroup",t.GROUP_PADDING=12,t.GROUP_HEADER_HEIGHT=40}(pd||(pd={}));let gd=class{constructor(){this.getBBox=(e,t,n)=>{const{groupHeaderHeight:i=pd.GROUP_HEADER_HEIGHT,groupPadding:o=pd.GROUP_PADDING}=t,r=n.getCellsBBox(e.children);return r.moveAndExpand({x:-o,y:-(o+i),width:2*o,height:2*o+i}),r},this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.addGroup.call(n,(n=>gi(this,void 0,void 0,(function*(){const{nodeConfig:i,createService:o,cellFactory:r,commandService:s}=n,a=yield t.getX6Graph(),c=yield s.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{cellFactory:r,createNodeService:o,nodeConfig:i}),{nodeCell:u}=c.contextProvider().getResult(),{id:d}=u,{groupChildren:l}=i;if(l.length){l.forEach((e=>{const t=a.getCellById(e);t&&(t.setData(Object.assign(Object.assign({},t.getData()),{group:d,isCollapsed:!1})),t.prop("group",d),u.addChild(t),a.unselect(t))}));const e=this.getBBox(u,i,a);u.position(e.x,e.y),u.size(e.width,e.height),u.setZIndex(0),u.prop("isGroup",!0),u.setData(Object.assign(Object.assign({},u.getData()),{width:e.width,height:e.height,groupChildrenSize:{width:e.width,height:e.height},x:e.x,y:e.y,isGroup:!0})),a.select(u)}return i.isCollapsed&&(yield s.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:i.id,isCollapsed:i.isCollapsed})),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){s.executeCommand(e.XFlowGroupCommands.DEL_GROUP.id,{nodeConfig:i})}))))),{nodeConfig:i,nodeCell:u}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var vd;fi([Kn(ba),pi("design:type",Object)],gd.prototype,"contextProvider",void 0),gd=fi([Xn({token:{token:ma,named:pd.command.id}})],gd),function(t){t.command=e.XFlowGroupCommands.DEL_GROUP,t.hookKey="delGroup"}(vd||(vd={}));let yd=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.delGroup.call(n,(n=>gi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph(),{nodeConfig:o,commandService:r,deleteService:s}=n,{id:a}=o,c=i.getCellById(a);if(s){if(!(yield s(n)))return{err:"service rejected"}}if(!c)return{err:"target node is not exist"};if(!0!==c.getProp("isGroup"))return{err:"target node is not group"};const{isCollapsed:u}=c.getData();u&&(yield r.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:c.id,isCollapsed:!1,collapsedSize:{width:0,height:0}}));const d=c.getChildren();return d&&d.forEach((e=>{c.unembed(e),e.prop("group",""),e.setData(Object.assign(Object.assign({},e.getData()),{group:""}))})),yield r.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:o}),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){r.executeCommand(e.XFlowGroupCommands.ADD_GROUP.id,{nodeConfig:o})}))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var md;fi([Kn(ba),pi("design:type",Object)],yd.prototype,"contextProvider",void 0),yd=fi([Xn({token:{token:ma,named:vd.command.id}})],yd),function(t){t.command=e.XFlowGroupCommands.INIT_GROUP,t.hookKey="initGroup"}(md||(md={}));let bd=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.initGroup.call(n,(n=>gi(this,void 0,void 0,(function*(){const{graphData:i,commandService:o}=n,r=yield t.getX6Graph(),{nodes:s}=i,a={};return s.forEach((e=>{const{id:t,group:n}=e;n&&(a[n]?a[n].push(t):a[n]=[t])})),Object.keys(a).forEach((t=>gi(this,void 0,void 0,(function*(){const i=r.getCellById(t),s=i.getData(),c=a[t]||[];i.prop("isGroup",!0),i.setData(Object.assign(Object.assign({},s),{isGroup:!0,groupChildren:c})),c.forEach((e=>{const t=r.getCellById(e);i.embed(t)})),i.toBack();const{isCollapsed:u,groupCollapsedSize:d}=s;if(u){const t=n.collapsedSize||d||Li;yield o.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{collapsedSize:t,isCollapsed:!0,nodeId:i.id})}})))),{}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var _d;fi([Kn(ba),pi("design:type",Object)],bd.prototype,"contextProvider",void 0),bd=fi([Xn({token:{token:ma,named:md.command.id}})],bd),function(t){t.command=e.XFlowGroupCommands.COLLAPSE_GROUP,t.hookKey="collapseGroup"}(_d||(_d={}));let Ed=class{constructor(){this.toggleVisible=(e,t,n)=>{e.forEach((e=>{n.findViewByCell(e).container.style.visibility=t?"visible":"hidden"}))},this.toggleCollapse=(e,t,n)=>{const i=e.getChildren().filter((e=>e.isNode())),o=e.getData(),{isCollapsed:r,gap:s=0}=n;if(r){const t=n.collapsedSize||o.groupCollapsedSize||Li;e.prop("previousSize",e.size()),e.size(t)}else e.size(e.prop("previousSize"));i&&i.forEach((n=>{const o=e.position(),a=t.getConnectedEdges(n).filter((e=>{const t=e.getSourceNode(),n=e.getTargetNode();return i.includes(t)&&i.includes(n)}));if(r){this.toggleVisible([n,...a],!1,t),n.prop("previousSize",n.size()),n.prop("previousRelativePosition",n.position({relative:!0})),n.position(o.x+s,o.y+s);const i=e.size();n.size({width:i.width-2*s,height:i.height-2*s})}else{this.toggleVisible([n,...a],!0,t);const e=n.prop("previousRelativePosition"),i=n.prop("previousSize");n.position(e.x,e.y,{relative:!0}),n.size(i)}})),e.prop("isCollapsed",r),e.setData(Object.assign(Object.assign({},e.getData()),{isCollapsed:r}))},this.execute=()=>gi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.collapseGroup.call(t,(n=>gi(this,void 0,void 0,(function*(){const i=yield this.ctx.getX6Graph(),o=i.getCellById(t.nodeId),{toggleService:r}=n;if(r){if(!(yield r(n)))return{err:"service rejected"}}return o&&(this.toggleCollapse(o,i,t),this.ctx.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){o&&this.toggleCollapse(o,i,Object.assign(t,{isCollapsed:!t.isCollapsed}))})))))),{err:null}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};fi([Kn(ba),pi("design:type",Object)],Ed.prototype,"contextProvider",void 0),fi([p.postConstruct(),pi("design:type",Function),pi("design:paramtypes",[]),pi("design:returntype",void 0)],Ed.prototype,"init",null),Ed=fi([Xn({token:{token:ma,named:_d.command.id}})],Ed);const Cd=[pd,vd,md,_d];var wd;!function(t){t.command=e.XFlowModelCommands.UPDATE_MODEL,t.hookKey="updateModel"}(wd||(wd={}));let Od=class{constructor(){this.execute=()=>gi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.updateModel.call(n,(n=>gi(this,void 0,void 0,(function*(){const{updateModel:i,getModel:o,modelService:r}=n,s=yield o(r),a=s.getValue(),c=fa(a);yield i(c);const u=pa(c);return s.setValue(u),t.addUndo(e.Disposable.create((()=>gi(this,void 0,void 0,(function*(){s.setValue(u)}))))),{model:s,value:u}}))),i);return t.setResult(r),this})),this.undo=()=>gi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>gi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};fi([Kn(ba),pi("design:type",Object)],Od.prototype,"contextProvider",void 0),Od=fi([Xn({token:{token:ma,named:wd.command.id}})],Od);const xd=[...fu,...fd,...Cd,...ed,...[wd]],Ad=()=>new Ga;let Sd=class{constructor(){this.registerHook=t=>gi(this,void 0,void 0,(function*(){const n=t.x6Events.registerHook({name:"bind group node move event",handler:e=>gi(this,void 0,void 0,(function*(){const t={eventName:"node:moving",callback:({node:e})=>gi(this,void 0,void 0,(function*(){if(e.prop("isGroup"))return void e.prop("originPosition",e.getPosition());const t=e.model.graph,{group:n}=e.getData(),i=t.getNodes().find((e=>e.id===n));if(!i)return;const o=i.getProp("isCollapsed");let r=i.getProp("originSize"),s=!1;null==r&&(r=i.size(),i.prop("originSize",r));let a=i.prop("originPosition");null==a&&(a=i.getPosition(),i.prop("originPosition",a));let c=a.x,u=a.y,d=a.x+r.width,l=a.y+r.height;const h=i.getChildren();if(h&&h.forEach((e=>{const t=e.getBBox().inflate(12),n=t.getCorner();t.x<c&&(c=t.x,s=!0),t.y<u&&(u=t.y,s=!0),n.x>d&&(d=n.x,s=!0),n.y>l&&(l=n.y,s=!0)})),s){i.prop({position:{x:c,y:u},size:{width:d-c,height:l-u}});const e=Object.assign(Object.assign({},i.getData()),{x:c,y:u,width:d-c,height:l-u});!0!==o&&(e.groupChildrenSize={width:d-c,height:l-u}),i.setData(e)}}))};e.push(t)}))});return e.Disposable.create((()=>{n.dispose()}))})),this.registerHookHub=e=>gi(this,void 0,void 0,(function*(){const t=new ki;return xd.forEach((({hookKey:n,createHook:i=Ad})=>{const o=e.registerHookHub(n,i());t.push(o)})),this.commandConfig.getConfig().then((({getContributions:n})=>{n().forEach((({hookKey:n,createHook:i=Ad})=>{const o=e.registerHookHub(n,i());t.push(o)}))})),t}))}registerGraphCommands(e){xd.forEach((({command:t})=>{e.registerCommand(t,{createCommand:this.commandFactory})})),this.commandConfig.getConfig().then((({getContributions:t})=>{t().forEach((t=>{e.registerCommand(t.command,{createCommand:this.commandFactory})}))}))}};fi([Kn(_a),pi("design:type",Function)],Sd.prototype,"commandFactory",void 0),fi([Kn(Yc),pi("design:type",Yc)],Sd.prototype,"commandConfig",void 0),Sd=fi([zn({contrib:[Ea,Ua]})],Sd);const Td=(e,t)=>{t.getCommandContributions().forEach((t=>{const{CommandHandler:n,command:i}=t;e({token:{token:ma,named:i.id},useClass:n})})),(e=>{e(gu),e(bu),e(yu),e(Eu),e(Ou),e(Au),e(Uu),e(Bu),e(Vu),e(zu),e(Ju),e(Qu),e(Tu),e(Gu),e(Nu),e(Ru),e(Wu),e(qu)})(e),(e=>{e($c),e(Zc),e(eu),e(nu),e(ou),e(su),e(cu),e(du),e(hu)})(e),(e=>{e(nd),e(od),e(sd),e(cd),e(dd),e(hd)})(e),(e=>{e(gd),e(yd),e(bd),e(Ed)})(e),(e=>{e(Od)})(e),e(Sd)},Pd=e=>oi((t=>{t(Iu),((e,t)=>{e({token:Yc,contrib:[Ua],lifecycle:An.Lifecycle.singleton,useDynamic:()=>t})})(t,e),Td(t,e),t(Kc),t(_a,{useFactory:e=>(t,n,i)=>{const o=e.container.createChild(),r=o.get(Kc);o.register(ba,{useDynamic:()=>()=>r});const s=o.getNamed(ma,t);return r.setArgs(n,i),r.handlerInstance=s,s}})})),Nd=e=>{const t=Za(),n=u.default.useMemo((()=>e.config?e.config:new Yc),[]);return u.default.useEffect((()=>{t.addCoreModule({config:n,createModule:Pd})}),[]),null},Id=Symbol("IToolbarService"),kd=An.defineToken("IToolbarContribution");var Md=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Dd="object"==typeof f&&f&&f.Object===Object&&f,Rd=Dd,jd="object"==typeof self&&self&&self.Object===Object&&self,Gd=Rd||jd||Function("return this")(),Fd=Gd,Ud=function(){return Fd.Date.now()},Ld=/\s/;var Bd=function(e){for(var t=e.length;t--&&Ld.test(e.charAt(t)););return t},Hd=/^\s+/;var Vd=function(e){return e?e.slice(0,Bd(e)+1).replace(Hd,""):e},Xd=Gd.Symbol,zd=Xd,Kd=Object.prototype,Wd=Kd.hasOwnProperty,Yd=Kd.toString,qd=zd?zd.toStringTag:void 0;var $d=function(e){var t=Wd.call(e,qd),n=e[qd];try{e[qd]=void 0;var i=!0}catch(e){}var o=Yd.call(e);return i&&(t?e[qd]=n:delete e[qd]),o},Jd=Object.prototype.toString;var Zd=$d,Qd=function(e){return Jd.call(e)},el=Xd?Xd.toStringTag:void 0;var tl=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":el&&el in Object(e)?Zd(e):Qd(e)};var nl=function(e){return null!=e&&"object"==typeof e},il=tl,ol=nl;var rl=Vd,sl=Md,al=function(e){return"symbol"==typeof e||ol(e)&&"[object Symbol]"==il(e)},cl=/^[-+]0x[0-9a-f]+$/i,ul=/^0b[01]+$/i,dl=/^0o[0-7]+$/i,ll=parseInt;var hl=Md,fl=Ud,pl=function(e){if("number"==typeof e)return e;if(al(e))return NaN;if(sl(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=sl(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=rl(e);var n=ul.test(e);return n||dl.test(e)?ll(e.slice(2),n?2:8):cl.test(e)?NaN:+e},gl=Math.max,vl=Math.min;var yl=function(e,t,n){var i,o,r,s,a,c,u=0,d=!1,l=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=i,r=o;return i=o=void 0,u=t,s=e.apply(r,n)}function p(e){return u=e,a=setTimeout(v,t),d?f(e):s}function g(e){var n=e-c;return void 0===c||n>=t||n<0||l&&e-u>=r}function v(){var e=fl();if(g(e))return y(e);a=setTimeout(v,function(e){var n=t-(e-c);return l?vl(n,r-(e-u)):n}(e))}function y(e){return a=void 0,h&&i?f(e):(i=o=void 0,s)}function m(){var e=fl(),n=g(e);if(i=arguments,o=this,c=e,n){if(void 0===a)return p(c);if(l)return clearTimeout(a),a=setTimeout(v,t),f(c)}return void 0===a&&(a=setTimeout(v,t)),s}return t=pl(t)||0,hl(n)&&(d=!!n.leading,r=(l="maxWait"in n)?gl(pl(n.maxWait)||0,t):r,h="trailing"in n?!!n.trailing:h),m.cancel=function(){void 0!==a&&clearTimeout(a),u=0,i=c=o=a=void 0},m.flush=function(){return void 0===a?s:y(fl())},m};var ml=function(){this.__data__=[],this.size=0};var bl=function(e,t){return e===t||e!=e&&t!=t},_l=bl;var El=function(e,t){for(var n=e.length;n--;)if(_l(e[n][0],t))return n;return-1},Cl=El,wl=Array.prototype.splice;var Ol=El;var xl=El;var Al=El;var Sl=ml,Tl=function(e){var t=this.__data__,n=Cl(t,e);return!(n<0)&&(n==t.length-1?t.pop():wl.call(t,n,1),--this.size,!0)},Pl=function(e){var t=this.__data__,n=Ol(t,e);return n<0?void 0:t[n][1]},Nl=function(e){return xl(this.__data__,e)>-1},Il=function(e,t){var n=this.__data__,i=Al(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};function kl(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}kl.prototype.clear=Sl,kl.prototype.delete=Tl,kl.prototype.get=Pl,kl.prototype.has=Nl,kl.prototype.set=Il;var Ml=kl,Dl=Ml;var Rl=function(){this.__data__=new Dl,this.size=0};var jl=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var Gl=function(e){return this.__data__.get(e)};var Fl=function(e){return this.__data__.has(e)},Ul=tl,Ll=Md;var Bl,Hl=function(e){if(!Ll(e))return!1;var t=Ul(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Vl=Gd["__core-js_shared__"],Xl=(Bl=/[^.]+$/.exec(Vl&&Vl.keys&&Vl.keys.IE_PROTO||""))?"Symbol(src)_1."+Bl:"";var zl=function(e){return!!Xl&&Xl in e},Kl=Function.prototype.toString;var Wl=function(e){if(null!=e){try{return Kl.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Yl=Hl,ql=zl,$l=Md,Jl=Wl,Zl=/^\[object .+?Constructor\]$/,Ql=Function.prototype,eh=Object.prototype,th=Ql.toString,nh=eh.hasOwnProperty,ih=RegExp("^"+th.call(nh).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var oh=function(e){return!(!$l(e)||ql(e))&&(Yl(e)?ih:Zl).test(Jl(e))},rh=function(e,t){return null==e?void 0:e[t]};var sh=function(e,t){var n=rh(e,t);return oh(n)?n:void 0},ah=sh(Gd,"Map"),ch=sh(Object,"create"),uh=ch;var dh=function(){this.__data__=uh?uh(null):{},this.size=0};var lh=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},hh=ch,fh=Object.prototype.hasOwnProperty;var ph=function(e){var t=this.__data__;if(hh){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return fh.call(t,e)?t[e]:void 0},gh=ch,vh=Object.prototype.hasOwnProperty;var yh=ch;var mh=dh,bh=lh,_h=ph,Eh=function(e){var t=this.__data__;return gh?void 0!==t[e]:vh.call(t,e)},Ch=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=yh&&void 0===t?"__lodash_hash_undefined__":t,this};function wh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}wh.prototype.clear=mh,wh.prototype.delete=bh,wh.prototype.get=_h,wh.prototype.has=Eh,wh.prototype.set=Ch;var Oh=wh,xh=Ml,Ah=ah;var Sh=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Th=function(e,t){var n=e.__data__;return Sh(t)?n["string"==typeof t?"string":"hash"]:n.map},Ph=Th;var Nh=Th;var Ih=Th;var kh=Th;var Mh=function(){this.size=0,this.__data__={hash:new Oh,map:new(Ah||xh),string:new Oh}},Dh=function(e){var t=Ph(this,e).delete(e);return this.size-=t?1:0,t},Rh=function(e){return Nh(this,e).get(e)},jh=function(e){return Ih(this,e).has(e)},Gh=function(e,t){var n=kh(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function Fh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Fh.prototype.clear=Mh,Fh.prototype.delete=Dh,Fh.prototype.get=Rh,Fh.prototype.has=jh,Fh.prototype.set=Gh;var Uh=Ml,Lh=ah,Bh=Fh;var Hh=Ml,Vh=Rl,Xh=jl,zh=Gl,Kh=Fl,Wh=function(e,t){var n=this.__data__;if(n instanceof Uh){var i=n.__data__;if(!Lh||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Bh(i)}return n.set(e,t),this.size=n.size,this};function Yh(e){var t=this.__data__=new Hh(e);this.size=t.size}Yh.prototype.clear=Vh,Yh.prototype.delete=Xh,Yh.prototype.get=zh,Yh.prototype.has=Kh,Yh.prototype.set=Wh;var qh=Yh;var $h=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e},Jh=sh,Zh=function(){try{var e=Jh(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Qh=function(e,t,n){"__proto__"==t&&Zh?Zh(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},ef=Qh,tf=bl,nf=Object.prototype.hasOwnProperty;var of=function(e,t,n){var i=e[t];nf.call(e,t)&&tf(i,n)&&(void 0!==n||t in e)||ef(e,t,n)},rf=of,sf=Qh;var af=function(e,t,n,i){var o=!n;n||(n={});for(var r=-1,s=t.length;++r<s;){var a=t[r],c=i?i(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),o?sf(n,a,c):rf(n,a,c)}return n};var cf=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i},uf=tl,df=nl;var lf=function(e){return df(e)&&"[object Arguments]"==uf(e)},hf=nl,ff=Object.prototype,pf=ff.hasOwnProperty,gf=ff.propertyIsEnumerable,vf=lf(function(){return arguments}())?lf:function(e){return hf(e)&&pf.call(e,"callee")&&!gf.call(e,"callee")},yf=vf,mf=Array.isArray,bf={exports:{}};var _f=function(){return!1};!function(e,t){var n=Gd,i=_f,o=t&&!t.nodeType&&t,r=o&&e&&!e.nodeType&&e,s=r&&r.exports===o?n.Buffer:void 0,a=(s?s.isBuffer:void 0)||i;e.exports=a}(bf,bf.exports);var Ef=/^(?:0|[1-9]\d*)$/;var Cf=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Ef.test(e))&&e>-1&&e%1==0&&e<t};var wf=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Of=tl,xf=wf,Af=nl,Sf={};Sf["[object Float32Array]"]=Sf["[object Float64Array]"]=Sf["[object Int8Array]"]=Sf["[object Int16Array]"]=Sf["[object Int32Array]"]=Sf["[object Uint8Array]"]=Sf["[object Uint8ClampedArray]"]=Sf["[object Uint16Array]"]=Sf["[object Uint32Array]"]=!0,Sf["[object Arguments]"]=Sf["[object Array]"]=Sf["[object ArrayBuffer]"]=Sf["[object Boolean]"]=Sf["[object DataView]"]=Sf["[object Date]"]=Sf["[object Error]"]=Sf["[object Function]"]=Sf["[object Map]"]=Sf["[object Number]"]=Sf["[object Object]"]=Sf["[object RegExp]"]=Sf["[object Set]"]=Sf["[object String]"]=Sf["[object WeakMap]"]=!1;var Tf=function(e){return Af(e)&&xf(e.length)&&!!Sf[Of(e)]};var Pf=function(e){return function(t){return e(t)}},Nf={exports:{}};!function(e,t){var n=Dd,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,r=o&&o.exports===i&&n.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||r&&r.binding&&r.binding("util")}catch(e){}}();e.exports=s}(Nf,Nf.exports);var If=Tf,kf=Pf,Mf=Nf.exports,Df=Mf&&Mf.isTypedArray,Rf=Df?kf(Df):If,jf=cf,Gf=yf,Ff=mf,Uf=bf.exports,Lf=Cf,Bf=Rf,Hf=Object.prototype.hasOwnProperty;var Vf=function(e,t){var n=Ff(e),i=!n&&Gf(e),o=!n&&!i&&Uf(e),r=!n&&!i&&!o&&Bf(e),s=n||i||o||r,a=s?jf(e.length,String):[],c=a.length;for(var u in e)!t&&!Hf.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Lf(u,c))||a.push(u);return a},Xf=Object.prototype;var zf=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Xf)};var Kf=function(e,t){return function(n){return e(t(n))}},Wf=Kf(Object.keys,Object),Yf=zf,qf=Wf,$f=Object.prototype.hasOwnProperty;var Jf=Hl,Zf=wf;var Qf=function(e){return null!=e&&Zf(e.length)&&!Jf(e)},ep=Vf,tp=function(e){if(!Yf(e))return qf(e);var t=[];for(var n in Object(e))$f.call(e,n)&&"constructor"!=n&&t.push(n);return t},np=Qf;var ip=function(e){return np(e)?ep(e):tp(e)},op=af,rp=ip;var sp=function(e,t){return e&&op(t,rp(t),e)};var ap=Md,cp=zf,up=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},dp=Object.prototype.hasOwnProperty;var lp=Vf,hp=function(e){if(!ap(e))return up(e);var t=cp(e),n=[];for(var i in e)("constructor"!=i||!t&&dp.call(e,i))&&n.push(i);return n},fp=Qf;var pp=function(e){return fp(e)?lp(e,!0):hp(e)},gp=af,vp=pp;var yp=function(e,t){return e&&gp(t,vp(t),e)},mp={exports:{}};!function(e,t){var n=Gd,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,r=o&&o.exports===i?n.Buffer:void 0,s=r?r.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,i=s?s(n):new e.constructor(n);return e.copy(i),i}}(mp,mp.exports);var bp=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t};var _p=function(){return[]},Ep=function(e,t){for(var n=-1,i=null==e?0:e.length,o=0,r=[];++n<i;){var s=e[n];t(s,n,e)&&(r[o++]=s)}return r},Cp=_p,wp=Object.prototype.propertyIsEnumerable,Op=Object.getOwnPropertySymbols,xp=Op?function(e){return null==e?[]:(e=Object(e),Ep(Op(e),(function(t){return wp.call(e,t)})))}:Cp,Ap=af,Sp=xp;var Tp=function(e,t){return Ap(e,Sp(e),t)};var Pp=function(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e},Np=Kf(Object.getPrototypeOf,Object),Ip=Pp,kp=Np,Mp=xp,Dp=_p,Rp=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ip(t,Mp(e)),e=kp(e);return t}:Dp,jp=af,Gp=Rp;var Fp=function(e,t){return jp(e,Gp(e),t)},Up=Pp,Lp=mf;var Bp=function(e,t,n){var i=t(e);return Lp(e)?i:Up(i,n(e))},Hp=Bp,Vp=xp,Xp=ip;var zp=function(e){return Hp(e,Xp,Vp)},Kp=Bp,Wp=Rp,Yp=pp;var qp=function(e){return Kp(e,Yp,Wp)},$p=sh(Gd,"DataView"),Jp=ah,Zp=sh(Gd,"Promise"),Qp=sh(Gd,"Set"),eg=sh(Gd,"WeakMap"),tg=tl,ng=Wl,ig="[object Map]",og="[object Promise]",rg="[object Set]",sg="[object WeakMap]",ag="[object DataView]",cg=ng($p),ug=ng(Jp),dg=ng(Zp),lg=ng(Qp),hg=ng(eg),fg=tg;($p&&fg(new $p(new ArrayBuffer(1)))!=ag||Jp&&fg(new Jp)!=ig||Zp&&fg(Zp.resolve())!=og||Qp&&fg(new Qp)!=rg||eg&&fg(new eg)!=sg)&&(fg=function(e){var t=tg(e),n="[object Object]"==t?e.constructor:void 0,i=n?ng(n):"";if(i)switch(i){case cg:return ag;case ug:return ig;case dg:return og;case lg:return rg;case hg:return sg}return t});var pg=fg,gg=Object.prototype.hasOwnProperty;var vg=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&gg.call(e,"index")&&(n.index=e.index,n.input=e.input),n},yg=Gd.Uint8Array;var mg=function(e){var t=new e.constructor(e.byteLength);return new yg(t).set(new yg(e)),t},bg=mg;var _g=function(e,t){var n=t?bg(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},Eg=/\w*$/;var Cg=function(e){var t=new e.constructor(e.source,Eg.exec(e));return t.lastIndex=e.lastIndex,t},wg=Xd?Xd.prototype:void 0,Og=wg?wg.valueOf:void 0;var xg=mg;var Ag=mg,Sg=_g,Tg=Cg,Pg=function(e){return Og?Object(Og.call(e)):{}},Ng=function(e,t){var n=t?xg(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Ig=function(e,t,n){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return Ag(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return Sg(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ng(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return Tg(e);case"[object Symbol]":return Pg(e)}},kg=Md,Mg=Object.create,Dg=function(){function e(){}return function(t){if(!kg(t))return{};if(Mg)return Mg(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Rg=Np,jg=zf;var Gg=function(e){return"function"!=typeof e.constructor||jg(e)?{}:Dg(Rg(e))},Fg=pg,Ug=nl;var Lg=function(e){return Ug(e)&&"[object Map]"==Fg(e)},Bg=Pf,Hg=Nf.exports,Vg=Hg&&Hg.isMap,Xg=Vg?Bg(Vg):Lg,zg=pg,Kg=nl;var Wg=function(e){return Kg(e)&&"[object Set]"==zg(e)},Yg=Pf,qg=Nf.exports,$g=qg&&qg.isSet,Jg=$g?Yg($g):Wg,Zg=qh,Qg=$h,ev=of,tv=sp,nv=yp,iv=mp.exports,ov=bp,rv=Tp,sv=Fp,av=zp,cv=qp,uv=pg,dv=vg,lv=Ig,hv=Gg,fv=mf,pv=bf.exports,gv=Xg,vv=Md,yv=Jg,mv=ip,bv=pp,_v="[object Arguments]",Ev="[object Function]",Cv="[object Object]",wv={};wv[_v]=wv["[object Array]"]=wv["[object ArrayBuffer]"]=wv["[object DataView]"]=wv["[object Boolean]"]=wv["[object Date]"]=wv["[object Float32Array]"]=wv["[object Float64Array]"]=wv["[object Int8Array]"]=wv["[object Int16Array]"]=wv["[object Int32Array]"]=wv["[object Map]"]=wv["[object Number]"]=wv[Cv]=wv["[object RegExp]"]=wv["[object Set]"]=wv["[object String]"]=wv["[object Symbol]"]=wv["[object Uint8Array]"]=wv["[object Uint8ClampedArray]"]=wv["[object Uint16Array]"]=wv["[object Uint32Array]"]=!0,wv["[object Error]"]=wv[Ev]=wv["[object WeakMap]"]=!1;var Ov=function e(t,n,i,o,r,s){var a,c=1&n,u=2&n,d=4&n;if(i&&(a=r?i(t,o,r,s):i(t)),void 0!==a)return a;if(!vv(t))return t;var l=fv(t);if(l){if(a=dv(t),!c)return ov(t,a)}else{var h=uv(t),f=h==Ev||"[object GeneratorFunction]"==h;if(pv(t))return iv(t,c);if(h==Cv||h==_v||f&&!r){if(a=u||f?{}:hv(t),!c)return u?sv(t,nv(a,t)):rv(t,tv(a,t))}else{if(!wv[h])return r?t:{};a=lv(t,h,c)}}s||(s=new Zg);var p=s.get(t);if(p)return p;s.set(t,a),yv(t)?t.forEach((function(o){a.add(e(o,n,i,o,t,s))})):gv(t)&&t.forEach((function(o,r){a.set(r,e(o,n,i,r,t,s))}));var g=l?void 0:(d?u?cv:av:u?bv:mv)(t);return Qg(g||t,(function(o,r){g&&(o=t[r=o]),ev(a,r,e(o,n,i,r,t,s))})),a},xv=Ov;var Av=function(e){return xv(e,5)},Sv=tl,Tv=nl;var Pv=function(e){return!0===e||!1===e||Tv(e)&&"[object Boolean]"==Sv(e)};let Nv=class{constructor(){this.toDispose=new ki,this.toolbarItems=new Map,this.onDidChangeEvent=new ga(null),this.onDidChange=this.onDidChangeEvent.watch,this.fireOnDidChange=yl((()=>this.onDidChangeEvent.setValue(void 0)),16),this.registerDisposableToolbar=e=>{const t=new ki,n={registerToolbarItem:e=>{const n=this.registerItem(e);return t.push(n),n}};return e(n),this.toDispose.push(t),t},this.getToolbarModel=e=>{const{layout:t,mainGroups:n=[],extraGroups:i=[]}=e;return new ga({layout:t,mainGroups:this.createToolbarGroupModel(n),extraGroups:this.createToolbarGroupModel(i)})},this.createToolbarGroupModel=e=>{const t=e.map((e=>{const{items:t=[]}=e;return Object.assign(Object.assign({},e),{items:t.map((e=>this.createToolbarModel({id:e.id}))).filter((e=>!!e))})}));return t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerToolbarItems(this)}onStop(){this.toDispose.dispose()}registerItem(t){this.toolbarItems.has(t.id)&&console.warn(`ToolbarRegistry ${t.id} is duplicated, in`,t),this.toolbarItems.set(t.id,t),this.fireOnDidChange();return new ki(e.Disposable.create((()=>this.fireOnDidChange())),e.Disposable.create((()=>this.toolbarItems.delete(t.id))))}createToolbarModel(e){const t=Av(this.toolbarItems.get(e.id)),n=!Pv(t.isEnabled)||t.isEnabled,i=!Pv(t.isVisible)||t.isVisible;return Object.assign(Object.assign({},t),{isEnabled:n,isVisible:i,iconName:t.iconName,text:t.text})}};fi([Kn(ya),pi("design:type",Object)],Nv.prototype,"commandService",void 0),fi([Kn(Aa),pi("design:type",Object)],Nv.prototype,"modelService",void 0),fi([si(kd),pi("design:type",Object)],Nv.prototype,"contributionProvider",void 0),Nv=fi([zn({contrib:[va,Id]})],Nv);const Iv=()=>oi((e=>{ri.register(e,kd),e(Nv)})),kv=e=>{const t=Za();return u.default.useEffect((()=>{const e=t.addCoreModule({config:{CONFIG_TYPE:"ToolbarRegistry",getConfig:()=>gi(void 0,void 0,void 0,(function*(){}))},createModule:Iv});return()=>{e.dispose()}}),[t]),null};kv.defaultProps={XFlowModuleType:"ToolbarRegistry"};const Mv=Symbol("IMenuService"),Dv=An.defineToken("IMenuContribution");var Rv;e.MenuItemType=void 0,(Rv=e.MenuItemType||(e.MenuItemType={})).Separator="separator",Rv.Submenu="submenu",Rv.Root="root",Rv.Leaf="leaf";let jv=class{constructor(){this.toDispose=new ki,this.menuMap=new Map,this.getMenu=e=>this.menuMap.get(e),this.registerDisposableMenu=e=>{const t=new ki,n={registerMenu:e=>{const n=this.registerMenu(e);return t.push(n),n}};return e(n),this.toDispose.push(t),t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerMenu(this)}onStop(){this.toDispose.dispose()}registerMenu(t){return this.menuMap.set(t.id,t),e.Disposable.create((()=>this.menuMap.delete(t.id)))}};fi([si(Dv),pi("design:type",Object)],jv.prototype,"contributionProvider",void 0),jv=fi([zn({contrib:[va,Mv]})],jv);const Gv=()=>oi((e=>{ri.register(e,Dv),e(jv)})),Fv=e=>{const t=Za();return u.default.useEffect((()=>{const e=t.addCoreModule({config:{CONFIG_TYPE:"MenuRegistry",getConfig:()=>gi(void 0,void 0,void 0,(function*(){}))},createModule:Gv});return()=>{e.dispose()}}),[]),null};Fv.defaultProps={XFlowModuleType:"MenuRegistry"};const Uv=t=>{const{meta:n,graphConfig:i,graphData:o,graphLayout:r,onLoad:s,isAutoCenter:a,hookConfig:c,modelServiceConfig:d,commandConfig:l,onAppConfigReady:h,onAppDestroy:f,children:p=[],className:g}=t,[v,y]=u.default.useState(),m=u.default.useMemo((()=>new $a),[]);u.default.useEffect((()=>{h&&h(m);const t=(t=>{const n=t.getAllExtensions(),i=new $n,o=n.map((e=>{const{createModule:t,config:n}=e;return t(n)}));return i.load(Lc),i.load(xa),i.load(jc),o.forEach((e=>{i.load(e)})),i.get(e.IApplication)})(m);t.start().then((()=>gi(void 0,void 0,void 0,(function*(){y(t),n&&(yield t.commandService.executeCommand(e.XFlowGraphCommands.LOAD_META.id,{meta:n})),s&&s(t,m),o&&(r&&(yield t.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_LAYOUT.id,Object.assign({graphData:o},r))),yield t.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_RENDER.id,{graphData:o}))}))));return()=>{gi(void 0,void 0,void 0,(function*(){f&&f(t)}))}}),[]),u.default.useEffect((()=>{v&&v.commandService.executeCommand(e.XFlowGraphCommands.LOAD_META.id,{meta:n})}),[n]),u.default.useEffect((()=>{gi(void 0,void 0,void 0,(function*(){v&&(o&&r&&(yield v.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_LAYOUT.id,Object.assign({graphData:o},r))),yield v.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_RENDER.id,{graphData:o}),a)&&(yield v.getGraphInstance()).centerContent()}))}),[o]);const b=_i("xflow-app-workspace",g,...m.getContainerClassNames()),_=(Array.isArray(p)?p:[p]).some((e=>e&&e.props.isXFlowCanvas));return u.default.createElement(Er,{app:v},u.default.createElement(Ja.Provider,{value:m},u.default.createElement("div",{className:b,id:m.getInstaceId()},!_&&u.default.createElement(zc,{config:i,position:{top:0,bottom:0,left:0,right:0}}),p,u.default.createElement(Fc,{config:d}),u.default.createElement(Nd,{config:l}),u.default.createElement(Qa,{config:c}),u.default.createElement(kv,null),u.default.createElement(Fv,null))))};Uv.defaultProps={};const Lv=()=>{const e=u.default.useRef(!0);return u.default.useEffect((()=>()=>{e.current=!1}),[]),e},Bv=t=>{const n=Lv(),[i,o]=u.default.useState(t.getValue());u.default.useEffect((()=>{const e=t.watch((e=>{(e=>e&&e.current)(n)&&o(e)}));return()=>{e.dispose()}}),[o]);const r=i,s=e.NsModel.isValidValue(r);return[r,u.default.useCallback((e=>t.setValue(e)),[t]),s]},Hv=Symbol("IKeyBindingService"),Vv=An.defineToken("IKeyBindingContribution"),Xv=Symbol("IKeyBindingOptionProvider");let zv=class{constructor(){this.toDispose=new ki,this.keyBindingMap=new Map,this.enabledKeyBindingMap=new Map,this.registerExternalKeybindings=()=>gi(this,void 0,void 0,(function*(){const{registerKeybindingFunc:e}=yield this.optionProvider.getOption();return e(this)})),this.registerKeybinding=(t=[])=>{const n=new ki;return t.forEach((t=>{this.keyBindingMap.set(t.id,t),this.enableKeyBindings(t.id).then((i=>{n.push(e.Disposable.create((()=>{i.dispose(),this.keyBindingMap.delete(t.id)})))}))})),this.toDispose.push(n),n},this.enableKeyBindings=t=>gi(this,void 0,void 0,(function*(){this.disableKeyBindings([t]);const n=this.keyBindingMap.get(t),i=yield this.getX6Graph(),o=this.runCommand(n);i.bindKey(n.keybinding,o);const r=e.Disposable.create((()=>{i.unbindKey(n.keybinding),this.enabledKeyBindingMap.delete(n.id)}));return this.enabledKeyBindingMap.set(n.id,r),r})),this.disableKeyBindings=e=>{e.forEach((e=>{const t=this.enabledKeyBindingMap.get(e);t&&t.dispose()}))},this.runCommand=e=>t=>gi(this,void 0,void 0,(function*(){yield e.callback(e,this.modelService,this.commandService,t)})),this.getX6Graph=()=>gi(this,void 0,void 0,(function*(){return yield this.graphProvider.getGraphInstance()}))}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerKeybinding(this);this.registerExternalKeybindings()}onStop(){this.toDispose.dispose()}};fi([Kn(Xv),pi("design:type",Object)],zv.prototype,"optionProvider",void 0),fi([Kn(ya),pi("design:type",Object)],zv.prototype,"commandService",void 0),fi([Kn(Aa),pi("design:type",Object)],zv.prototype,"modelService",void 0),fi([si(Vv),pi("design:type",Object)],zv.prototype,"contributionProvider",void 0),fi([Kn(nc),pi("design:type",Object)],zv.prototype,"graphProvider",void 0),zv=fi([zn({contrib:[va,Hv]})],zv);const Kv=e=>oi((t=>{((e,t)=>{e(Xv,{useDynamic:()=>({getOption:()=>gi(void 0,void 0,void 0,(function*(){return t.getConfig()}))}),lifecycle:An.Lifecycle.singleton})})(t,e),ri.register(t,Vv),t(zv)}));var Wv;!function(e){e.CONFIG_TYPE="CONTEXT_CONFIG"}(Wv||(Wv={}));const Yv=()=>e.Disposable.create((()=>{}));class qv{constructor(){this.CONFIG_TYPE=Wv.CONFIG_TYPE,this.keybindingFunc=Yv,this.isMounted=new Mi,this.setKeybindingFunc=e=>{this.keybindingFunc=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>gi(this,void 0,void 0,(function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,registerKeybindingFunc:this.keybindingFunc}})),this.dispose=()=>{this.keybindingFunc=Yv,this.isMounted=new Mi}}}const $v=new class{constructor(){this.map=new Map([["default",pr],["QuestionCircleOutlined",pr]]),this.map.set("default",pr),this.map.set("QuestionCircleOutlined",pr)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t)}has(e){return this.map.has(e)}};e.AppContext=ec,e.Deferred=Mi,e.DisposableCollection=ki,e.ExtensionRegistryContext=Ja,e.IApplicationContribution=va,e.ICommandContextProvider=ba,e.ICommandHandler=ma,e.IGraphCommandContribution=Ea,e.IGraphCommandFactory=_a,e.IGraphCommandService=ya,e.IGraphProvider=nc,e.IHookContribution=Ua,e.IHookService=Fa,e.IKeyBindingContribution=Vv,e.IMenuContribution=Dv,e.IMenuService=Mv,e.IModelContribution=Sa,e.IModelService=Aa,e.IToolbarContribution=kd,e.IToolbarService=Id,e.IconStore=$v,e.KeyBindings=e=>{const{config:t}=e,n=Za(),i=u.default.useMemo((()=>t||new qv),[t]);return u.default.useEffect((()=>{const e=n.addCoreModule({config:i,createModule:Kv});return i.setMountState(),()=>{e.dispose(),i.dispose()}}),[n,i]),null},e.KeybindingConfig=qv,e.MODELS=kc,e.ManaSyringe=di,e.MenuRegistry=Fv,e.RxModel=ga,e.ToolbarRegistry=kv,e.XFlow=Uv,e.XFlowAppContext=mr,e.XFlowAppExtensionMoudle=function(e){const{createModule:t,children:n}=e,i=Za(),o=u.default.useMemo((()=>e.config||{CONFIG_TYPE:"",getConfig:()=>gi(this,void 0,void 0,(function*(){return{}}))}),[]);return u.default.useEffect((()=>{const e=i.addExtension({config:o,createModule:t});return()=>{e.dispose()}}),[]),Array.isArray(n)||u.default.isValidElement(n)?u.default.createElement(u.default.Fragment,null," ",n," "):null},e.XFlowAppProvider=Cr,e.XFlowCanvas=zc,e.XFlowConfigProviderContext=Bc,e.XFlowConstants=Bi,e.commandRegistryModule=xa,e.createCmdConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Yc;return e(t,n),t}),[n]);return i},e.createComponentModel=e=>{const t=u.default.useMemo((()=>new ga(e)),[]),[n,i,o]=Bv(t);return u.default.useEffect((()=>()=>{t.dispose()}),[t]),[n,i,t,o]},e.createGraphConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Pr;return e(t,n),t}),[n]);return i},e.createHookConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Ha;return e(t,n),t}),[n]);return i},e.createKeybindingConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new qv;return e(t,n),t}),[n]);return i},e.createModelServiceConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new cc;return e(t,n),t}),[n]);return i},e.delay=function(e){return new Promise((t=>setTimeout((()=>t(!0)),e)))},e.getNodeReactComponent=tc,e.insertCss=e=>{const t=document.createElement("style");return t.setAttribute("type","text/css"),document.head.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),t},e.isReactComponent=function(e){return function(e){return"function"==typeof e&&!!e.prototype.isReactComponent}(e)||function(e){return"function"==typeof e&&String(e).includes("return React.createElement")}(e)},e.useAppContext=()=>u.default.useContext(ec),e.useExtensionRegistry=Za,e.useIsMountedRef=Lv,e.useModel=Bv,e.useModelAsync=e=>{const{getModel:t,initialState:n}=e,i=Lv(),o=u.default.useRef(),[r,s]=u.default.useState(n);return u.default.useEffect((()=>{let e;return t().then((t=>gi(void 0,void 0,void 0,(function*(){o.current=t;const n=yield t.getValidValue();i.current&&(s(n),e=t.watch((e=>{i.current&&s(e)})))})))),()=>{e&&e.dispose&&e.dispose()}}),[]),[r,s,o.current]},e.usePositionStyle=Vc,e.useXFlowApp=br,e.useXflowPrefixCls=Hc,e.uuidv4=Hi,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
